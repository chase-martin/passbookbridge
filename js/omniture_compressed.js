window.$P=function(){};window.self!==window.top&&(window.top.location=window.location);window.apple={};Object.create=function(a){function b(){}b.prototype=a;return new b};window.console||(console={log:function(a){window.DebugMenu&&null!==window.DebugMenu.log&&window.DebugMenu.log(a)}});try{window.referrerIsHanheld="handheld"===window.localStorage.getItem("LAST_PAGE_FORMAT"),window.localStorage.setItem("LAST_PAGE_FORMAT",null)}catch(e$$10){}window.apple.data={};this.JSON||(this.JSON={});
(function(){function a(a){return 10>a?"0"+a:a}function b(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=h[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var e,h,m,r,q=f,u,p=d[a];p&&("object"===typeof p&&"function"===typeof p.toJSON)&&(p=p.toJSON(a));"function"===typeof i&&(p=i.call(d,a,p));switch(typeof p){case "string":return b(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);
case "object":if(!p)return"null";f+=g;u=[];if("[object Array]"===Object.prototype.toString.apply(p)){r=p.length;for(e=0;e<r;e+=1)u[e]=c(e,p)||"null";m=0===u.length?"[]":f?"[\n"+f+u.join(",\n"+f)+"\n"+q+"]":"["+u.join(",")+"]";f=q;return m}if(i&&"object"===typeof i){r=i.length;for(e=0;e<r;e+=1)h=i[e],"string"===typeof h&&(m=c(h,p))&&u.push(b(h)+(f?": ":":")+m)}else for(h in p)Object.hasOwnProperty.call(p,h)&&(m=c(h,p))&&u.push(b(h)+(f?": ":":")+m);m=0===u.length?"{}":f?"{\n"+f+u.join(",\n"+f)+"\n"+
q+"}":"{"+u.join(",")+"}";f=q;return m;default:return"null"}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},i;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,b,d){var e;g=f="";if("number"===typeof d)for(e=0;e<d;e+=1)g+=" ";else"string"===typeof d&&(g=d);if((i=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return c("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function c(a,d){var e,f,g=a[d];if(g&&"object"===typeof g)for(e in g)Object.hasOwnProperty.call(g,e)&&(f=c(g,e),void 0!==f?g[e]=f:delete g[e]);return b.call(a,d,g)}var e,a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?c({"":e},""):e;throw new SyntaxError("JSON.parse");})})();apple.data.json={parse:JSON.parse,stringify:JSON.stringify};
(function(){window.apple.cookie=function(a,c,d){var e=document.cookie;if(1==arguments.length){if(a){var f=e.lastIndexOf(a+"=");if(-1==f)return null;var g=f+a.length+1,f=e.indexOf(";",f+a.length+1);-1==f&&(f=e.length);return decodeURIComponent(e.substring(g,f))}return null}a&&void 0!==typeof c&&(d=d||{},c=encodeURIComponent(c),e=d.expires,"number"==typeof e&&(g=new Date,g.setTime(g.getTime()+864E5*e),e=g),document.cookie=a+"="+c+(e?"; expires="+e.toUTCString():"")+(d.path?"; path="+d.path:"")+(d.domain?
"; domain="+d.domain:"")+(d.secure?"; secure":""));return null};var a=apple.cookie;a.deleteCookie=function(b,c){if(b){var d=Object.create(c);d.expires=d.expires||0;a(b,null,d)}};a.objectCookie=function(b,c,d){if(1==arguments.length){var e=window.apple.cookie(b);return a.decodeObject(e)}e=a.encodeObject(c);a(b,e,d);return null};a.encodeObject=function(a){return!a?null:escape(JSON.stringify(a))};a.decodeObject=function(a){if(!a)return null;try{return JSON.parse(unescape(a))}catch(c){return null}}})();
window.dojo={require:function(){},provide:function(){},lang:{doesObjectExist:function(a){try{var b=0,c=window;a.split(".");do c=c[a[b++]];while(b<a.length&&c);return c&&c!=window}catch(d){return!1}}}};window.Event=Object.create(window.Event||{});window.Event.onLoad=function(a){Event.onLoad.done?window.setTimeout(a,0):(Event.onLoad.callbacks||(Event.onLoad.callbacks=[]),Event.onLoad.callbacks.push(a))};
window.Event.scripts=function(){var a={},b=[];a.collect=function(a){"function"===typeof a&&b.push(a)};a.execute=function(){var a=b.length,d;for(d=0;d<a;d+=1)b[d]();Event.scripts.collect=function(a){"function"===typeof a&&(console.log("function "+a),a())}};return a}();window.Event.onDomReady=window.Event.onLoad;window.onload=function(){Event.onLoad.done=!0;if(Event.onLoad.callbacks)for(;Event.onLoad.callbacks.length;)Event.onLoad.callbacks.shift()()};
function StorageSimulator(a){function b(a){var b=[];if(a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}function c(){return apple.cookie.objectCookie(d.name)||{}}var d=a||{};return{get:function(a){return c()[a]},set:function(a,b){var g=c();g[a]=b;apple.cookie.objectCookie(d.name,g,d);return!0},remove:function(a){var b=c(),a=delete b[a];apple.cookie.objectCookie(d.name,b,d);1>this.length()&&apple.cookie.deleteCookie(d.name,d);return a},length:function(){var a=c();return b(a).length},
getKey:function(a){var d=c();return b(d)[a]}}}var Storage=function(a){a||(a={});this.wantSession="session"in a&&a.session;this.wantCookie="cookie"in a&&a.cookie;this.wantHash="hash"in a&&a.hash;this.noFallback=!this.wantCookie&&!this.wantHash;this.fauxSession=this.wantSession;this.noop=this.inFallback=!1;this.expires=a.expires;this.expiryInMs=a.expiryInMs;this.name=a.name;this.path=a.path;this.domain=a.domain;this.secure=a.secure;this.db=null;this.init()};
Storage.prototype.init=function(a,b){(this.db=a?this.fallback():this.local()||this.fallback()||this.global()||this.getUserData())&&a&&this.set(a,b);this.db||(this.noop=!0,console&&console.log&&console.log("Storage Info: No client storage will be available"))};
Storage.prototype.local=function(){var a=this.wantSession?window.sessionStorage||window.localStorage:window.localStorage;if(!a)return!1;this.hasDomStorage=!0;try{a.setItem("T3sT3iNg","123"),a.removeItem("T3sT3iNg")}catch(b){return this.inFallback=!0,!1}return a};
Storage.prototype.fallback=function(){if(this.inFallback&&!this.noFallback){this.db=null;this.fauxSession=!1;if(this.wantCookie){var a=this.expires/36E5;return new Storage.cookieFB({expires:this.expiryInMs?a/24:this.expires,name:this.name,path:this.path,domain:this.domain,secure:this.secure})}return new Storage.hashFB}return!1};Storage.cookieFB=function(a){a=window.StorageSimulator(a);a.getItem=a.get;a.setItem=a.set;a.removeItem=a.remove;a.key=a.getKey;a.clear=function(){};return a};
Storage.hashFB=function(){this.data={}};Storage.hashFB.prototype.getData=function(){return this.data};Storage.hashFB.prototype.getItem=function(a){return this.data[a]||null};Storage.hashFB.prototype.setItem=function(a,b){this.data[a]=b;this.length++};Storage.hashFB.prototype.removeItem=function(a){delete this.data[a];0<this.length&&this.length--};Storage.hashFB.prototype.length=0;Storage.hashFB.prototype.key=function(a){var b=0,c;for(c in this.data){if(b===a)return c;b++}return null};
Storage.hashFB.prototype.clear=function(){this.length=0;this.data={}};Storage.hashFB.prototype.key=function(a){var b=Object.keys(this.data);return this.data[b[a]]};Storage.prototype.global=function(){return window.globalStorage?(this.hasDomStorage=!0,window.globalStorage):!1};Storage.prototype.getUserData=function(){if(this.hasDomStorage)return!1;this.fauxSession=!1;return new Storage.userData(this.expires,this.expiryInMs)};
Storage.userData=function(a,b){this.txtArea=document.createElement("textarea");this.txtArea.style.behavior="url(#default#userData)";this.txtArea.setAttribute("expires",Storage.getFutureDate(a,b,!0));this.txtArea.style.display="none";(document.getElementById("aos-pocket")||document.body).appendChild(this.txtArea)};Storage.userData.prototype.getKeys=function(){var a;this.txtArea.load("AOSMeta");return(a=this.txtArea.getAttribute("keys"))?a.split("__"):[]};
Storage.userData.prototype.setKeys=function(a){this.txtArea.load("AOSMeta");this.txtArea.setAttribute("keys",a.join("__"));this.txtArea.save("AOSMeta")};Storage.userData.prototype.addKey=function(a){var b=this.getKeys();-1===b.indexOf(a)&&(b.push(a),this.setKeys(b))};Storage.userData.prototype.removeKey=function(a){var b=this.getKeys(),a=b.indexOf(a);-1!==a&&(b.splice(a,1),this.setKeys(b))};Storage.userData.prototype.getItem=function(a){this.txtArea.load("AOSData");return this.txtArea.getAttribute(a)};
Storage.userData.prototype.setItem=function(a,b){this.txtArea.load("AOSData");var c=this.txtArea.getAttribute(a);this.txtArea.setAttribute(a,b);this.txtArea.save("AOSData");if(this.txtArea.getAttribute(a)===b)return c||this.addKey(a),!0;this.txtArea.setAttribute(a,c);this.txtArea.save("AOSData");return!1};Storage.userData.prototype.removeItem=function(a){this.txtArea.load("AOSData");this.txtArea.removeAttribute(a);this.txtArea.save("AOSData");this.removeKey(a)};Storage.userData.prototype.length=function(){return this.getKeys().length};
Storage.userData.prototype.key=function(a){return this.getKeys()[a]};Storage.userData.prototype.clear=function(){for(var a=this.getKeys(),b=0,c=a.length;b<c;b++)this.removeItem(a[b])};Storage.getFutureDate=function(a,b,c){var d=new Date,b=b?1:864E5;"number"!==typeof a&&(a=parseInt(a,10));return c?(d.setTime(d.getTime()+a*b),d.toUTCString()):d.getTime()+a*b};
Storage.prototype.get=function(a){if(this.noop)return null;var b,c;if(this.fauxSession){c=new Date;if(b=JSON.parse(this.db.getItem(a))){if(b.timestamp>c.getTime())return b.value;this.db.removeItem(a)}return null}return this.db.getItem(a)};
Storage.prototype.set=function(a,b){if(!this.noop){this.fauxSession&&(b=JSON.stringify({value:b,timestamp:Storage.getFutureDate(this.expires,this.expiryInMs)}));try{this.db.removeItem(a),this.db.setItem(a,b)}catch(c){console&&console.log&&console.log(c.message),!this.inFallback&&!this.noFallback?(this.inFallback=!0,this.init(a,b)):console&&console.log&&console.log("Storage Error: No fallback specified or available")}}};Storage.prototype.remove=function(a){if(!this.noop)return this.db.removeItem(a)};
Storage.prototype.clear=function(){if(!this.noop)return this.db.clear()};Storage.prototype.length=function(){return this.noop?0:"function"===typeof this.db.length?this.db.length():this.db.length};Storage.prototype.getKey=function(a){return this.noop?null:this.db.key(a)};window.apple.metrics={};
apple.metrics.Metrics=function(a){this.config=a;apple.metrics.evarDataNodesEnabled=this.config.evarDataNodes?this.config.evarDataNodes:!0;this.cookieProps=Object.create(apple.metrics.Metrics.CONSTANTS.cookieDefaults);this.metrics=this.getObjectCookie()||{};this.init()};apple.metrics.Metrics.CONSTANTS={AosNamespace:"AOS: ",cookieDefaults:{name:"asmetrics",path:"/",domain:window.location.host,expires:0.0208333333,secure:!1},pageLoadDataKeyPrefix:"apple.metrics",pageLoadDataKeySeparator:"__",pageLoadDataKeyLatestKeyName:"apple_Metrics_LatestKey"};
apple.metrics.evarDataNodesEnabled;apple.metrics.pageLoadMetricsData;apple.metrics.Metrics.reportCustomLink=function(a,b){var c=window.s;if(c)try{var d=c.linkTrackVars,e=c.linkTrackEvents,f=c.eVar5,g=apple.metrics.Metrics.CONSTANTS.AosNamespace;0!==b.indexOf(g)&&(b=g+b);c.linkTrackVars="eVar5";c.linkTrackEvents="None";c.eVar5=b;c.tl(a,"o",apple.metrics.Metrics.getCustomLinkName(b))}finally{c.linkTrackVars=d,c.linkTrackEvents=e,c.eVar5=f}};
apple.metrics.Metrics.getCustomLinkName=function(a){var b=a.split("|");return 4>=b.length?a:a.substring(a.indexOf(b[2]))};apple.metrics.Metrics.getProductSubstring=function(a){if(!a)return"";var b=a.split(";");return 6>b.length?a:b[1]};
apple.metrics.Metrics.prototype={setObjectCookie:function(a){apple.cookie.objectCookie(this.cookieProps.name,a,this.cookieProps)},getObjectCookie:function(){return apple.cookie.objectCookie(this.cookieProps.name)},pageName:function(a){return a+(this.pageSuffix()||"")},mark:function(){this.config.isHome&&(this.getStore().vh=!0);this.setObjectCookie(this.metrics)},hasReturnedHome:function(){return this.getStore().vh},pageSuffix:function(){return this.config.isHome?" - "+(this.hasReturnedHome()?"Return":
"First"):null},getStore:function(){this.metrics.store||this.initStore();return this.metrics.store},getEvar1:function(){return apple.metrics.pageLoadMetricsData&&apple.metrics.pageLoadMetricsData.evar1||""},getEvar30:function(){return apple.metrics.pageLoadMetricsData&&apple.metrics.pageLoadMetricsData.evar30||""},getProp30:function(){return(apple.metrics.pageLoadMetricsData&&apple.metrics.pageLoadMetricsData.evar1||"").split("|")[0]},getProp42:function(){return apple.metrics.pageLoadMetricsData&&
apple.metrics.pageLoadMetricsData.prop42||""},initStore:function(){var a=this.metrics.store;a&&a.sid!=this.config.storeId&&(a=null);a||(a={sid:this.config.storeId},this.metrics.store=a);return a},loadStorageData:function(){if(apple.metrics.evarDataNodesEnabled){var a,b,c,d;d=metricsStorage.length();a=apple.metrics.transformKey(apple.metrics.Metrics.CONSTANTS.pageLoadDataKeyPrefix);b=apple.metrics.Metrics.CONSTANTS.pageLoadDataKeySeparator;var e=apple.metrics.Metrics.CONSTANTS.pageLoadDataKeyLatestKeyName,
f=apple.metrics.transformKey(window.location.pathname);c=apple.metrics.transformKey(window.location.href);var f=RegExp("^"+a+b+".*"+b+"(?:("+f+"$))","gi"),g=RegExp("^"+a+b+"("+c+")"+b+".*$","gi");if(!apple.metrics.pageLoadMetricsData){a=apple.metrics.getStorageKey();b=metricsStorage.get(a);if(!b)for(var h=0;h<d;h++)if(c=metricsStorage.getKey(h),f.test(c)){a=c;b=metricsStorage.get(a);break}if(!b)if(c=metricsStorage.get(e),g.test(c))a=c;else if(d=metricsStorage.get(c))a=c,b=d;apple.metrics.pageLoadMetricsData=
b?apple.data.json.parse(b):{};metricsStorage.remove(a)}}},init:function(){this.initStore();this.loadStorageData()}};apple.metrics.fireMicroEvent=function(a){apple.metrics.fireMicroEventImpl(a,!1)};apple.metrics.fireMicroEventNoDuplicates=function(a){apple.metrics.fireMicroEventImpl(a,!0)};
apple.metrics.fireMicroEventImpl=function(a,b){var c=window.s||null,d=apple.metrics.Metrics.CONSTANTS.AosNamespace;if(c){if(!("feature"in a&&"action"in a))throw Error("Microevents require a feature and an action.");a=Object.applyDefaults(a,{page:c.pageName,slot:"",part:"",eVar:"eVar5"});!a.excludeAosNamespace&&0!==a.page.indexOf(d)&&(a.page=d+a.page);var d=a.eVar,e=[a.page,a.slot,a.feature,a.part,a.action].join(" | "),f=[a.feature,a.part,a.action].join(" | "),g={lnk:c.lnk,events:c.events,linkType:c.linkType,
linkName:c.linkName,linkTrackVars:c.linkTrackVars,linkTrackEvents:c.linkTrackEvents},h;g[d]=c[d];a.events?(c.linkTrackVars=d+",events",c.linkTrackEvents=a.events,c.events=a.events):(c.linkTrackVars=d,c.linkTrackEvents="None");c[d]=e;apple.metrics.onEventCompletion.wait();if(!b||!apple.metrics.checkDuplicateMicroEvent(e))c.tl(a.node||null,"o",f);for(h in g)c[h]=g[h]}};apple.metrics._stringToEvent=function(a){a=a.split(" | ");return{page:a[0],slot:a[1],feature:a[2],part:a[3],action:a[4]}};
apple.metrics.microEventDuplicateDetector={};apple.metrics.checkDuplicateMicroEvent=function(a){var b=apple.metrics.microEventDuplicateDetector;if(b[a])return!0;b[a]=!0;return!1};apple.metrics.fireEvent=function(a){var b=window.s||null,c={},d;if(b){for(d in a)c[d]=b[d],b[d]=a[d];apple.metrics.onEventCompletion.wait();b.t();for(d in a)b[d]=c[d]}};
apple.metrics.fireEventCollection=function(a){var b,c,d;if(a){if(a.microEvent){b=[].concat(a.microEvent);c=b.length;for(d=0;d<c;d++)apple.metrics.fireMicroEvent(b[d])}if(a.metrics){b=[].concat(a.metrics);c=b.length;for(d=0;d<c;d++)apple.metrics.fireEvent(b[d])}}};apple.metrics.transformKey=function(a){return a?a.replace(/\W+(\w){1}/g,function(a,c){return c?c.toUpperCase():""}):a};
apple.metrics.getStorageKey=function(a){var b=apple.metrics.Metrics.CONSTANTS.pageLoadDataKeySeparator;return apple.metrics.transformKey(apple.metrics.Metrics.CONSTANTS.pageLoadDataKeyPrefix+b+(a?window.location.href:window.document.referrer||"")+b+(a?a:window.location.pathname))};
apple.metrics.onEventCompletion=function(){function a(){b=null;for(var a,d;c.length;)a=c.shift(),d=a.fn,a=a.obj,d.call(a)}var b,c=[],d;d=function(a,d){b?c.push({fn:a,obj:d}):a.call(d)};d.wait=function(){b&&window.clearTimeout(b);b=window.setTimeout(a,250)};return d}();
var metricsStorage=function(){var a={name:"asmco",path:"/",domain:window.location.host,secure:!1},b;if(b=!(!window.attachEvent||window.opera))b=(b=/MSIE (\d+)/.exec(navigator.userAgent))&&parseInt(b[1],10);return b&&8>b?StorageSimulator(a):new Storage}();window.apple=window.apple||{};
apple.ImageReplacer=function(a){var b=document.images,c,d;this.imagesToBeReplaced=[];c=0;for(d=b.length;c<d;c++)b[c].className.match(/\bir\b/)&&this.imagesToBeReplaced.push(b[c]);if(0<this.imagesToBeReplaced.length&&(this.newScale=(this.oldScale=(c=this.determineSwitchScale(this.imagesToBeReplaced[0]))&&c[0])&&c[1],this.newScale!=a)){this.origSrc=[];c=0;for(d=this.imagesToBeReplaced.length;c<d;c++)a=this.imagesToBeReplaced[c],b=this.determineImageType(a,this.newScale),(!a.getAttribute("width")||!a.getAttribute("height"))&&
this.checkImageDimensions(a),this.swapImage(a,b,this.origSrc)}};apple.ImageReplacer.w="width";apple.ImageReplacer.h="height";apple.ImageReplacer.i="image-";apple.ImageReplacer.p="params-";apple.ImageReplacer.dataScale="data-scale-";
apple.ImageReplacer.prototype={determineSwitchScale:function(a){var b=apple.ImageReplacer.dataScale+apple.ImageReplacer.i,c=apple.ImageReplacer.dataScale+apple.ImageReplacer.p,d;if(a.getAttribute(b+"2")||a.getAttribute(c+"2"))d=[1,2];else if(a.getAttribute(b+"1")||a.getAttribute(c+"1"))d=[2,1];return d},determineImageType:function(a,b){var c=apple.ImageReplacer.dataScale+apple.ImageReplacer.i+b,d=apple.ImageReplacer.dataScale+apple.ImageReplacer.p+b,e;a.getAttribute(c)?(this.completeDataString=c,
e=apple.ImageReplacer.i):a.getAttribute(d)&&(this.completeDataString=d,e=apple.ImageReplacer.p);return e},checkImageDimensions:function(a){var b=apple.ImageReplacer.dataScale+apple.ImageReplacer.p;if(a.getAttribute(apple.ImageReplacer.dataScale+apple.ImageReplacer.i+"2")||a.getAttribute(b+"2"))a.setAttribute("width",a.width),a.setAttribute("height",a.height)},swapImage:function(a,b,c){var d=a.src,e=d.slice(0,d.lastIndexOf(b==apple.ImageReplacer.i?"/":"?")+1),f=d&&d.slice(d.lastIndexOf("/")+1),b=b==
apple.ImageReplacer.i?f:f.substr(f.indexOf("?")+1),f=this.completeDataString?a.getAttribute(this.completeDataString):null,e=e+f;c&&c.push(d);this.setNewDataSrc(a,b);a.src=e},setNewDataSrc:function(a,b){var c=this.completeDataString?this.completeDataString:null,d=c.replace(this.newScale,this.oldScale);a.setAttribute(d,b);a.removeAttribute(c)}};
(function(){var a=parseInt(apple.cookie("pxro"),10),b=window.devicePixelRatio||1,c=window.location.search&&window.location.search.match("debug.pixelRatio");if(!c){var d={name:"pxro",path:"/",domain:".apple.com",expires:730,secure:!1};if(!a||a!==b){var e=navigator.userAgent,e=!!e.match(/AppleWebKit/i)&&!!e.match(/Mobile/i)&&!e.match(/ipad/i);apple.cookie("pxro",!e?b:1,d);if(b&&2<=b&&!e)Event.onDomReady(function(){new apple.ImageReplacer(a,c)})}}})();
(function(){var a="abbr article aside command details figcaption figure footer header hgroup mark meter nav output progress section summary time".split(" "),b,c=a.length;for(b=0;b<c;b++)document.createElement(a[b])})();window.$P=function(){};if("undefined"!==typeof coherent)throw Error("Library module (coherent) already defined");var coherent={version:"@VERSION@",revision:"@REVISION@",generateUid:function(){var a=0;return function(){return++a}}()};
coherent.Browser={IE:!(!window.attachEvent||window.opera)&&function(){var a=/MSIE (\d+)/.exec(navigator.userAgent);return a&&parseInt(a[1],10)}(),Safari:-1<navigator.userAgent.indexOf("AppleWebKit/"),Safari2:function(){var a=/AppleWebKit\/(\d+(?:\.\d+)?)/.exec(navigator.userAgent);return a&&420>parseInt(a[1],10)}(),Mozilla:-1<navigator.userAgent.indexOf("Gecko")&&-1==navigator.userAgent.indexOf("KHTML"),MobileSafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/),Chrome:-1<navigator.userAgent.indexOf("Chrome")};
coherent.OS={Mac:-1<navigator.userAgent.indexOf("Mac OS X")&&-1==navigator.userAgent.indexOf("Mobile"),Windows:-1<navigator.userAgent.indexOf("Windows"),Linux:-1<navigator.userAgent.indexOf("Linux"),iPhone:-1<navigator.userAgent.indexOf("iPhone")};coherent.Support={Properties:"__defineGetter__"in Object.prototype,QuerySelector:"querySelector"in document,Touches:!!document.createTouch,CSS3ColorModel:!1,CSSTransitions:!1};
coherent.Support.Properties&&(coherent.Support.__defineGetter__("CSS3ColorModel",function(){delete this.CSS3ColorModel;var a=document.createElement("span");try{return a.style.backgroundColor="rgba(100,100,100,0.5)",this.CSS3ColorModel=1===a.style.length}catch(b){}return this.CSS3ColorModel=!1}),coherent.Support.__defineGetter__("CSSTransitions",function(){delete this.CSSTransitions;var a=document.createElement("span");try{return a.style.setProperty("-webkit-transition-duration","1ms",""),a.style.setProperty("-o-transition-duration",
"1ms",""),a.style.setProperty("-moz-transition-duration","1ms",""),this.CSSTransitions=0<a.style.length}catch(b){}return this.CSSTransitions=!1}));coherent.typeOf=function(a){if(null===a)return"null";var b=typeof a;return"object"!==b&&"function"!==b?b:Object.prototype.toString.call(a).slice(8,-1).toLowerCase()};
coherent.compareValues=function(a,b){var c=coherent.typeOf(a);if(c!==coherent.typeOf(b))return String(a).localeCompare(String(b));switch(c){case "null":return 0;case "boolean":case "number":return c=a-b,0===c?c:0>c?-1:1;case "regexp":case "function":break;case "string":case "array":case "object":if(a.localeCompare)return a.localeCompare(b);if(a.compare)return a.compare(b);break;case "undefined":return!0;default:throw new TypeError("Unknown type for comparison: "+c);}return String(a).localeCompare(String(b))};
coherent.defineError=function(a){function b(b){this.message=b;this.name=a}b.prototype=Error();b.prototype.constructor=b;b.prototype.name=a;return b};var InvalidArgumentError=coherent.defineError("InvalidArgumentError");"undefined"==typeof window.console&&(window.console={});"undefined"==typeof window.console.log&&(window.console.log=function(){});String.prototype.titleCase=function(){return this.charAt(0).toUpperCase()+this.substr(1)};
String.prototype.trim=function(){for(var a=this.replace(/^\s+/,""),b=a.length-1;0<b;--b)if(/\S/.test(a.charAt(b))){a=a.substring(0,b+1);break}return a};String.prototype.beginsWith=function(a){return a===this.substring(0,a.length)};String.prototype.localeCompare||(String.prototype.localeCompare=function(a){return this<a?-1:this>a?1:0});String.prototype.expand=function(a,b){return this.replace(/\$\{(\w+)\}/g,function(c,d){var e=a[d];return null===e||"undefined"===typeof e?b:e})};
String.prototype.times=function(a){if(isNaN(a)||0>=a)return"";for(var b=this;--a;)b+=this;return b};
String.prototype.truncate=function(a){var b="number"===coherent.typeOf(a),c=b?{}:a||{},d=this.toString(),e=Math,b=b?a:c.length||30,a=c.omission||"\u2026",c=c.from||"start";if(this.length>b)switch(c){case "start":case "beginning":d=this.slice(0,b).stripPunctuationAtEnd().trim()+a;break;case "middle":d=e.floor(b/2);d=[this.slice(0,d).stripPunctuationAtEnd().trim(),a,this.slice(-d).stripPunctuationAtStart().trim()].join(" ");break;case "end":case "ending":d=a+this.slice(-b).stripPunctuationAtStart().trim()}return d};
String.prototype.escapeForInnerHTML=function(){var a=document.createElement("div");a.innerHTML="&";String.prototype.escapeForInnerHTML=""===a.innerHTML?function(){return this.replace(/&((\w){0,10})$/g,"&amp;$1")}:function(){return this.valueOf()};return this.escapeForInnerHTML()};String.stringify=function(a){return"string"===typeof a?a:String(a)};
(function(){var a=String.prototype,b=RegExp("[\\s!\u00a1\\?\u00bf\u203d\\.\\,\u2026:;_\\-\u2013\u2014~\u00b7\u2022\u2018\u2019\u201c\u201d\u201a\u201e\u201b\u201f\u2032`\u2033'\"#\\$&\\*@\u00a7\u00b6\\^\\|\\/]+$"),c=RegExp("^[\\s!\u00a1\\?\u00bf\u203d\\.\\,\u2026:;_\\-\u2013\u2014~\u00b7\u2022\u2018\u2019\u201c\u201d\u201a\u201e\u201b\u201f\u2032`\u2033'\"#\\$&\\*@\u00a7\u00b6\\^\\|\\/]+"),d=/<[^>]*>/g;a.stripPunctuationAtEnd=function(){return this.replace(b,"")};a.stripPunctuationAtStart=function(){return this.replace(c,
"")};a.stripTags=function(){return this.replace(d,"")}})();"undefined"!==typeof window.Prototype&&function(){for(var a="indexOf lastIndexOf forEach filter map some every reduce reduceRight".split(" "),b=0;b<a.length;++b)delete Array.prototype[a[b]]}();Array.prototype.distinct=function(){var a=this.length,b=Array(a),c,d,e=0;for(c=0;c<a;++c)d=this[c],-1==b.indexOf(d)&&(b[e++]=d);b.length=e;return b};
Array.prototype.compare=function(a){var b=this.length-a.length;if(0!==b)return b;var c,d,b=0;for(c=this.length;b<c;++b)if(d=coherent.compareValues(this[b],a[b]),0!==d)return d;return 0};Array.from=function(a,b){return Array.prototype.slice.call(a,b||0)};
Array.prototype.reduce||(Array.prototype.reduce=function(a){var b=this.length;if("function"!=typeof a)throw new TypeError;if(0===b&&1===arguments.length)throw new TypeError;var c=0;if(2<=arguments.length)var d=arguments[1];else{do{if(c in this){d=this[c++];break}if(++c>=b)throw new TypeError;}while(1)}for(;c<b;c++)c in this&&(d=a.call(null,d,this[c],c,this));return d});
Array.prototype.reduceRight||(Array.prototype.reduceRight=function(a){var b=this.length;if("function"!=typeof a)throw new TypeError;if(0===b&&1===arguments.length)throw new TypeError;b-=1;if(2<=arguments.length)var c=arguments[1];else{do{if(b in this){c=this[b--];break}if(0>--b)throw new TypeError;}while(1)}for(;0<=b;b--)b in this&&(c=a.call(null,c,this[b],b,this));return c});Array.indexOf||(Array.indexOf=function(a,b,c){return Array.prototype.indexOf.call(a,b,c)});
Array.lastIndexOf||(Array.lastIndexOf=function(a,b,c){return Array.prototype.lastIndexOf.call(a,b,c)});Array.forEach||(Array.forEach=function(a,b,c){return Array.prototype.forEach.call(a,b,c)});Array.filter||(Array.filter=function(a,b,c){return Array.prototype.filter.call(a,b,c)});Array.map||(Array.map=function(a,b,c){return Array.prototype.map.call(a,b,c)});Array.some||(Array.some=function(a,b,c){return Array.prototype.some.call(a,b,c)});
Array.every||(Array.every=function(a,b,c){return Array.prototype.every.call(a,b,c)});Array.reduce||(Array.reduce=function(a,b){return 2<arguments.length?Array.prototype.reduce.call(a,b,arguments[2]):Array.prototype.reduce.call(a,b)});Array.reduceRight||(Array.reduceRight=function(a,b){return 2<arguments.length?Array.prototype.reduceRight.call(a,b,arguments[2]):Array.prototype.reduceRight.call(a,b)});Array.from=function(a,b){for(var c=a.length,d=[],e=b||0;e<c;++e)d.push(a[e]);return d};
Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){"undefined"===typeof b?b=0:0>b&&(b=Math.max(0,this.length+b));for(var c=b;c<this.length;c++)if(this[c]===a)return c;return-1});Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a,b){"undefined"===typeof b?b=this.length-1:0>b&&(b=Math.max(0,this.length+b));for(var c=b;0<=c;c--)if(this[c]===a)return c;return-1});
Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=this.length,d=0;d<c;d++)a.call(b,this[d],d,this)});Array.prototype.filter||(Array.prototype.filter=function(a,b){for(var c=this.length,d=[],e=0;e<c;e++)a.call(b,this[e],e,this)&&d.push(this[e]);return d});Array.prototype.map||(Array.prototype.map=function(a,b){for(var c=this.length,d=[],e=0;e<c;e++)d.push(a.call(b,this[e],e,this));return d});
Array.prototype.some||(Array.prototype.some=function(a,b){for(var c=this.length,d=0;d<c;d++)if(a.call(b,this[d],d,this))return!0;return!1});Array.prototype.every||(Array.prototype.every=function(a,b){for(var c=this.length,d=0;d<c;d++)if(!a.call(b,this[d],d,this))return!1;return!0});
Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if(!arguments.length)return b;if(1==arguments.length)return function(){return b.apply(a,arguments)};var c=Array.from(arguments,1);return function(){return b.apply(a,c.concat(Array.from(arguments)))}});
Function.prototype.bindAsEventListener||(Function.prototype.bindAsEventListener=function(a){var b=this;if(1==arguments.length)return function(c){return b.call(a,c||window.event)};var c=Array.from(arguments);c.shift();return function(d){return b.apply(a,[d||window.event].concat(c))}});
Function.prototype.delay||(Function.prototype.delay=function(a){var b=this,a=a||10;if(2>arguments.length)return window.setTimeout(function(){b()},a);var c=Array.from(arguments,1);return window.setTimeout(function(){b.apply(b,c)},a)});Function.prototype.bindAndDelay||(Function.prototype.bindAndDelay=function(a,b){var c=this,a=a||c,b=b||10;if(3>arguments.length)return window.setTimeout(function(){c.call(a)},b);var d=Array.from(arguments,2);return window.setTimeout(function(){c.apply(a,d)},b)});
Function.prototype.bindAndRepeat||(Function.prototype.bindAndRepeat=function(a,b){var c=this,a=a||c,b=b||10;if(3>arguments.length)return window.setInterval(function(){c.call(a)},b);var d=Array.from(arguments,2);return window.setInterval(function(){c.apply(a,d)},b)});Function.prototype.sync=function(){var a=arguments.length?this.bind.apply(this,arguments):this,b={},c=!1;a.stop=function(){c=!0};a.waitFor=function(d){b[d]=!0;return function(){b[d]=!1;for(var e in b)if(b[e])return;c||a()}};return a};
function Set(){var a=this;a.constructor!==Set&&(a=new Set);var b=arguments;1==b.length&&b[0]instanceof Array&&(b=b[0]);var c,d=b.length;for(c=0;c<d;++c)a[b[c]]=!0;return a}Set.union=function(a,b){var c=Object.clone(a);if(!b)return c;for(var d in b)c[d]=!0;return c};Set.intersect=function(a,b){var c=new Set,d;for(d in a)d in b&&(c[d]=!0);return c};Set.add=function(a,b){a[b]=!0;return a};Set.remove=function(a,b){delete a[b];return a};Set.toArray=function(a){var b,c=[];for(b in a)c.push(b);return c};
Set.forEach=function(a,b,c){var d,e=0;for(d in a)b.call(c,d,e++)};Set.join=function(a,b){var c,d=[];for(c in a)d.push(c);return d.join(b||"")};var $S=Set;Object.clone=function(a){var b=function(){};b.prototype=a;return new b};Object.applyDefaults=function(a,b){a=a||{};if(!b)return a;for(var c in b)c in a||(a[c]=b[c]);return a};Object.extend=function(a,b){var a=a||{},c;for(c in b)a[c]=b[c];return a};Object.merge=function(a,b){var c={},d;for(d in a)c[d]=a[d];for(d in b)d in c||(c[d]=b[d]);return c};
(function(){function a(a,b,c){var d=a[b],e=coherent.typeOf(d);"string"===e?a[b]=[d,c]:"array"===e?d.push(c):a[b]=c}function b(b){var c=b.name,e=(b.type||"").toLowerCase();b.disabled||e in d||("radio"===e||"checkbox"===e?b.checked&&a(this,c,b.value):b.multiple?(this[c]=[],Array.forEach(b.options,function(b){b.selected&&a(this,c,b.value)},this)):(a(this,c,b.value),"image"===e&&(a(this,c+".x",0),a(this,c+".y",0))))}function c(b){b=b.split("=");if(1!==b.length){var c=decodeURIComponent(b[0].trim()),b=
decodeURIComponent(b[1].trim())||null;a(this,c,b)}}var d=Set("file","submit","image","reset","button"),e={};Object.fromForm=function(a){var c={};Array.forEach(a.elements,b,c);return c};Object.fromQueryString=function(a){"?"==a.charAt(0)&&(a=a.slice(1));var a=a.split(/\s*&\s*/),b={};a.forEach(c,b);return b};Object.toQueryString=function(a){function b(a){null!==a&&"undefined"!==typeof a&&(a=encodeURIComponent(a));l.push(c+"="+a)}if(!a)return"";var c,d,j,l=[];for(c in a)d=a[c],j=coherent.typeOf(d),"null"===
j&&(d=""),"function"===j||d===e[c]||(c=encodeURIComponent(c),"array"===j?d.forEach(b):b(d));return l.join("&")}})();RegExp.escape=function(a){return a.replace(RegExp._escapeRegex,"\\$1")};RegExp.specialCharacters="/.*+?|()[]{}\\".split("");RegExp._escapeRegex=RegExp("(\\"+RegExp.specialCharacters.join("|\\")+")","g");
var Class=function(){function a(a,b){var c;if(!a&&!b)return a;if(a){c=/this\.base/.test(a);if(!c&&!b)return a;c=c?function(){var c=this.base;this.base=b||function(){};var d=a.apply(this,arguments);this.base=c;return d}:function(){b.call(this);return a.apply(this,arguments)}}else c=function(){return b.apply(this,arguments)};c.valueOf=function(){return a};c.toString=function(){return String(a)};return c}function b(a,b){var c=a.prototype.__factory__.apply(a,b);if("function"!==typeof c)throw Error("Factory function doesn't return a function");
c.__factoryFn__=!0;return c}function c(a){if(a.__createFactoryObjects)a.__createFactoryObjects();else{var b,c;for(b in a.__factories__)c=a[b],c.__factoryFn__&&(a[b]=c.call(a))}}function d(a,b,c){if(c instanceof Function){var d=a[b],e=c.valueOf();if(d instanceof Function&&d.valueOf()!==e){var l=c,c=function(){var a=this.base;this.base=d||function(){};var b=l.apply(this,arguments);this.base=a;return b};!l||!/this\.base/.test(l)?c=l:(c.valueOf=function(){return l},c.toString=function(){return String(l)})}e.__factoryFn__&&
(a.__factories__[b]=c)}return a[b]=c}var e;e=coherent.Support.Properties?function(a,b){var c=a.prototype,e;for(e in b){var j=b.__lookupGetter__(e),l=b.__lookupSetter__(e);j||l?(j&&c.__defineGetter__(e,j),l&&c.__defineSetter__(e,l)):d(c,e,b[e])}return a}:function(a,b){var c=a.prototype,e;for(e in b)d(c,e,b[e])};return{create:function(d,e){var h,i={};switch(arguments.length){case 0:throw new TypeError("Missing superclass and declaration arguments");case 1:e=d;d=void 0;break;default:i=function(){},i.prototype=
d.prototype,i=new i}if("function"==typeof e&&(e=e(),!e))throw Error("Class declaration function did not return a prototype");e.hasOwnProperty("constructor")&&(h=e.constructor,delete e.constructor);var j=h;h=d;if(j&&!(j instanceof Function))throw Error("Invalid constructor");if(h&&!(h instanceof Function))throw Error("Invalid superclass");h=h?h.valueOf():null;var j=a(j,h),l;l=j?function(){if(!(this instanceof l))return b(l,arguments);this.__uid=this.__uid||coherent.generateUid();var a=j.apply(this,
arguments);c(this);this.__postConstruct instanceof Function&&this.__postConstruct();return a||this}:function(){if(!(this instanceof l))return b(l,arguments);this.__uid=this.__uid||coherent.generateUid();c(this);this.__postConstruct instanceof Function&&this.__postConstruct();return this};l.valueOf=function(){return j};l.toString=function(){return String(j||l)};h=l;h.prototype=i;h.prototype.constructor=h;h.superclass=d;i.__factories__=d?Object.clone(d.prototype.__factories__):{};this.extend(h,e);var i=
h,k;for(k=i.superclass;k;k=k.superclass)"__subclassCreated__"in k&&k.__subclassCreated__(i);return h},findPropertyName:function(a,b){var c,d;for(d in a)if(c=a[d],c===b||"function"===typeof c&&c.valueOf()===b)return d;return null},extend:e}}();
coherent.strings={"marker.input.multipleValues":"Multiple Values","marker.input.placeholder":"","marker.input.noSelection":"No Selection","marker.image.multipleValues":"","marker.image.placeholder":"","marker.image.noSelection":"","marker.text.multipleValues":"Multiple Values","marker.text.placeholder":"","marker.text.noSelection":"No Selection","error.no_description":"An unspecified error occurred.","error.invalid_value":"This value is not valid.","error.invalid_number":"This value is not a valid number."};
coherent.localisedString=function(a){return{valueOf:function(){return a in coherent.strings?coherent.strings[a]:null},toString:function(){if(a in coherent.strings)return coherent.strings[a];console.log("Localisation missing string for key: "+a);return a}}};var _=coherent.localisedString;coherent.Error=Class.create({constructor:function(a){Object.extend(this,a)},toString:function(){return this.description},description:_("error.no_description"),recoverySuggestion:null});
coherent.KeyInfo=Class.create({constructor:function(a,b){var c=coherent.KVO.getPropertyMethodsForKeyOnObject(b,a);this.__uid=[b,coherent.generateUid()].join("_");this.reader=c.getter;this.mutator=c.mutator;this.validator=c.validator;this.key=b;this.mutable=this.mutator||!this.reader?!0:!1;!this.reader&&!this.mutator&&(this.mutable=!0);this.changeCount=0;(c=c.value)&&!(coherent.typeOf(c)in coherent.KVO.typesOfKeyValuesToIgnore)&&c._addParentLink&&c._addParentLink(a,this)},get:function(a){if(this.reader)return this.reader.call(a);
var b;(b=this.key in a?a[this.key]:null)&&b._addParentLink&&b._addParentLink(a,this);return b},set:function(a,b){this.mutator?this.mutator.call(a,b):(a.willChangeValueForKey(this.key,this),"undefined"===typeof b&&(b=null),a[this.key]=b,a.didChangeValueForKey(this.key,this))},validate:function(a,b){return!this.validator?b:this.validator.call(a,b)},unlinkParentLink:function(){this.parentLink&&(this.parentLink.observer=null,this.parentLink=this.parentLink.callback=null)}});
coherent.ChangeType={setting:0,insertion:1,deletion:2,replacement:3};
coherent.ChangeNotification=Class.create({constructor:function(a,b,c,d,e){this.object=a;this.changeType=b;this.newValue=c;this.oldValue=d;this.indexes=e;this.objectKeyPath=[]},toString:function(){var a="[ChangeNotification changeType: ";switch(this.changeType){case coherent.ChangeType.setting:a+="setting";break;case coherent.ChangeType.insertion:a+="insertion";break;case coherent.ChangeType.deletion:a+="deletion";break;case coherent.ChangeType.replacement:a+="replacement";break;default:a+="<<unknown>>"}return a+=
" newValue="+this.newValue+" oldValue="+this.oldValue+(this.indexes?" indexes="+this.indexes.join(", "):"")+"]"}});coherent.ObserverEntry=Class.create({constructor:function(a,b,c){this.observer=a;this.callback=b;this.context=c},observeChangeForKeyPath:function(a,b){this.callback&&(this.observer&&-1===a.objectKeyPath.indexOf(this.observer))&&this.callback.call(this.observer,a,b,this.context)}});
coherent.KVO=Class.create({constructor:function(){},__factory__:function(){function a(){}var b=Array.from(arguments),c=this;return function(){a.prototype=c.prototype;var d=new a;c.prototype.constructor.apply(d,b);return d}},setValueForKeyPath:function(a,b){if(!b||0===b.length)throw new InvalidArgumentError("keyPath may not be empty");if("string"==typeof b){if("$"==b.charAt(0)){this.setValueForVariableKeyPath(a,b);return}b=b.split(".")}var c=b[0];1==b.length?this.setValueForKey(a,c):"@"!=c.charAt(0)&&
(c=this.valueForKey(c))&&c.setValueForKeyPath(a,b.slice(1))},setValueForVariableKeyPath:function(a,b){var c=coherent.VariableKeyPath.resolve(b,this);"undefined"!==typeof c&&this.setValueForKeyPath(a,c)},setValueForKey:function(a,b){if(!b||0===b.length)throw new InvalidArgumentError("key may not be empty");var c=this.infoForKey(b);c&&c.mutable&&c.set(this,a)},valueForKeyPath:function(a){if(!a||0===a.length)throw new InvalidArgumentError("keyPath may not be empty");if("string"==typeof a){if("$"==a.charAt(0))return this.valueForVariableKeypath(a);
a=a.split(".")}var b=a[0];if(1==a.length)return this.valueForKey(b);if("@"==b.charAt(0))return b=b.substr(1),a=this.valueForKeyPath(a.slice(1)),coherent.ArrayOperator[b](a);b=this.valueForKey(b);return"undefined"===typeof b||null===b?void 0:b.valueForKeyPath(a.slice(1))},valueForVariableKeypath:function(a){a=coherent.VariableKeyPath.resolve(a,this);return"undefined"===typeof a?void 0:this.valueForKeyPath(a)},valueForKey:function(a){if(!a||0===a.length)throw new InvalidArgumentError("the key is empty");
a=this.infoForKey(a);return!a?null:a.get(this)},validateValueForKeyPath:function(a,b){if(!b||0===b.length)throw new InvalidArgumentError("keyPath may not be empty");if("string"==typeof b){if("$"==b.charAt(0))return this.validateValueForVariableKeypath(a,b);b=b.split(".")}var c=b[0];if(1==b.length)return this.validateValueForKey(a,c);c=this.valueForKey(c);return"undefined"===typeof c||null===c?a:c.validateValueForKeyPath(a,b.slice(1))},validateValueForVariableKeypath:function(a,b){var c=coherent.VariableKeyPath.resolve(b,
this);return"undefined"===typeof c?a:this.validateValueForKeyPath(a,c)},validateValueForKey:function(a,b){if(!b||!b.length)throw new InvalidArgumentError("missing key");return this.infoForKey(b).validate(this,a)},observeChildObjectChangeForKeyPath:function(a,b,c){b=coherent.KVO.kAllPropertiesKey!=b?c+"."+b:c;a=Object.clone(a);a.object=this;this.notifyObserversOfChangeForKeyPath(a,b)},infoForKeyPath:function(a){if(!a||0===a.length)throw new InvalidArgumentError("keyPath is empty");if("string"==typeof a){if("$"==
a.charAt(0))return this.infoForVariableKeyPath(a);a=a.split(".")}var b=a[0];if(1==a.length)return this.infoForKey(b);if("@"==b.charAt(0))return a=new coherent.KeyInfo(null,null),a.mutable=!1,a;b=this.valueForKey(b);return!b||!b.infoForKeyPath?void 0:b.infoForKeyPath(a.slice(1))},infoForVariableKeyPath:function(a){a=coherent.VariableKeyPath.resolve(a,this);return"undefined"===typeof a?void 0:this.infoForKeyPath(a)},infoForKey:function(a){var b;this.__keys||(this.__keys={});if(coherent.KVO.kAllPropertiesKey==
a)return null;if(b=this.__keys[a])return b;b=new coherent.KeyInfo(this,a);return this.__keys[a]=b},setKeysTriggerChangeNotificationsForDependentKey:function(a,b){if(!a||!a.length)throw new InvalidArgumentError("keys array is not valid");if(!b)throw new InvalidArgumentError("dependentKey can not be null");if(-1!==b.indexOf("."))throw new InvalidArgumentError("dependentKey may not be a key path");var c,d;"string"===typeof a&&(a=[a]);this.__dependentKeys||(this.__dependentKeys={});for(d=0;d<a.length;++d){c=
a[d];if(!c)throw new InvalidArgumentError("key at index "+d+" was null");c in this.__dependentKeys||(this.__dependentKeys[c]=[]);coherent.KVO.getPropertyMethodsForKeyOnObject(c,this);c=this.__dependentKeys[c];-1==c.indexOf(b)&&c.push(b)}},mutableKeys:function(){var a=[],b,c;if("__mutableKeys"in this&&this.__mutableKeys.concat)return this.__mutableKeys;var d=Set.union(coherent.KVO.keysToIgnore,this.__keysToIgnore);for(b in this)b in d||"__"===b.substr(0,2)||(c=this[b],"function"!==typeof c?a.push(b):
1!==c.length||"set"!==b.substr(0,3)||(c=b.charAt(3),c===c.toUpperCase()&&(b=c.toLowerCase()+b.substr(4),b in d||-1===a.indexOf(b)&&a.push(b))));return a},initialiseKeyValueObserving:function(){this.__uid=this.__uid||coherent.generateUid();this.__observers={};this.__variableBindings={}},_addParentLink:function(a,b,c){this.hasOwnProperty("__observers")||this.initialiseKeyValueObserving();var d=this.__observers[coherent.KVO.kAllPropertiesKey];d||(d=this.__observers[coherent.KVO.kAllPropertiesKey]={});
c=c||b.__uid;c in d||(a=new coherent.ObserverEntry(a,a.observeChildObjectChangeForKeyPath,b?b.key:""),d[c]=a,b&&(b.unlinkParentLink(),b.parentLink=a))},_removeParentLink:function(a,b,c){this.__observers&&((a=this.__observers[coherent.KVO.kAllPropertiesKey])||(a=this.__observers[coherent.KVO.kAllPropertiesKey]={}),c=c||b.__uid,b&&b.parentLink===a[c]&&b.unlinkParentLink(),delete a[c])},addObserverForKeyPath:function(a,b,c,d){if(!c||0===c.length)throw new InvalidArgumentError("keyPath is empty");if(!a)throw new InvalidArgumentError("Observer may not be null");
b||(b=a.observeChangeForKeyPath);"string"===typeof b&&(b=a[b]);if(!b)throw new InvalidArgumentError("Missing callback method");this.hasOwnProperty("__observers")||this.initialiseKeyValueObserving();if("$"===c.charAt(0)){var e=this.__variableBindings[c];e||(e=coherent.Binding.bindingFromString(c,this),this.__variableBindings[c]=e,e.bind(),e.observerFn=function(a,b){var c=this.getObservers(),d;for(d in c)c[d].observeChangeForKeyPath(a,b)});e.addObserver(a,b,d)}else this.infoForKeyPath(c),this.__observers[c]||
(this.__observers[c]=[]),a=new coherent.ObserverEntry(a,b,d),this.__observers[c].push(a)},removeObserverForKeyPath:function(a,b){if(!b||0===b.length)throw new InvalidArgumentError("keyPath may not be empty");if(!a)throw new InvalidArgumentError("Observer may not be null");if(this.__observers)if("$"===b.charAt(0)){var c=this.__variableBindings[b];c&&c.removeObserver(a)}else if(this.__observers[b])for(var c=this.__observers[b],d=-1,e,f=c.length,d=0;d<f;++d)if(e=c[d],e.observer==a){c.splice(d,1);break}},
willChangeValueForKey:function(a,b){if(!a)throw new InvalidArgumentError("key may not be null");if((b=b instanceof coherent.KeyInfo?b:this.infoForKey(a))&&1===++b.changeCount){var c=this.__dependentKeys&&this.__dependentKeys[a];c&&c.forEach(this.willChangeValueForKey,this);b.previousValue=b.get(this)}},forceChangeNotificationForKey:function(a,b){if(!a)throw new InvalidArgumentError("key may not be null");if((b=b instanceof coherent.KeyInfo?b:this.infoForKey(a))&&0===b.changeCount)b.changeCount=1,
this.didChangeValueForKey(a,b)},didChangeValueForKey:function(a,b){if(!a)throw new InvalidArgumentError("key may not be null");if((b=b instanceof coherent.KeyInfo?b:this.infoForKey(a))&&0===--b.changeCount){var c=b.get(this),d=b.previousValue;b.previousValue=null;if(c!==d){var e=new coherent.ChangeNotification(this,coherent.ChangeType.setting,c,d);this.notifyObserversOfChangeForKeyPath(e,a);d&&d._removeParentLink&&d._removeParentLink(this,b);c&&c._addParentLink&&c._addParentLink(this,b)}(c=this.__dependentKeys&&
this.__dependentKeys[a])&&c.forEach(this.didChangeValueForKey,this)}},notifyObserversOfChangeForKeyPath:function(a,b){if(!b)throw new InvalidArgumentError("keyPath may not be null");if("$"===b.charAt(0))throw new InvalidArgumentError("keyPath cannot be a variable keypath");if(this.__observers){var c,d,e;if(d=this.__observers[coherent.KVO.kAllPropertiesKey]){var f=Object.clone(a),g=a.objectKeyPath.length;a.objectKeyPath.push(this);for(c in d)d[c].observeChangeForKeyPath(f,b);a.objectKeyPath.length=
g}if(coherent.KVO.kAllPropertiesKey!=b){if((d=this.__observers[b])&&d.length){e=d.length;for(c=0;c<e;++c)d[c].observeChangeForKeyPath(a,b)}var f=b+".",g=f.length,h,i,j=!(null===a.oldValue||"undefined"===typeof a.oldValue);for(h in this.__observers)if(h.substr(0,g)==f&&(d=this.__observers[h])&&d.length)if(c=h.substr(g),e=(e=a.oldValue)&&e.valueForKeyPath?e.valueForKeyPath(c):null,i=(i=a.newValue)&&i.valueForKeyPath?i.valueForKeyPath(c):null,!(j&&e===i)){i=new coherent.ChangeNotification(a.object,a.changeType,
i,e,a.indexes);e=d.length;for(c=0;c<e;++c)d[c].observeChangeForKeyPath(i,h)}}}},toJSON:function(){var a={};this.mutableKeys().forEach(function(b){a[b]=this[b]},this);return a}});coherent.KVO.kAllPropertiesKey="*";coherent.KVO.keysToIgnore=$S("__keys","__observers","__keysToIgnore","__dependentKeys","__mutableKeys","__factories__");coherent.KVO.typesOfKeyValuesToIgnore=$S("string","number","boolean","date","regexp","function");
coherent.KVO.getPropertyMethodsForKeyOnObject=function(){function a(a,b){function c(d){this.willChangeValueForKey(b);d=a.call(this,d);this.didChangeValueForKey(b);return d}c.__key=b;c.valueOf=function(){return a};c.toString=function(){return String(a)};return c}function b(a,b){function c(){var d=a.call(this),g=this.__keys?this.__keys[b]:null;if(!g)return d;d&&d._addParentLink?d._addParentLink(this,g):g.unlinkParentLink();return d}c.__key=b;c.valueOf=function(){return a};c.toString=function(){return String(a)};
return c}function c(c,d){var g=d.constructor.prototype,h=g==d,g=g!=Object.prototype&&g!=Array.prototype&&g!=coherent.KVO.prototype?g:d,i=c.titleCase(),j="get"+i,l="set"+i,k,n,m=d["validate"+i],r="undefined"!==typeof(i=d.__lookupGetter__(c))&&"undefined"!==typeof(k=d.__lookupSetter__(c));r||(j=j in d?j:c,i=d[j],k=d[l]);if("function"!==typeof i){var q=h="__kvo_prop_"+c,q=q||"__kvo_prop_"+c;k=function(){var a=null;q in this&&(a=this[q]);var b=this.__keys?this.__keys[c]:null;if(!b)return a;a&&a._addParentLink?
a._addParentLink(this,b):b.unlinkParentLink();return a};r=function(a){this.willChangeValueForKey(c);"undefined"===typeof a&&(a=null);this[q]=a;this.didChangeValueForKey(c);return a};r.__key=c;k.__key=c;c in d&&(n=d[h]="undefined"==typeof i?null:i,delete d[c]);i=k;k=r;r=!0}else 0!==i.length&&(i=null),k&&1!==k.length&&(k=null),i&&!h&&(n=i.valueOf().call(d)),i&&c!==i.__key&&(i=b(i,c)),k&&c!==k.__key&&(k=a(k,c));r?(g.__defineGetter__(c,i),g.__defineSetter__(c,k)):(i&&(d.hasOwnProperty(j)?d[j]=i:g[j]=
i),k&&(d.hasOwnProperty(l)?d[l]=k:g[l]=k));return{getter:i,mutator:k,validator:m,value:n}}function d(c,d){var g=d.constructor.prototype,h=g==d,g=g!=Object.prototype&&g!=Array.prototype&&g!=coherent.KVO.prototype?g:d,i=c.titleCase(),j="set"+i,l="get"+i,l=l in d?l:c,k=d[l],n=d[j],i=d["validate"+i],m;"function"!==typeof k?(c in d&&(m=k),n=k=null):(0!==k.length&&(k=null),n&&1!==n.length&&(n=null),k&&!h&&(m=k.valueOf().call(d)),k&&c!==k.__key&&(k=b(k,c)),n&&c!==n.__key&&(n=a(n,c)));k&&(d.hasOwnProperty(l)?
d[l]=k:g[l]=k);n&&(d.hasOwnProperty(j)?d[j]=n:g[j]=n);return{getter:k,mutator:n,validator:i,value:m}}return coherent.Support.Properties?c:d}();coherent.KVO.adapt=function(a){if(!a)throw new InvalidArgumentError("Can't adapt a null object");var b,c=coherent.KVO.prototype;for(b in c)b in a||(a[b]=c[b]);if("keyDependencies"in a&&!("__dependentKeys"in a))for(b in c=a.keyDependencies,c)a.setKeysTriggerChangeNotificationsForDependentKey(c[b],b);return a};
coherent.KVO.adaptTree=function(a){coherent.KVO.adapt(a);var b,c,d=coherent.KVO.keysToIgnore,e=coherent.KVO.typesOfKeyValuesToIgnore;for(b in a)d[b]||(c=a[b])&&(e[coherent.typeOf(c)]||coherent.KVO.adaptTree(c));return a};coherent.KVO.unadaptTree=function(a){var b;switch(coherent.typeOf(a)){case "object":b={};break;case "array":b=[];break;default:return a}if(!a.mutableKeys)return a;a.mutableKeys().forEach(function(c){b[c]=coherent.KVO.unadaptTree(a[c])});return b};
coherent.KVO.__subclassCreated__=function(a){var b=a.prototype;if(a.superclass.prototype.keyDependencies!==b.keyDependencies){var a=b.keyDependencies||{},c;for(c in a)b.setKeysTriggerChangeNotificationsForDependentKey(a[c],c)}};
coherent.Bindable=Class.create(coherent.KVO,{constructor:function(a){this.bindings={};this.__parameters=a;this.__context=coherent.dataModel},__createFactoryObjects:function(){var a=coherent.dataModel,b=this.__context;coherent.dataModel=this.__context=this;var c,d;for(c in this.__factories__)d=this[c],d.__factoryFn__&&(this[c]=d.call(this));coherent.dataModel=a;this.__context=b},exposedBindings:[],automaticallySetupBindings:!0,__relativeSource:null,__relativeSourceKeyPathPattern:/(\$|^)(\*.)(.+)/,
__relativeSourceKeyPathFormat:"$1$3",bindNameToKeyPath:function(a,b,c){var d,e=this;this.bindings||(this.bindings={});(d=this["observe"+a.titleCase()+"Change"])||(d=function(c){if(coherent.ChangeType.setting!==c.changeType)throw new InvalidArgumentError('Received invalid change type for synthesized binding observer (name="'+a+'" keyPath="'+b+'")');e.setValueForKey(c.newValue,a)});this.bindings[a]&&this.bindings[a].unbind();c=this.__relativeSourceKeyPathPattern.test(b)?coherent.Binding.bindingFromString(b.replace(this.__relativeSourceKeyPathPattern,
this.__relativeSourceKeyPathFormat),c):coherent.Binding.bindingFromString(b,this.__context);c.observerFn=d.bind(this);this.bindings[a]=c},__postConstruct:function(){this.automaticallySetupBindings&&(this.__initialising=!0,this.__copyParameters(this.__parameters||{}),this.setupBindings(),this.updateBindings(),this.createObservers(),delete this.__initialising)},__copyParameters:function(a){var b,c,d=coherent.KVO.adaptTree;for(b in a)-1===b.search(/Binding$/)&&(c=a[b],"object"===coherent.typeOf(c)&&
!("addObserverForKeyPath"in c)&&d(c),this[b]=c);this.__parameters=a},bindingInfoForName:function(a){return!this.__parameters?null:this.__parameters[a+"Binding"]||this.__parameters[a]},__createAutoObserver:function(a,b){var c=coherent.ChangeType.setting;return function(d){this.bindings[b]||c==d.changeType||a.apply(this,arguments)}},createObservers:function(){var a=this.exposedBindings,b=a.length,c,d,e;for(c=0;c<b;++c)if(e=a[c],d=this["observe"+e.titleCase()+"Change"])d=this.__createAutoObserver(d,
e),this.addObserverForKeyPath(this,d,e,"__auto_observer__")},setupBindings:function(){var a=this.exposedBindings,b=a.length,c,d,e;for(e=0;e<b;++e)d=a[e],(c=this.bindingInfoForName(d))&&this.bindNameToKeyPath(d,c,this.__relativeSource)},updateBindings:function(){var a=this.bindings,b=this.exposedBindings,c=b.length,d,e;for(e=0;e<c;++e)(d=a[b[e]])&&d.update()},unbind:function(){for(var a in this.bindings)this.bindings[a].unbind()}});
coherent.Bindable.__subclassCreated__=function(a){var b=a.superclass.prototype,a=a.prototype;b.exposedBindings!==a.exposedBindings&&(a.exposedBindings=b.exposedBindings.concat(a.exposedBindings))};
coherent.SortDescriptor=Class.create({constructor:function(a,b,c){this.keyPath=a;this.ascending=b;this.comparisonFn=c||this.defaultCompare;a=typeof this.comparisonFn;if("string"!=a&&"function"!=a)throw new InvalidArgumentError("comparisonFn must be either the name of a method or a function reference");},resolveComparisonFn:function(a){var b=this.comparisonFn;"string"===typeof b&&(b=a[b]);if("function"!==typeof b)throw new TypeError("comparisonFn does not resolve to a function");return b},compareObjects:function(a,
b){if(!a.valueForKeyPath||!b.valueForKeyPath)throw new InvalidArgumentError("Objects are not Key Value compliant");var c=a.valueForKeyPath(this.keyPath),d=b.valueForKeyPath(this.keyPath);return this.resolveComparisonFn(c).call(c,d)},defaultCompare:function(a){return coherent.compareValues(this,a)},reversedSortDescriptor:function(){return new coherent.SortDescriptor(this.keyPath,!this.ascending,this.comparisonFn)}});
coherent.Controller=Class.create(coherent.Bindable,{constructor:function(a){this.base(a)},registerWithName:function(a){a&&(this.name=a,coherent.registerModelWithName(this,a))}});coherent.Markers={MultipleValues:"ThisIsAnUniqueStringThatRepresentsMultipleValues",NoSelection:"ThisIsAnUniqueStringThatRepresentsNoSelection"};
coherent.SelectionProxy=Class.create(coherent.KVO,{constructor:function(a){this.controller=a;this.mutable=!0},infoForKey:function(a){a=this.controller.selectedObjects().infoForKey(a);a.mutable&=this.mutable;return a},infoForKeyPath:function(a){a=this.controller.selectedObjects().infoForKeyPath(a);a.mutable&=this.mutable;return a},translateValue:function(a){if("array"!==coherent.typeOf(a))return a;if(1===a.length)return a[0];var b,c,d=a[0];b=1;for(c=a.length;b<c;++b)if(0!==coherent.compareValues(d,
a[b]))return coherent.Markers.MultipleValues;return d},valueForKey:function(a){var b=this.controller.selectedObjects();if(0===b.length)return coherent.Markers.NoSelection;a=b.valueForKey(a);return this.translateValue(a)},validateValueForKeyPath:function(a,b){var c=this.controller.selectedObjects(),d=c.length,e;if(0===d)return a;var f;for(e=0;e<d&&!(f=c[e].validateValueForKeyPath(a,b),f instanceof coherent.Error);++e);return f},valueForKeyPath:function(a){var b=this.controller.selectedObjects();if(0===
b.length)return coherent.Markers.NoSelection;a=b.valueForKeyPath(a);return this.translateValue(a)},setValueForKey:function(a,b){if(this.mutable){var c=this.controller.selectedObjects(),d=this.valueForKey(b);c.setValueForKey(a,b);c=this.valueForKey(b);d!==c&&(d=new coherent.ChangeNotification(this,coherent.ChangeType.setting,c,d),this.notifyObserversOfChangeForKeyPath(d,b))}},setValueForKeyPath:function(a,b){if(this.mutable){var c=this.controller.selectedObjects(),d=this.valueForKeyPath(b);c.setValueForKeyPath(a,
b);c=this.valueForKeyPath(b);d!==c&&(d=new coherent.ChangeNotification(this,coherent.ChangeType.setting,c,d),this.notifyObserversOfChangeForKeyPath(d,b))}}});
coherent.ObjectController=Class.create(coherent.Controller,{constructor:function(a){this.base(a);this.objectClass=coherent.KVO;this.__content=null;this.__editable=!0;this.__selectedObjects=[];this.__selection=new coherent.SelectionProxy(this)},observeChildObjectChangeForKeyPath:function(a,b,c){this.base(a,b,c);"selectedObjects"===c&&(a="selection."+b,b=this.valueForKeyPath(a),b=new coherent.ChangeNotification(this,coherent.ChangeType.setting,b,null),this.notifyObserversOfChangeForKeyPath(b,a))},keyDependencies:{},
exposedBindings:["editable","content"],editable:function(){var a=this.__editable;this.bindings.content&&(a&=this.bindings.content.mutable());return a},setEditable:function(a){this.bindings.content&&(a&=this.bindings.content.mutable());this.bindings.editable&&this.bingings.editable.setValue(a);this.__editable=a},content:function(){return this.__content},setContent:function(a){this.bindings.content&&this.bindings.content.setValue(a);this.__content=a;this.willChangeValueForKey("selectedObjects");this.__selectedObjects=
a?[a]:[];this.didChangeValueForKey("selectedObjects");this.forceChangeNotificationForKey("selection")},selectedObjects:function(){return this.__selectedObjects},selection:function(){return this.__selection}});
window.XHR=function(){function a(a,c,d){function e(){}function f(){if(4===m.readyState)if(!1===p)arguments.callee.delay(0);else{var b=m.status,g=200<=b&&300>b||304==b;if(0===b||"undefined"===typeof b)g=window.location.protocol,g="file:"===g||"chrome:"===g;var x=m.responseText,k;if(g)if("HEAD"==c){x={};try{var A=m.getAllResponseHeaders();A&&(A=A.split("\n"),A.forEach(function(a){var a=a.match(/^([^:]+):(.+)$/m),b=a[1].trim();x[b]=a[2].trim()}))}catch(G){}}else{A=d.responseContentType||m.getResponseHeader("Content-Type");
if(A.match(/(?:application\/(?:x-)?json)|(?:text\/json)/))try{x=eval("("+x+")")}catch(C){k=C,g=!1}A.match(/(?:application|text)\/xml/)&&(x=m.responseXML)}else{k=Error("XHR request failed");k.url=a;k.method=c;k.xhr=m;try{k.status=m.status,k.statusText=m.statusText}catch(n){k.status=0,k.statusText=null}}g?u.callback(x):u.failure(k);m.onreadystatechange=e;m=null}}var g=(a||"").split("?");2==g.length?(a=g[0],g=Object.fromQueryString(g[1])):g={};var m=b(),g=Object.applyDefaults(d.parameters||{},g),g=Object.toQueryString(g),
r=d.body||"",q=!d.sync,u=new coherent.Deferred(function(){m.onreadystatechange=e;m.abort()}),p=!1,c=(c||"GET").toUpperCase();"GET"==c&&(a=a+"?"+g);d.user?m.open(c,a,q,d.user,d.password||""):m.open(c,a,q);var w=d.headers||{},v;for(v in w)m.setRequestHeader(v,w[v]);m.setRequestHeader("X-Requested-With","XMLHttpRequest");"POST"==c&&(m.setRequestHeader("Content-Type",d.contentType||"application/x-www-form-urlencoded"),r=r||g);q&&(m.onreadystatechange=f);m.send(r);p=!0;q||f();return u}var b=function(){throw Error("XMLHttpRequest not available.");
};if(coherent.Browser.IE)for(var c=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],d=c.length,e,f=0;f<d;++f)try{e=c[f];new ActiveXObject(e);b=function(){return new ActiveXObject(e)};break}catch(g){}else b=function(){return new XMLHttpRequest};return{get:function(a,b,c){return XHR.request("GET",a,b,c)},post:function(a,b,c){return XHR.request("POST",a,b,c)},request:function(b,c,d,e){b=b.toUpperCase();e=e||{};e.parameters=d;return a(c,b,e)}}}();
coherent.AjaxController=Class.create(coherent.ObjectController,{exposedBindings:["url"],flushContentBeforeQuery:!1,constructor:function(a){this.base(a);this.addObserverForKeyPath(this,this.queryUpdated,"url");this.addObserverForKeyPath(this,this.queryUpdated,"method");this.queryDelay=500;this.url="";this.method="GET";this.setValueForKey(new coherent.KVO,"parameters")},validateParameters:function(){return!0},observeChildObjectChangeForKeyPath:function(a,b,c){this.base(a,b,c);"parameters"===c&&this.queryUpdated(a,
b,c)},queryUpdated:function(){this.parameters&&this.validateParameters()&&(this.setValueForKey(!0,"queryInProgress"),this.__queryTimer&&window.clearTimeout(this.__queryTimer),this.__queryTimer=this.performQuery.bindAndDelay(this,this.queryDelay))},performQuery:function(){for(var a={},b=this.parameters.mutableKeys(),c=b.length,d,e,f=0;f<c;++f)d=b[f],this.parameters.hasOwnProperty(d)&&(e=this.parameters[d],""===e||(null===e||"undefined"===typeof e)||(a[d]=e));this.finalParameters(a);this.__request=
XHR.get(this.url,a,{responseContentType:"application/json"});this.__request.addMethods(this.querySucceeded.bind(this),this.queryFailed.bind(this));this.flushContentBeforeQuery&&this.setContent(null)},finalParameters:function(a){return a},extractContent:function(a){return a},querySucceeded:function(a){coherent.KVO.adaptTree(a);this.setContent(this.extractContent(a));this.setValueForKey("","statusCode");this.setValueForKey("","errorMessage");this.setValueForKey(!1,"queryInProgress")},queryFailed:function(a){console.log("failure: "+
this.url);this.setValueForKey(a.status,"statusCode");this.setValueForKey(a.statusText,"errorMessage");this.setContent(null);this.setValueForKey(!1,"queryInProgress")}});function IndexRange(a,b){var c,d=[];1==arguments.length&&a.length&&(b=a.length-1,a=0);for(c=a;c<=b;++c)d.push(c);return d}
coherent.ArrayController=Class.create(coherent.ObjectController,{constructor:function(a){this.base(a);this.arrangedObjects=[];this.__sortDescriptors=[];this.__filterPredicate=null;this.__selectionIndexes=[]},keyDependencies:{selectedObjects:["selectionIndexes"],selectionIndex:["selectionIndexes"],canRemove:["editable","selectionIndexes"],canAdd:["editable"]},selectsInsertedObjects:!0,exposedBindings:["selectionIndexes","sortDescriptors","filterPredicate","contentForMultipleSelection"],observeContentChange:function(a){switch(a.changeType){case coherent.ChangeType.setting:this.setContent(a.newValue);
break;case coherent.ChangeType.insertion:this._insertObjectsIntoArrangedObjects(a.newValue);if(this.selectsInsertedObjects){var b=this.selectedObjects(),b=b.concat(a.newValue);this.setSelectedObjects(b)}break;case coherent.ChangeType.deletion:this.rearrangeObjects();break;case coherent.ChangeType.replacement:this.rearrangeObjects()}},canAdd:function(){return this.editable()},add:function(){var a=new this.objectClass;this.content().addObject(a)},canRemove:function(){return this.editable()&&this.selectionIndexes().length},
remove:function(){var a=this.selectedObjects();this.content().removeObjects(a)},setContent:function(a){a=a||[];this.bindings.content&&this.bindings.content.setValue(a);this.__content=a;this.rearrangeObjects(a)},sortDescriptors:function(){return this.__sortDescriptors},setSortDescriptors:function(a){this.bindings.sortDescriptors&&this.bindings.sortDescriptors.setValue(a);this.__sortDescriptors=a;this.rearrangeObjects()},filterPredicate:function(){return this.__filterPredicate},setFilterPredicate:function(a){this.bindings.filterPredicate&&
this.bindings.filterPredicate.setValue(a);this.__filterPredicate=a;this.rearrangeObjects()},filterObjects:function(a){var b=this.filterPredicate();if(!b)return IndexRange(a);var c=[],d,e,f;d=0;for(e=a.length;d<e;++d)f=a[d],b(f)&&c.push(d);return c},_compareObjects:function(a,b){var c,d,e=this.sortDescriptors(),f=e.length;for(c=0;c<f;++c)if(d=e[c].compareObjects(a,b),e[c].ascending||(d*=-1),0!==d)return 0<d?1:-1;return 0},sortObjects:function(a,b){function c(b,c){var h,i,j=a[b],l=a[c],k=e,n=d;for(h=
0;h<k;++h)if(i=n[h].compareObjects(j,l),n[h].ascending||(i*=-1),0!==i)return i;return 0}var b=b||IndexRange(a),d=this.sortDescriptors(),e=d.length;0!==d.length&&b.sort(c);return b},arrangeObjects:function(a){var b=this.filterObjects(a),b=this.sortObjects(a,b);if(a===this.content()){for(var c=[],d=b.length,e=0;e<d;++e)c[b[e]]=e;this.__contentToArrangedMap=c;this.__arrangedToContentMap=b}return a.objectsAtIndexes(b)},rearrangeObjects:function(a){var a=a||this.content()||[],a=this.arrangeObjects(a),
b=this.selectedObjects(),c=[],d=b.length,e,f;for(f=0;f<d;++f)e=a.indexOf(b[f]),-1!==e&&c.push(e);this.setValueForKey(a,"arrangedObjects");this.setValueForKey(c,"selectionIndexes")},_insertObjectsIntoArrangedObjects:function(a){var a=this.arrangeObjects(a),b=a.length,c=this.arrangedObjects,d=c.length,e=[],f=0,g,h,i;e.length=b;for(i=0;i<b;++i){for(g=a[i];f<d;){h=c[f];if(-1===this._compareObjects(g,h))break;++f}e[i]=f+i}c.insertObjectsAtIndexes(a,e)},selectedObjects:function(){return this.__selectedObjects},
setSelectedObjects:function(a){var b=[],c,d,e=this.arrangedObjects;for(c=0;c<a.length;++c)d=e.indexOf(a[c]),-1!==d&&b.push(d);return this.setSelectionIndexes(b)},selectionIndexes:function(){return this.__selectionIndexes},setSelectionIndexes:function(a){a=a||[];a.sort();if(0===(this.selectionIndexes()||[]).compare(a))return!1;this.bindings.selectionIndexes&&this.bindings.selectionIndexes.setValue(a);this.__selectionIndexes=a;this.__selectedObjects=this.arrangedObjects.objectsAtIndexes(a);this.forceChangeNotificationForKey("selection");
return!0},setSelectionIndex:function(a){return this.setSelectionIndexes([a])},selectionIndex:function(){var a=this.selectionIndexes();return 0===a.length?-1:a[0]}});coherent.ModelController=Class.create(coherent.Controller,{constructor:function(a,b){"addObserverForKeyPath"in a||coherent.KVO.adaptTree(a);a.mutableKeys().forEach(function(b){this.setValueForKey(a[b],b)},this);this.base(b)}});
Object.extend(coherent,{dataModel:new coherent.KVO,registerModelWithName:function(a,b){coherent.dataModel.setValueForKey(a,b)},unregisterModelWithName:function(a){delete coherent.dataModel[a]}});coherent.ValueTransformer=Class.create({transformedValue:function(a){return a},reverseTransformedValue:function(a){return a},__factory__:function(){function a(){}var b=Array.from(arguments),c=this;return function(){a.prototype=c.prototype;var d=new a;c.prototype.constructor.apply(d,b);return d}}});
coherent.ValueTransformer.__subclassCreated__=function(a){coherent.ValueTransformer.prototype.reverseTransformedValue==a.prototype.reverseTransformedValue&&(a.prototype.reverseTransformedValue=null)};coherent.transformer={};coherent.transformerInstances={};
coherent.findTransformerWithName=function(a){var b=coherent.transformerInstances[a.toLowerCase()];if(b)return b;if(-1===a.indexOf("."))b=coherent.transformer[a];else try{b=eval(a)}catch(c){}if(b=b&&new b)return b;throw new InvalidArgumentError("The transformerName argument does not specify a valid ValueTransformer: "+a);};
coherent.registerTransformerWithName=function(a,b){if(!a.transformedValue)throw new InvalidArgumentError("The valueTransformer argument does not support the ValueTransformer method transformedValue");b=b.toLowerCase();coherent.transformerInstances[b]=a};coherent.transformer.Not=Class.create(coherent.ValueTransformer,{transformedValue:function(a){return a?!1:!0},reverseTransformedValue:function(a){return!!a}});coherent.registerTransformerWithName(new coherent.transformer.Not,"not");
coherent.transformer.Boolean=Class.create(coherent.ValueTransformer,{constructor:function(a,b){this.trueValue=a;this.falseValue=b},transformedValue:function(a){return a==this.trueValue},reverseTransformedValue:function(a){return a?this.trueValue:this.falseValue}});coherent.transformer.Matches=Class.create(coherent.ValueTransformer,{constructor:function(a){this.trueRegex=a},transformedValue:function(a){return this.trueRegex.test(a)}});
coherent.transformer.Generic=Class.create(coherent.ValueTransformer,{constructor:function(a,b){this.modelValues=a;this.displayValues=b},transformedValue:function(a){a=this.modelValues.indexOf(a);return-1==a?void 0:this.displayValues[a]},reverseTransformedValue:function(a){a=this.displayValues.indexOf(a);return-1==a?void 0:this.modelValues[a]}});
coherent.transformer.Truncated=Class.create(coherent.ValueTransformer,{constructor:function(a){this.max=a||50},ellipsis:String.fromCharCode(8230),transformedValue:function(a){return a?a.toString().truncate({from:"middle",length:this.max,omission:this.ellipsis}):a}});coherent.registerTransformerWithName(new coherent.transformer.Truncated(50),"truncated");
coherent.transformer.StringsToObjects=Class.create(coherent.ValueTransformer,{constructor:function(a){this.key=a||"string"},transformedValue:function(a){return!a||!a.map?a:a.map(function(a){var c=new coherent.KVO;c[this.key]=a;return c},this)},reverseTransformedValue:function(a){return!a||!a.map?a:a.map(function(a){return a[this.key]},this)}});coherent.registerTransformerWithName(new coherent.transformer.StringsToObjects("string"),"StringsToObjects");
coherent.transformer.ObjectToArray=Class.create(coherent.ValueTransformer,{transformedValue:function(a){var b=coherent.KVO.adapt([]);if(a)for(var c in a)b[a[c].index]=a[c];return b}});coherent.registerTransformerWithName(new coherent.transformer.ObjectToArray,"ObjectToArray");
(function(){function a(a,b,c,d){for(var e="previousSibling"==a,f=0,g=d.length;f<g;f++){var h=d[f];if(h){e&&1===h.nodeType&&(h.sizcache=c,h.sizset=f);for(var h=h[a],i=!1;h;){if(h.sizcache===c){i=d[h.sizset];break}1===h.nodeType&&(h.sizcache=c,h.sizset=f);if(h.nodeName===b){i=h;break}h=h[a]}d[f]=i}}}function b(a,b,c,d){for(var e="previousSibling"==a,f=0,g=d.length;f<g;f++){var h=d[f];if(h){e&&1===h.nodeType&&(h.sizcache=c,h.sizset=f);for(var h=h[a],j=!1;h;){if(h.sizcache===c){j=d[h.sizset];break}if(1===
h.nodeType)if(h.sizcache=c,h.sizset=f,"string"!==typeof b){if(h===b){j=!0;break}}else if(0<i.filter(b,[h]).length){j=h;break}h=h[a]}d[f]=j}}}var c=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?/g,d=0,e=Object.prototype.toString,f=Array.prototype.splice,g=Array.prototype.push,h=Array.prototype.sort,i=function(a,b,d,f){var d=d||[],h=b=b||document;if(1!==b.nodeType&&9!==b.nodeType)return[];if(!a||"string"!==typeof a)return d;var k=
[],m,p,q,u,r=!0;for(c.lastIndex=0;null!==(m=c.exec(a));)if(k.push(m[1]),m[2]){u=RegExp.rightContext;break}if(1<k.length&&l.exec(a))if(2===k.length&&j.relative[k[0]])p=t(k[0]+k[1],b);else for(p=j.relative[k[0]]?[b]:i(k.shift(),b);k.length;)a=k.shift(),j.relative[a]&&(a+=k.shift()),p=t(a,p);else if(!f&&(1<k.length&&9===b.nodeType&&j.match.ID.test(k[0])&&!j.match.ID.test(k[k.length-1]))&&(m=i.find(k.shift(),b),b=m.expr?i.filter(m.expr,m.set)[0]:m.set[0]),b){m=f?{expr:k.pop(),set:n(f)}:i.find(k.pop(),
1===k.length&&("~"===k[0]||"+"===k[0])&&b.parentNode?b.parentNode:b);p=m.expr?i.filter(m.expr,m.set):m.set;for(0<k.length?q=n(p):r=!1;k.length;){var w=k.pop();m=w;j.relative[w]?m=k.pop():w="";null==m&&(m=b);j.relative[w](q,m)}}else q=[];q||(q=p);if(!q)throw"Syntax error, unrecognized expression: "+(w||a);if("[object Array]"===e.call(q))if(r)if(b&&1===b.nodeType)for(a=0;null!=q[a];a++)q[a]&&(!0===q[a]||1===q[a].nodeType&&v(b,q[a]))&&g.call(d,p[a]);else for(a=0;null!=q[a];a++)q[a]&&1===q[a].nodeType&&
g.call(d,p[a]);else g.apply(d,q);else n(q,d);u&&(i(u,h,d,f),i.uniqueSort(d));return d};i.uniqueSort=function(a){if(r&&(hasDuplicate=!1,h.call(a,r),hasDuplicate))for(var b=1;b<a.length;b++)a[b]===a[b-1]&&f.call(a,b--,1)};i.matches=function(a,b){return i(a,null,null,b)};i.find=function(a,b){var c,d;if(!a)return[];for(var e=0,f=j.order.length;e<f;e++){var g=j.order[e];if(d=j.match[g].exec(a)){var h=RegExp.leftContext;if("\\"!==h.substr(h.length-1)&&(d[1]=(d[1]||"").replace(/\\/g,""),c=j.find[g](d,b),
null!=c)){a=a.replace(j.match[g],"");break}}}c||(c=b.getElementsByTagName("*"));return{set:c,expr:a}};i.filter=function(a,b,c,d){for(var e=a,f=[],g=b,h,i;a&&b.length;){for(var k in j.filter)if(null!=(h=j.match[k].exec(a))){var l=j.filter[k],t,m;i=!1;g==f&&(f=[]);if(j.preFilter[k])if(h=j.preFilter[k](h,g,c,f,d)){if(!0===h)continue}else i=t=!0;if(h)for(var p=0;null!=(m=g[p]);p++)if(m){t=l(m,h,p,g);var q=d^!!t;c&&null!=t?q?i=!0:g[p]=!1:q&&(f.push(m),i=!0)}if(void 0!==t){c||(g=f);a=a.replace(j.match[k],
"");if(!i)return[];break}}if(a==e){if(null==i)throw"Syntax error, unrecognized expression: "+a;break}e=a}return g};var j=i.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF_-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF_-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,
PSEUDO:/:((?:[\w\u00c0-\uFFFF_-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")}},relative:{"+":function(a,b){var c="string"===typeof b,d=c&&!/\W/.test(b),c=c&&!d;d&&(b=b.toUpperCase());for(var d=0,e=a.length,f;d<e;d++)if(f=a[d]){for(;(f=f.previousSibling)&&1!==f.nodeType;);a[d]=c||f&&f.nodeName===b?f||!1:f===b}c&&i.filter(b,a,!0)},">":function(a,b){var c="string"===typeof b;if(c&&!/\W/.test(b))for(var b=
b.toUpperCase(),d=0,e=a.length;d<e;d++){var f=a[d];f&&(c=f.parentNode,a[d]=c.nodeName===b?c:!1)}else{d=0;for(e=a.length;d<e;d++)(f=a[d])&&(a[d]=c?f.parentNode:f.parentNode===b);c&&i.filter(b,a,!0)}},"":function(c,e){var f=d++,g=b;if(!e.match(/\W/))var h=e=e.toUpperCase(),g=a;g("parentNode",e,f,c,h)},"~":function(c,e){var f=d++,g=b;if("string"===typeof e&&!e.match(/\W/))var h=e=e.toUpperCase(),g=a;g("previousSibling",e,f,c,h)}},find:{ID:function(a,b){if("undefined"!==typeof b.getElementById){var c=
b.getElementById(a[1]);return c?[c]:[]}},NAME:function(a,b){if("undefined"!==typeof b.getElementsByName){for(var c=[],d=b.getElementsByName(a[1]),e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return 0===c.length?null:c}},TAG:function(a,b){return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e){for(var a=" "+a[1].replace(/\\/g,"")+" ",f=0,g;null!=(g=b[f]);f++)g&&(e^(g.className&&0<=(" "+g.className+" ").indexOf(a))?c||d.push(g):c&&(b[f]=!1));return!1},ID:function(a){return a[1].replace(/\\/g,
"")},TAG:function(a){return a[1].toUpperCase()},CHILD:function(a){if("nth"==a[1]){var b=/(-?)(\d*)n((?:\+|-)?\d*)/.exec("even"==a[2]&&"2n"||"odd"==a[2]&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0;a[3]=b[3]-0}a[0]=d++;return a},ATTR:function(a){var b=a[1].replace(/\\/g,"");j.attrMap[b]&&(a[1]=j.attrMap[b]);"~="===a[2]&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(a,b,d,e,f){if("not"===a[1])if(1<a[3].match(c).length||/^\w/.test(a[3]))a[3]=i(a[3],null,null,b);else return a=i.filter(a[3],
b,d,1^f),d||e.push.apply(e,a),!1;else if(j.match.POS.test(a[0])||j.match.CHILD.test(a[0]))return!0;return a},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return!1===a.disabled&&"hidden"!==a.type},disabled:function(a){return!0===a.disabled},checked:function(a){return!0===a.checked},selected:function(a){a.parentNode.selectedIndex;return!0===a.selected},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!i(c[3],a).length},
header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){return"text"===a.type},radio:function(a){return"radio"===a.type},checkbox:function(a){return"checkbox"===a.type},file:function(a){return"file"===a.type},password:function(a){return"password"===a.type},submit:function(a){return"submit"===a.type},image:function(a){return"image"===a.type},reset:function(a){return"reset"===a.type},button:function(a){return"button"===a.type||"BUTTON"===a.nodeName.toUpperCase()},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)}},
setFilters:{first:function(a,b){return 0===b},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return 0===b%2},odd:function(a,b){return 1===b%2},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0==b},eq:function(a,b,c){return c[3]-0==b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=j.filters[e];if(f)return f(a,c,b,d);if("contains"===e)return 0<=(a.textContent||a.innerText||"").indexOf(b[3]);if("not"===e){b=b[3];c=0;for(d=b.length;c<
d;c++)if(b[c]===a)return!1;return!0}},CHILD:function(a,b){var c=b[1],d=a;switch(c){case "only":case "first":for(;d=d.previousSibling;)if(1===d.nodeType)return!1;if("first"==c)return!0;d=a;case "last":for(;d=d.nextSibling;)if(1===d.nodeType)return!1;return!0;case "nth":var c=b[2],e=b[3];if(1==c&&0==e)return!0;var f=b[0],g=a.parentNode;if(g&&(g.sizcache!==f||!a.nodeIndex)){for(var h=0,d=g.firstChild;d;d=d.nextSibling)1===d.nodeType&&(d.nodeIndex=++h);g.sizcache=f}d=a.nodeIndex-e;return 0==c?0==d:0==
d%c&&0<=d/c}},ID:function(a,b){return 1===a.nodeType&&a.getAttribute("id")===b},TAG:function(a,b){return"*"===b&&1===a.nodeType||a.nodeName===b},CLASS:function(a,b){return-1<(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)},ATTR:function(a,b){var c=b[1],c=j.attrHandle[c]?j.attrHandle[c](a):null!=a[c]?a[c]:a.getAttribute(c),d=c+"",e=b[2],f=b[4];return null==c?"!="===e:"="===e?d===f:"*="===e?0<=d.indexOf(f):"~="===e?0<=(" "+d+" ").indexOf(f):!f?d&&!1!==c:"!="===e?d!=f:"^="===e?0===d.indexOf(f):
"$="===e?d.substr(d.length-f.length)===f:"|="===e?d===f||d.substr(0,f.length+1)===f+"-":!1},POS:function(a,b,c,d){var e=j.setFilters[b[2]];if(e)return e(a,c,b,d)}}},l=j.match.POS,k;for(k in j.match)j.match[k]=RegExp(j.match[k].source+/(?![^\[]*\])(?![^\(]*\))/.source);var n=function(a,b){a=Array.prototype.slice.call(a);return b?(g.apply(b,a),b):a};try{Array.prototype.slice.call(document.documentElement.childNodes)}catch(m){n=function(a,b){var c=b||[];if("[object Array]"===e.call(a))Array.prototype.push.apply(c,
a);else if("number"===typeof a.length)for(var d=0,f=a.length;d<f;d++)c.push(a[d]);else for(d=0;a[d];d++)c.push(a[d]);return c}}var r;document.documentElement.compareDocumentPosition?r=function(a,b){var c=a.compareDocumentPosition(b)&4?-1:a===b?0:1;0===c&&(hasDuplicate=!0);return c}:"sourceIndex"in document.documentElement?r=function(a,b){var c=a.sourceIndex-b.sourceIndex;0===c&&(hasDuplicate=!0);return c}:document.createRange&&(r=function(a,b){var c=a.ownerDocument.createRange(),d=b.ownerDocument.createRange();
c.selectNode(a);c.collapse(!0);d.selectNode(b);d.collapse(!0);c=c.compareBoundaryPoints(Range.START_TO_END,d);0===c&&(hasDuplicate=!0);return c});k=document.createElement("form");var q="script"+(new Date).getTime();k.innerHTML="<input name='"+q+"'/>";var u=document.documentElement;u.insertBefore(k,u.firstChild);document.getElementById(q)&&(j.find.ID=function(a,b){if("undefined"!==typeof b.getElementById){var c=b.getElementById(a[1]);return c?c.id===a[1]||"undefined"!==typeof c.getAttributeNode&&c.getAttributeNode("id").nodeValue===
a[1]?[c]:void 0:[]}},j.filter.ID=function(a,b){var c="undefined"!==typeof a.getAttributeNode&&a.getAttributeNode("id");return 1===a.nodeType&&c&&c.nodeValue===b});u.removeChild(k);k=document.createElement("div");k.appendChild(document.createComment(""));0<k.getElementsByTagName("*").length&&(j.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if("*"===a[1]){for(var d=[],e=0;c[e];e++)1===c[e].nodeType&&d.push(c[e]);c=d}return c});k.innerHTML="<a href='#'></a>";k.firstChild&&("undefined"!==
typeof k.firstChild.getAttribute&&"#"!==k.firstChild.getAttribute("href"))&&(j.attrHandle.href=function(a){return a.getAttribute("href",2)});if(document.querySelectorAll){var p=i;k=document.createElement("div");k.innerHTML="<p class='TEST'></p>";if(!(k.querySelectorAll&&0===k.querySelectorAll(".TEST").length)){var i=function(a,b,c,d){b=b||document;if(!d&&9===b.nodeType)try{return n(b.querySelectorAll(a),c)}catch(e){}return p(a,b,c,d)},w;for(w in p)i[w]=p[w]}}document.getElementsByClassName&&document.documentElement.getElementsByClassName&&
(w=document.createElement("div"),w.innerHTML="<div class='test e'></div><div class='test'></div>",0!==w.getElementsByClassName("e").length&&(w.lastChild.className="e",1!==w.getElementsByClassName("e").length&&(j.order.splice(1,0,"CLASS"),j.find.CLASS=function(a,b){if("undefined"!==typeof b.getElementsByClassName)return b.getElementsByClassName(a[1])})));var v=document.compareDocumentPosition?function(a,b){return a.compareDocumentPosition(b)&16}:function(a,b){return a!==b&&(a.contains?a.contains(b):
!0)},t=function(a,b){for(var c=[],d="",e,f=b.nodeType?[b]:b;e=j.match.PSEUDO.exec(a);)d+=e[0],a=a.replace(j.match.PSEUDO,"");a=j.relative[a]?a+"*":a;e=0;for(var g=f.length;e<g;e++)i(a,f[e],c);return i.filter(d,c)};window.Sizzle=i})();(function(){var a=this.Element;this.Element={};Object.extend(this.Element,a||{})}).call(window);
Object.extend(Element,{NodeType:{ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},TABINDEX:"tabindex",uniqueId:function(){return"coherent_id_"+Element.assignId.uniqueId++},assignId:function(a){return a.id||(a.id="coherent_id_"+Element.assignId.uniqueId++)},hasAttribute:function(a,b){return"hasAttribute"in a?a.hasAttribute(b):b in a.attributes&&"undefined"!==typeof a.attributes[b]},
regexForClassName:function(a){var b=arguments.callee;b._lookup||(b._lookup={});return a in b._lookup?b._lookup[a]:b._lookup[a]=RegExp("(^|\\s)"+a+"(\\s|$)")},hasClassName:function(a,b){var c=a.className;return!c?!1:c==b?!0:Element.regexForClassName(b).test(c)},addClassName:function(a,b){b&&!Element.hasClassName(a,b)&&(a.className+=" "+b)},removeClassName:function(a,b){if(a&&b){var c=Element.regexForClassName(b);a.className=a.className.replace(c," ").trim()}},replaceClassName:function(a,b,c){b&&(c?
(b=Element.regexForClassName(b),a.className=a.className.replace(b,"$1"+c+"$2").trim()):Element.removeClassName(a,b))},toggleClassName:function(a,b){if(b){var c=Element.regexForClassName(b),d=a.className;a.className=c.test(d)?d.replace(c," ").trim():a.className+(" "+b)}},updateClass:function(a,b,c){var d=$S(a.className.split(" ")),e=Set.add,f=Set.remove,g,h;if("string"===typeof b)e(d,b);else{g=0;for(h=b.length;g<h;++g)e(d,b[g])}if("string"===typeof c)f(d,c);else{g=0;for(h=c.length;g<h;++g)f(d,c[g])}a.className=
Set.join(d," ")},PROPERTIES:"backgroundColor backgroundPosition borderTopColor borderRightColor borderBottomColor borderLeftColor borderTopWidth borderRightWidth borderBottomWidth borderLeftWidth color display fontSize letterSpacing lineHeight opacity width height top bottom left right marginTop marginRight marginBottom marginLeft paddingTop paddingRight paddingBottom paddingLeft".split(" "),getStyles:function(a,b){var c={},d=window.getComputedStyle(a,null);if("string"===typeof b)return a.style[b]||
d[b]||null;for(var b=b||Element.PROPERTIES,e,f=b.length,g=0;g<f;++g)e=b[g],c[e]=a.style[e]||d[e]||null;return c},setStyle:function(a,b,c){a.style[b]=c},setStyles:function(a,b){var c=a.style,d;for(d in b)c[d]=b[d]},isElement:function(a){return a.nodeType===Element.NodeType.ELEMENT},isVoidElement:function(a){var b=!1;switch(a.tagName.toLowerCase()){case "area":case "base":case "br":case "col":case "command":case "embed":case "hr":case "img":case "input":case "keygen":case "link":case "meta":case "param":case "source":case "track":case "wbr":b=
!0}return b},setInnerHTML:function(a,b){Element.innerHTML(a,b,!1)},appendInnerHTML:function(a,b){Element.innerHTML(a,b,!0)},innerHTML:function(a,b,c){var d=a.parentNode,e=d&&a.cloneNode(!1);d&&d.replaceChild(e,a);b=String.stringify(b);a.innerHTML=c?a.innerHTML+b.escapeForInnerHTML():b.escapeForInnerHTML();d&&d.replaceChild(a,e)},findDeepestFirstParentNode:function(a,b){var c=null,d,e;d=0;for(e=a.childNodes.length;d<e&&!(c=b(a.childNodes[d]));d++);return null!==c?Element.findDeepestFirstParentNode(c,
b):a},nonVoidElement:function(a){return Element.isElement(a)&&!Element.isVoidElement(a)&&a||null},setDeepestFirstElementInnerHTML:function(a,b){var c=Element.findDeepestFirstParentNode(a,Element.nonVoidElement);Element.innerHTML(c,b)},getDimensions:function(a){var b=Element.getStyle(a,"display");if(b&&"none"!=b)return{left:a.offsetLeft,top:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight};var b=a.style,c=b.visibility,d=b.position,e=b.display;b.visibility="hidden";b.position="absolute";b.display=
"block";a={width:a.offsetWidth,height:a.offsetHeight,left:a.offsetLeft,top:a.offsetTop};b.display=e;b.position=d;b.visibility=c;return a},clone:function(a){return a.cloneNode(!0)},depthFirstTraversal:function(a,b,c){if(a&&b)for(var d=a.nextSibling||a.parentNode,e,c=c||b;a!==d;){if(1===a.nodeType&&(e=b.call(c,a),!1!==e&&a.firstChild)){a=a.firstChild;continue}for(;!a.nextSibling;)if(a=a.parentNode,a===d)return;a=a.nextSibling}},query:function(a,b){1==arguments.length?(b=a,a=document):a!=document&&(b=
"#"+Element.assignId(a)+" "+b);var c;try{c=a.querySelector(b)}catch(d){c=Sizzle(b,a)[0]||null}return c},queryAll:function(a,b){1==arguments.length?(b=a,a=document):a!=document&&(b="#"+Element.assignId(a)+" "+b);var c;try{c=Array.from(a.querySelectorAll(b))}catch(d){c=Sizzle(b,a)}return c},match:function(a,b){return 1==Sizzle.matches(b,[a]).length},getViewport:function(){var a=["left","top","width","height"],b=a.length,c={},d=window,e,f;d.innerWidth?e=["pageXOffset","pageYOffset","innerWidth","innerHeight"]:
(e=["scrollLeft","scrollTop","clientWidth","clientHeight"],d=document.documentElement||document.body);for(f=0;f<b;f++)c[a[f]]=d[e[f]];return c},scrollParent:function(a){for(var b,c=Element.getStyles,d=document.body;a&&a!=d;){b=c(a,["overflow","overflowX","overflowY"]);if("visible"!==b.overflowX||"visible"!==b.overflowY||"visible"!==b.overflow)break;a=a.parentNode}return a},getRect:function(a,b){if(!a)return null;var c=document.documentElement,d=document.body,e=0,f=0;if(a!=document.body&&a.getBoundingClientRect)return e=
a.getBoundingClientRect(),e={left:e.left,right:e.right,top:e.top,bottom:e.bottom},!1===!!b?(e.left+=Math.max(c.scrollLeft,d.scrollLeft),e.right+=Math.max(c.scrollLeft,d.scrollLeft),e.top+=Math.max(c.scrollTop,d.scrollTop),e.bottom+=Math.max(c.scrollTop,d.scrollTop)):coherent.Browser.MobileSafari&&(e.top-=window.pageYOffset,e.bottom-=window.pageYOffset,e.left-=window.pageXOffset,e.right-=window.pageXOffset),e.left-=c.clientLeft,e.right-=c.clientLeft,e.top-=c.clientTop,e.bottom-=c.clientTop,e.width=
e.right-e.left,e.height=e.bottom-e.top,e;for(var g=a.parentNode,h=a,i=a.offsetParent,j=coherent.Browser.Mozilla,l=coherent.Browser.Safari&&!coherent.Browser.Safari2,k=coherent.Browser.Safari2,n=Element.getStyles,m=Element.getDimensions(a),r="fixed"===Element.getStyles(a,"position"),q,e=e+a.offsetLeft,f=f+a.offsetTop;!r&&i;){e+=i.offsetLeft;f+=i.offsetTop;if(j&&!/^t(able|d|h)$/i.test(i.tagName)||l)q=n(i,["borderLeftWidth","borderTopWidth"]),e+=parseInt(q.borderLeftWidth||0,10),f+=parseInt(q.borderTopWidth||
0,10);r||(r="fixed"===n(i,"position"));"BODY"!==i.tagName&&(h=i);i=i.offsetParent}for(i=j?["display","overflow","borderLeftWidth","borderTopWidth"]:["display"];g&&g.tagName&&"BODY"!==g.tagName&&"HTML"!==g.tagName;)q=n(g,i),/^inline|table.*$/i.test(q.display)||(e-=g.scrollLeft,f-=g.scrollTop),j&&"visible"!=q.overflow&&(e+=parseInt(q.borderLeftWidth||0,10),f+=parseInt(q.borderTopWidth||0,10)),g=g.parentNode;g=n(h,"position");if(k&&(r||"absolute"==g)||j&&"absolute"!=g)e-=d.offsetLeft,f-=d.offsetTop;
!0===b&&!r&&(e-=Math.max(window.pageXOffset,c.scrollLeft,d.scrollLeft),f-=Math.max(window.pageYOffset,c.scrollTop,d.scrollTop));return{left:e,top:f,right:e+m.width-1,bottom:f+m.height-1,width:m.width,height:m.height}},offsetFromAncestor:function(a,b){for(var c=a&&a.offsetWidth&&{top:a.offsetTop,left:a.offsetLeft,width:a.offsetWidth,height:a.offsetHeight},b=c&&(b||document.body);b&&a&&b!==a;)a=a.parentNode,c.top+=a.offsetTop,c.left+=a.offsetLeft;return c},locateAncestor:function(a,b,c){if("function"!=
typeof b)throw new TypeError("Qualifier must be a function");for(c=c||document.documentElement;a&&a!=c;){if(b(a))return a;a=a.parentNode}return null},scrollDocumentTopBy:function(a){document.documentElement.scrollTop=document.body.scrollTop=a},scrollDocumentLeftBy:function(a){document.documentElement.scrollLeft=document.body.scrollLeft=a},getDocumentScrollTop:function(){return document.documentElement.scrollTop||document.body.scrollTop},getDocumentScrollLeft:function(){return document.documentElement.scrollLeft||
document.body.scrollLeft},isFixedPositionSupported:function(){var a=document.body,b=a.appendChild(document.createElement("DIV")),c=b.appendChild(document.createElement("DIV")),d=Element.getDocumentScrollTop(),e;e=!0;a.getBoundingClientRect&&(b.style.cssText="position:relative;height:9999px;width:1px;",c.style.cssText="position:fixed;top:1px;width:1px;height:1px;",Element.scrollDocumentTopBy(0),e=c.getBoundingClientRect().top,Element.scrollDocumentTopBy(4),c=c.getBoundingClientRect().top,e=(e===c||
0>c)&&4===Element.getDocumentScrollTop(),Element.scrollDocumentLeftBy(d));a.removeChild(b);return e},hidden:function(a){return!Element.visible(a)},visible:function(a){var b="none"!==(a.style&&a.style.display);return(0<a.offsetWidth||0<a.offsetHeight)&&b},tabIndex:function(a){if(a.nodeType===Element.NodeType.ELEMENT||a.nodeType===Element.NodeType.DOCUMENT){var b=a.getAttributeNode(Element.TABINDEX);return parseInt((b?b.specified:!1)&&a.getAttribute(Element.TABINDEX),10)}},findFocusables:function(a,
b,c){var d=[],e=0,c="boolean"===typeof c?c:"boolean"===typeof b?b:!0,f=b;"string"===typeof b&&("first"===b.toLowerCase()?f=1:"last"===b.toLowerCase()&&(f=-1));b=parseInt(f,10);Element.depthFirstTraversal(a,function(a){(Element.tabIndex(a)||Element._findFocusables.isValidEl(a))&&d.push({node:a,dfs:e++})});c&&(d=d.filter(function(a){return Element.visible(a.node)&&0<=(a.node.getAttribute(Element.TABINDEX)||0)}));d=d.sort(function(a,b){var c=parseInt(a.node.getAttribute(Element.TABINDEX),10)||0,d=parseInt(b.node.getAttribute(Element.TABINDEX),
10)||0;return c===d?a.dfs>b.dfs?1:-1:0<c&&0<d?d<c?1:-1:d>c?1:-1}).map(function(a){return a.node});return-1===b?d[d.length-1]:1===b?d[0]:d.slice(0,b||d.length)},_findFocusables:{validNodeNames:["A","INPUT","SELECT","BUTTON","TEXTAREA"],isValidEl:function(a){return Element._findFocusables.validNodeNames.some(function(b){return a.nodeName.toUpperCase()===b})}}});Element.getStyle=Element.getStyles;Element.assignId.uniqueId=1;
coherent.Support.QuerySelector||Object.extend(Element,{query:function(a,b){1==arguments.length&&(b=a,a=document);return Sizzle(b,a)[0]||null},queryAll:function(a,b){1==arguments.length&&(b=a,a=document);return Sizzle(b,a)||null}});(function(){var a=this.Event;this.Event={};Object.extend(this.Event,a||{})}).call(window);
Object.extend(Event,{KEY_BACKSPACE:8,KEY_TAB:9,KEY_CLEAR:12,KEY_RETURN:13,KEY_SHIFT:16,KEY_CTRL:17,KEY_ALT:18,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,KEY_CAPSLOCK:20,KEY_LEFTCOMMAND:91,KEY_RIGHTCOMMAND:93,KEY_MOZILLACOMMAND:224,KEY_RIGHTWINDOWSSTART:92,MOUSE_LEFT:1,MOUSE_RIGHT:3,shiftKey:!1,_domHasFinishedLoading:function(){if(!arguments.callee.done){arguments.callee.done=!0;Event._domLoadedTimer&&window.clearInterval(Event._domLoadedTimer);
var a=Event._readyCallbacks,b=a.length,c;for(c=0;c<b;++c)a[c]();Event._readyCallbacks=null}},observe:function(a,b,c){"on"==b.slice(0,2)&&(b=b.slice(2));a.addEventListener(b,c,!1)},stopObserving:function(a,b,c){"on"==b.slice(0,2)&&(b=b.slice(2));a.removeEventListener(b,c,!1)},stop:function(a){a.preventDefault();a.stopPropagation()},preventDefault:function(a){a.preventDefault()},onDomReady:function(a){if(Event._domHasFinishedLoading.done)window.setTimeout(a,0);else{if(!Event._readyCallbacks){document.addEventListener("DOMContentLoaded",
Event._domHasFinishedLoading,!1);var b=function(){/loaded|complete/.test(document.readyState)&&Event._domHasFinishedLoading()};coherent.Browser.Safari&&(Event._domLoadedTimer=window.setInterval(b,10));Event.observe(window,"load",Event._domHasFinishedLoading);Event._readyCallbacks=[]}Event._readyCallbacks.push(a)}},isModifiedKey:function(a){return!(!a.altKey&&!a.ctrlKey&&!a.metaKey)},isMetaKey:function(a){switch(a.keyCode){case this.KEY_TAB:case this.KEY_CLEAR:case this.KEY_RETURN:case this.KEY_SHIFT:case this.KEY_CTRL:case this.KEY_ALT:case this.KEY_ESC:case this.KEY_LEFT:case this.KEY_UP:case this.KEY_RIGHT:case this.KEY_DOWN:case this.KEY_HOME:case this.KEY_END:case this.KEY_PAGEUP:case this.KEY_PAGEDOWN:case this.KEY_INSERT:case this.KEY_CAPSLOCK:case this.KEY_LEFTCOMMAND:case this.KEY_RIGHTCOMMAND:case this.KEY_MOZILLACOMMAND:case this.KEY_RIGHTWINDOWSSTART:return!0}return!1}});
coherent.PartFinder=function(){function a(a,c){var d=Element.queryAll(a,c),e=Array.map(d,Element.assignId);return{nodes:d,ids:e}}return{singlePart:function(b,c){return function(){var d=c,e=typeof d;"function"===e?d=d():"string"===e?d=document.getElementById(d):d||(d=this.viewElement());var d=a(d,b),f=d.ids[0],g=function(){h=null},h=d.nodes[0],e=function(){if(h)return h;h=document.getElementById(f);window.setTimeout(g,250);return h},i=Class.findPropertyName(this,arguments.callee);i&&(this[i]=e);return d.nodes[0]}},
multipleParts:function(b,c){return function(d){var e=c,f=typeof e;"function"===f?e=e():"string"===f?e=document.getElementById(e):e||(e=this.viewElement());var e=a(e,b),g=e.ids,h=e.nodes,i=function(){l=null},f=function(a){if(l)return 1==arguments.length?l[a]:l;if(1==arguments.length)return document.getElementById(g[a]);for(var b=[],c=0;c<j;++c)b[c]=document.getElementById(g[c]);l=b;window.setTimeout(i,250);return b},j=g.length,l=Array.from(h);h&&window.setTimeout(i,250);f.removePartAtIndex=function(a){g.splice(a,
1);l&&l.splice(a,1);j=g.length};f.removePart=function(a){a=Element.assignId(a);a=g.indexOf(a);-1!=a&&(g.splice(a,1),l&&l.splice(a,1),j=g.length)};f.insertPartAtIndex=function(a,b){var c=Element.assignId(a);g.splice(b,0,c);l&&l.splice(b,0,a);j=g.length};f.add=function(a){g.push(Element.assignId(a));j=g.length;l&&l.push(a)};f.removeAll=function(){g=[];l=null;j=0};f.refresh=function(){for(var a=[],b,c=0;c<j;++c)(b=document.getElementById(g[c]))&&a.push(g[c]);g=a;j=a.length;l=null};(h=Class.findPropertyName(this,
arguments.callee))&&(this[h]=f);return arguments.length?e.nodes[d]:Array.from(e.nodes)}}}}();var Part=coherent.PartFinder.singlePart,PartList=coherent.PartFinder.multipleParts;
coherent.Style={kSelectedClass:"selected",kDisabledClass:"disabled",kReadOnlyClass:"read-only",kMarkerClass:"nullValue",kFocusClass:"focused",kHoverClass:"hover",kAscendingClass:"asc",kDescendingClass:"desc",kActiveClass:"active",kEditingClass:"editing",kUpdatingClass:"updating",kFadingClass:"invisible",kInvalidValueClass:"invalid",kInsertedClass:"inserted",kDeletedClass:"deleted",kReplacingClass:"replacing",kLoadingClass:"loading",kFirstClass:"first",kLastClass:"last"};
coherent.Style.__styles=function(){var a=[],b=coherent.Style,c;for(c in b)a.push(b[c]);return a}();coherent.setupSelectors=function(a,b,c){function d(a){for(var b in g)a.setAttribute(b,g[b])}var a=a||document.body,e,f,g,h=Element.queryAll;for(e in b)f=h(a,e),g=b[e],Array.forEach(f,d);coherent.View.createViewsForNodeTree(a,c)};window.FIRST_RESPONDER="__first_responder__";
coherent.Responder=Class.create(coherent.Bindable,{sendActionToView:function(a,b){FIRST_RESPONDER===b&&(b=coherent.page.firstResponder);for(var c=b||coherent.page.firstResponder||this;c;){if(a in c)return c[a](this),!0;c=c.nextResponder()}return!1},acceptsFirstResponder:function(){return!1},becomeFirstResponder:function(){return!0},resignFirstResponder:function(){return!0},nextResponder:function(){return this.__nextResponder||null},setNextResponder:function(a){this.__nextResponder=a},presentError:function(a){this.willPresentError(a);
"field"in a||(a.field=this);var b=this.nextResponder();return b?b.presentError(a):!1},clearAllErrors:function(a){var b=this.nextResponder();b&&b.clearAllErrors(a||this)},willPresentError:function(){},onmousedown:function(a){var b=this.nextResponder();if(b)b.onmousedown(a)},onmouseup:function(a){var b=this.nextResponder();if(b)b.onmouseup(a)},onmousedrag:function(a){var b=this.nextResponder();if(b)b.onmousedrag(a)},onmouseenter:function(a){var b=this.nextResponder();if(b)b.onmouseenter(a)},onmouseleave:function(a){var b=
this.nextResponder();if(b)b.onmouseleave(a)},onclick:function(a){var b=this.nextResponder();if(b)b.onclick(a)},ondblclick:function(a){var b=this.nextResponder();if(b)b.ondblclick(a)},onkeydown:function(a){var b=this.nextResponder();if(b)b.onkeydown(a)},onkeyup:function(a){var b=this.nextResponder();if(b)b.onkeyup(a)},onkeypress:function(a){var b=this.nextResponder();if(b)b.onkeypress(a)},ontouchstart:function(a){var b=this.nextResponder();if(b)b.ontouchstart(a)},ontouchmove:function(a){var b=this.nextResponder();
if(b)b.ontouchmove(a)},ontouchend:function(a){var b=this.nextResponder();if(b)b.ontouchend(a)}});
coherent.View=Class.create(coherent.Responder,{__viewClassName__:"View",__tagSpec__:"div b strong em i q p span li h1 h2 h3 h4 td label".split(" "),multipleValuesPlaceholder:_("marker.text.multipleValues"),nullPlaceholder:_("marker.text.placeholder"),noSelectionPlaceholder:_("marker.text.noSelection"),exposedBindings:"visible class enabled editable html text tabindex title".split(" "),automaticallySetupBindings:!1,requireBindingsForInferredViewType:!0,formatter:null,target:null,action:null,sendActionOn:["click"],
animated:!1,updateAnimationDuration:0,updateAnimationDelay:0,postUpdateAnimationDuration:0,postUpdateAnimationDelay:0,preUpdateAnimationDuration:0,preUpdateAnimationDelay:0,constructor:function(a,b,c){this.base(c);"string"===typeof a?(this.id=a,this.__view=document.getElementById(a)):(this.id=Element.assignId(a),this.__view=a);b&&!("addObserverForKeyPath"in b)&&coherent.KVO.adaptTree(b);this.__relativeSource=b;if(this.id in coherent.View.viewLookup)throw Error("Two views share the same ID: "+this.id);
this.__updating=null;coherent.View.viewLookup[this.id]=this},__postConstruct:function(){var a=this;(function(){delete a.__view;delete a.__container}).delay(250);if(this.viewElement())this.__init();else Event.onDomReady(this.__init.bind(this))},__init:function(){this.__initialising=!0;var a=this.viewElement();if(!a)throw Error("Unable to locate node with ID: "+this.id);this.viewElement=function(){return a};var b,c;"true"===a.getAttribute("animated")&&(this.animated=!0);b=a.getAttribute("__parametersId");
this.__copyParameters(this.__parameters||coherent.View.nodeParameters[b]||{});this.innerHTML&&""===String(a.innerHTML).trim()&&(a.innerHTML=this.innerHTML);var d=coherent.dataModel,e=this.__context;coherent.dataModel=this.__context=this;var f=this.structure()||{},g={};for(c in f)if((b=f[c])&&"function"==typeof b&&(b=b.valueOf()).__factoryFn__)g[c]=b,b.call(this,c,!0);for(c in g)g[c].call(this,c,!1);this.__context=e;coherent.dataModel=d;this.setupBindings();this.init();this.updateBindings();this.createObservers();
delete this.__initialising;delete this.viewElement},bindingInfoForName:function(a){var b=this.viewElement(),c=a+"Binding";return b.getAttribute(c)||this.__parameters[c]||this.__parameters[a]},teardown:function(){for(var a in this.bindings)this.bindings[a].unbind();delete coherent.View.viewLookup[this.id]},__factory__:function(a,b,c){function d(a){a.setAttribute("__parametersId",h);"sortKey"in b&&a.setAttribute("sortKey",b.sortKey)}function e(a){a.getAttribute("__parametersId")||d(a);var b=this.__relativeSource||
this;coherent.View.fromNode(a)||new f(a,b);coherent.View.createViewsForNodeTree(a,b,this.__context)}var f=this,g=Element.queryAll;"string"!==typeof a&&(c=b,b=a,a=null);var b=b||{},h="parameters_"+coherent.generateUid();coherent.View.nodeParameters[h]=b;b.viewClass=f;return function(h,j){if(h&&1===h.nodeType)return new f(h,j,b);var l=c||(this?this.viewElement():document),k=a||h;l=/^#\S+$/.test(k)?(l=document.getElementById(k.substring(1)))?[l]:[]:g(l,k)||[];if(!l.length)return null;if("action"in b){if(!b.target||
b.target!==FIRST_RESPONDER)b.target=this;FIRST_RESPONDER!==b.target&&"string"===typeof b.action&&(b.action=b.target[b.action])}Array.forEach(l,j?d:e,this);return coherent.View.fromNode(l[0])}},init:function(){var a=this.viewElement(),b=this.bindings;if(b["class"]&&!b["class"].hasValue()){var c=$S(a.className.split(" "));coherent.Style.__styles.forEach(function(a){delete c[a]});var d=Set.join(c," ");b["class"].setValue(d)}b.enabled&&!b.enabled.hasValue()&&b.enabled.setValue(!a.disabled);b.text&&!b.text.hasValue()&&
(d=(a.textContent||a.innerText||"").trim())&&b.text.setValue(d);b.html&&!b.html.hasValue()&&(d=(a.innerHTML||"").trim())&&b.html.setValue(d);b.title&&(!b.title.hasValue()&&a.title)&&b.title.setValue(a.title)},structure:function(){return this.__structure__},viewElement:function(){return this.__view||document.getElementById(this.id)},container:function(){return this.__container||this.__view||document.getElementById(this.__containerId||this.id)},setContainer:function(a){this.__view&&(this.__container=
a);this.__containerId=Element.assignId(a);return a},superview:function(){var a=this.viewElement();if(!a)return null;for(var b=null;a&&!b;){a=a.parentNode;if(!a)return null;if(document==a)return coherent.page;b=coherent.View.fromNode(a)}return b},isDescendantOf:function(a){if(!a)return!1;for(var a=a.viewElement(),b=this.viewElement();b&&b!==document.body;){if(b.id==a.id)return!0;b=b.parentNode}return!1},nextResponder:function(){return this.__nextResponder||this.superview()},focus:function(){function a(){b.focus()}
var b=this.viewElement();coherent.Browser.IE?/^(?:a|button|iframe|input|label|select|textarea)$/i.test(b.nodeName)?(this.focus=a,a()):this.focus=function(){}:(this.focus=a,a())},blur:function(){function a(){b.blur()}var b=this.viewElement();coherent.Browser.IE?/^(?:a|button|iframe|input|label|select|textarea)$/i.test(b.nodeName)?(this.blur=a,a()):this.blur=function(){}:(this.blur=a,a())},setDelegate:function(a){this.delegate=a},sendToDelegate:function(a){if(this.delegate&&"function"==typeof this.delegate[a])this.delegate[a](this)},
sendAction:function(){var a=coherent.EventLoop.currentEvent;if(this.action)if(FIRST_RESPONDER!==this.target||"string"!==typeof this.action)this.action.call(this.target||this.action,this,a);else for(var b=coherent.page.firstResponder||this,c=this.action;b;){if(c in b){b[c](this,a);break}b=b.nextResponder()}},onclick:function(a){this.disabled?Event.stop(a):this.action&&this.sendActionOn.containsObject("click")?(this.sendAction(),Event.stop(a)):this.base(a)},addTrackingInfo:function(a){coherent.page.addTrackingInfo(this.id,
a)},observeVisibleChange:function(a){function b(){c.style.display="none";Element.removeClassName(c,d)}var c=this.viewElement(),d=coherent.Style.kFadingClass;!this.animated||this.__initialising?c.style.display=a.newValue?"":"none":a.newValue?(""!==c.style.display&&(Element.addClassName(c,d),c.style.display=""),coherent.Animator.removeClassName(c,d,{duration:this.updateAnimationDuration||300})):coherent.Animator.addClassName(c,d,{duration:this.updateAnimationDuration||300,callback:b})},observeEnabledChange:function(a){var b=
this.viewElement();this.disabled=b.disabled=!a.newValue;b.disabled?Element.addClassName(b,coherent.Style.kDisabledClass):Element.removeClassName(b,coherent.Style.kDisabledClass)},observeEditableChange:function(a){var b=this.viewElement();b.readOnly=!a.newValue;b.readOnly?Element.addClassName(b,coherent.Style.kReadOnlyClass):Element.removeClassName(b,coherent.Style.kReadOnlyClass)},observeClassChange:function(a){var b=this.viewElement(),c=$S(b.className.split(" ")),d=$S((a.newValue||"").split(" "));
coherent.Style.__styles.forEach(function(a){a in c&&Set.add(d,a)});a=Set.join(d," ");this.animated&&!this.__initialising?coherent.Animator.setClassName(b,a,{duration:500}):b.className=a},translateValue:function(a){var b=this.viewElement(),c=!0;this.formatter&&(a=this.formatter.stringForValue(a));switch(a){case "":case null:case void 0:a=this.attributeOrProperty("nullPlaceholder");break;case coherent.Markers.NoSelection:a=this.attributeOrProperty("noSelectionPlaceholder");break;case coherent.Markers.MultipleValues:a=
this.attributeOrProperty("multipleValuesPlaceholder");break;default:a=String(a),c=!1}c?Element.addClassName(b,coherent.Style.kMarkerClass):Element.removeClassName(b,coherent.Style.kMarkerClass);return a},_beginUpdate:function(a,b){function c(){e.__updating&&e.__updating.call(e);e.__updating=null;coherent.Animator.removeClassName(d,b,{duration:e.postUpdateAnimationDuration||e.updateAnimationDuration,delay:e.postUpdateAnimationDelay||e.updateAnimationDelay})}if(0===(this.preUpdateAnimationDuration||
this.updateAnimationDuration||this.postUpdateAnimationDuration)&&a)a.call(this);else{var b=b||coherent.Style.kUpdatingClass,d=this.viewElement(),e=this;this.__updating?this.__updating=a||null:(this.__updating=a||null,coherent.Animator.addClassName(d,b,{duration:this.preUpdateAnimationDuration||this.updateAnimationDuration,callback:c}))}},observeTitleChange:function(a){this.viewElement().title=a.newValue},observeTextChange:function(a){function b(){var a=document.createTextNode(d);c.innerHTML="";c.appendChild(a)}
var c=this.viewElement(),d=(this.translateValue(a.newValue)||"").trim();this.lastText!==d&&(this.lastText=d,this._beginUpdate(b))},observeHtmlChange:function(a){function b(){var a=document.createTextNode(e);d.innerHTML="";d.appendChild(a)}function c(){Element.setInnerHTML(d,e)}var d=this.viewElement(),a=a.newValue;"string"===typeof a&&(a=a.trim());var e=(this.translateValue(a)||"").trim();e!==a?(d.textContent||d.innerText||"").trim()!==e&&this._beginUpdate(b):(d.innerHTML||"").trim()!==e&&this._beginUpdate(c)},
observeTabindexChange:function(a){var b=this.viewElement(),a=a.newValue;0!==a&&!a?b.removeAttribute("tabindex"):b.setAttribute("tabindex",a)},removeChild:function(a){if(!a)return null;coherent.View.teardownViewsForNodeTree(a);this.beforeRemoveElement&&this.beforeRemoveElement(a);return a.parentNode.removeChild(a)},attributeOrProperty:function(){return coherent.Browser.IE?function(a){var b=this.viewElement()[a];return b||""===b?b:String(this[a])}:function(a){var b=this.viewElement(),c=b.getAttribute(a);
return c||""===c?c:(c=b[a])||""===c?c:String(this[a])}}()});coherent.View.nodeParameters={};coherent.View.viewLookup={};coherent.View.registry={};coherent.View.tagToViewLookup={};coherent.View.tagSpecRegex=/^(\w+)\s*(?:\[(\w*)\s*=\s*(\w*)\s*\])?$/;
coherent.View.__updateTagSpecTable=function(a){function b(b){var d=b.match(coherent.View.tagSpecRegex);if(!d)throw Error("Invalid view spec: "+b);var g=d[1].toUpperCase(),h=d[2],d=d[3],i=coherent.View.tagToViewLookup[g]||{};g in coherent.View.tagToViewLookup||(coherent.View.tagToViewLookup[g]=i);if(h){i.attr||(i.attr={});h in i.attr||(i.attr[h]={});if(d in i.attr[h])throw console.log((c.__viewClassName__+": "||"")+"Redefining view spec: "+b+": previously registered to "+(i.viewClass.prototype.__viewClassName__||
"unknown")),Error("Redefining view spec: "+b);i.attr[h][d]=a}else{if(i.viewClass)throw console.log((c.__viewClassName__+": "||"")+"Redefining view spec: "+b+": previously registered to "+(i.viewClass.prototype.__viewClassName__||"unknown")),Error("Redefining view spec: "+b);i.viewClass=a}}var c=a.prototype;if(c.hasOwnProperty("__tagSpec__")){var d=c.__tagSpec__;"string"==typeof d?b(d):"forEach"in d?d.forEach(b):console.log("Invalid type for __tagSpec__")}c.hasOwnProperty("__viewClassName__")&&(coherent.View.registry[c.__viewClassName__]=
a)};coherent.View.__subclassCreated__=function(a){coherent.View.registry||(coherent.View.registry={});var b=a.prototype,c=a.superclass.prototype;coherent.View.__updateTagSpecTable(a);b.__structure__!==c.__structure__&&Object.applyDefaults(b.__structure__,c.__structure__)};
coherent.View.viewClassForNode=function(a,b){var c=a.getAttribute("view"),d=a.getAttribute("__parametersId"),e;if(d)return coherent.View.nodeParameters[d].viewClass;if(c){e=coherent.View.registry[c];if(!e)throw new InvalidArgumentError("Invalid view type: "+c);return e}var c=[],d=a.className.split(" "),f,g=coherent.View.registry;for(f=0;f<d.length;++f)d[f]in g&&(c[c.length]=g[d[f]]);c=c||0;if(1==c.length)return c[0];if(1<c.length)throw new InvalidArgumentError("CSS class matches multiple view types: "+
a.className);c=coherent.View.tagToViewLookup[a.tagName];if(!c)return null;var h;f=c.attr||{};for(var i in f){g=f[i];d=a.getAttribute(i);if(d in g){e=g[d];break}d=a[i];d in g&&(h=g[d])}e=e||h||c.viewClass;if(!e)return null;if(h=!b)if(h=e.prototype.requireBindingsForInferredViewType){a:{h=e.prototype.exposedBindings||[];i=h.length;for(d=0;d<i;++d)if(c=h[d]+"Binding",a.getAttribute(c)){h=!0;break a}h=!1}h=!h}return h?null:e};
coherent.View.createViewForNode=function(a,b,c){var d=coherent.View.fromNode(a);return d?d:new (coherent.View.viewClassForNode(a,c)||coherent.View)(a,b,c)};coherent.View.fromNode=function(a){var b=coherent.View.viewLookup;return!b||!b[a.id]?null:b[a.id]};
coherent.View.rebindNodeTreeWithRelativeSource=function(a,b,c){var d=coherent.ListView;Element.depthFirstTraversal(a,function(a){a=coherent.View.fromNode(a);if(!a||b&&a.__relativeSource!==b)return!0;a.__relativeSource=c;a.setupBindings();a.updateBindings();if(a instanceof d)return!1})};coherent.View.unbindNodeTree=function(a){Element.depthFirstTraversal(a,function(a){(a=coherent.View.fromNode(a))&&a.unbind()})};
coherent.View.createViewsForNodeTree=function(a,b,c){var d=coherent.dataModel;c&&(coherent.dataModel=c);Element.depthFirstTraversal(a||document.body,function(a){if(!coherent.View.fromNode(a)){var c=coherent.View.viewClassForNode(a);c&&new c(a,b)}});c&&(coherent.dataModel=d)};coherent.View.teardownViewsForNodeTree=function(a){Element.depthFirstTraversal(a||document.body,function(a){(a=coherent.View.fromNode(a))&&a.teardown()})};coherent.View.__updateTagSpecTable(coherent.View);
coherent.Anchor=Class.create(coherent.View,{__viewClassName__:"Anchor",__tagSpec__:"a",exposedBindings:["href"],init:function(){this.base();var a=this.viewElement(),b=this.bindings;b.href&&(!b.href.hasValue()&&a.href)&&b.href.setValue(a.href)},observeHrefChange:function(a){this.viewElement().href=a.newValue}});
coherent.ListView=Class.create(coherent.View,{__viewClassName__:"List",__tagSpec__:["table","ul"],exposedBindings:["content","selectionIndexes","selectedIndex","selectedObject"],_items:null,_activeItem:-1,init:function(){this.base();this.objectCache={};var a=this.viewElement(),b;switch(a.tagName){case "SELECT":this._isSelectElement=!0;this._items=PartList("option");this.templateElement=document.createElement("option");Event.observe(a,"change",this.selectedIndexChanged.bindAsEventListener(this));break;
case "TABLE":b=this.setContainer(a.tBodies[0]);this._items=PartList("> tbody tr");this.templateElement=Element.clone(this._items(0));break;default:b=this.container();for(a=a.firstChild;a&&1!==a.nodeType;)a=a.nextSibling;if(!a)return;this._items=PartList("> "+a.nodeName);this.templateElement=Element.clone(a)}this._items();if("true"===(this.attributeOrProperty("multiple")||"").toLowerCase())this.multiple=!0;this.templateElement.id="";this.template&&"function"!==typeof this.template&&delete this.template;
this.template&&!this.template.valueOf().__factoryFn__&&(this.template=this.template());if(!this.template&&!1!==this.initFromDOM)this._initFromDOM();else if(b)for(;b.firstChild;)b.removeChild(b.firstChild)},computeSelectionIndexes:function(){var a=[];this._items().forEach(function(b,c){b.selected&&a.push(c)});return a},_initFromDOM:function(){this.container();this.viewElement();var a=this.bindings,b=[],c=[],d=[],e=this._items(),f=e.length,g;if(f&&(!a.content||!a.content.hasValue())){for(var h=this.objectClass||
coherent.KVO,i=coherent.Style.kSelectedClass,j=Element.hasClassName,l=0;l<f;++l){g=e[l];var k=d[l]=new h;if(g.selected||j(g,i))b.push(l),c.push(k);this.setupElement(g,k)}this.__selectionIndexes=b;this.selectedIndex=b.length?b[0]:-1;this.__content=d;a.content&&a.content.setValue(d);a.selectionIndexes&&a.selectionIndexes.setValue(b);a.selectedObject&&a.selectedObject.setValue(c[0]);a.selectedIndex&&a.selectedIndex.setValue(this.selectedIndex)}},acceptsFirstResponder:function(){var a=this.viewElement();
return a.disabled||a.readOnly?!1:!0},highlightSelectionIndexes:function(a){var b=this.viewElement(),c=this._items(),d=c.length,e,f=0,g=!!this._isSelectElement,h,i=coherent.Style.kSelectedClass,j,l;if(this.animated){var k={curve:coherent.easing.inOutSine,duration:300};j=function(a,b){coherent.Animator.addClassName(a,b,k)};l=function(a,b){coherent.Animator.removeClassName(a,b,k)}}else j=Element.addClassName,l=Element.removeClassName;for(e=0;e<d;++e){0===e?Element.addClassName(c[e],coherent.Style.kFirstClass):
Element.removeClassName(c[e],coherent.Style.kFirstClass);1<d&&e===d-1?Element.addClassName(c[e],coherent.Style.kLastClass):Element.removeClassName(c[e],coherent.Style.kLastClass);h=e==a[f];try{c[e].selected=h}catch(n){c[e].setAttribute("selected",h)}h&&f++;g||(h?j(c[e],i):l(c[e],i))}1===a.length&&(this.selectedIndex=b.selectedIndex=a[0]);this.__selectionIndexes=a},selectionIndexes:function(){return this.__selectionIndexes},setSelectionIndexes:function(a){var b,c=this.viewElement(),d=this.bindings,
a=(a||[]).concat().sort();String(a)===String(this.__selectionIndexes)&&(a=this.__selectionIndexes);b=1===a.length?this.selectedIndex=c.selectedIndex=a[0]:a.length?c.selectedIndex=a[0]:c.selectedIndex=-1;d.selectionIndexes&&d.selectionIndexes.setValue(a);d.selectedIndex&&d.selectedIndex.setValue(b);if(d.selectedObject&&d.content){var e=null;-1!==b&&(e=(this.__content||[])[b]);d.selectedObject.setValue(e)}d.selectedValue&&(e=null,-1!==b&&(e=c.options[b].value),d.selectedValue.setValue(e));this.__selectionIndexes=
a;this.highlightSelectionIndexes(a)},selectedObjects:function(){return(this.__content||[]).objectsAtIndexes(this.selectionIndexes()||[])},onkeydown:function(a){var b=this.viewElement();if(!b.disabled&&!(Event.KEY_UP!=a.keyCode&&Event.KEY_DOWN!=a.keyCode)){Event.stop(a);var c=this.selectionIndexes(),d=(this.__content||[]).length-1,e;if(this.multiple&&a.shiftKey&&c.length){var f=this.selectedIndex==c[0],g=c[0],h=c[c.length-1];if(1==c.length){e=Event.KEY_UP==a.keyCode?g-1:g+1;if(0>e||e>d)return;c.push(e)}else f?
Event.KEY_UP==a.keyCode?c.length--:h<d&&c.push(e=h+1):this.KEY_DOWN==a.keyCode?c.splice(0,1):0<g&&c.push(e=g-1)}else c.length?Event.KEY_UP==a.keyCode&&0<this.selectedIndex?this.selectedIndex--:Event.KEY_DOWN==a.keyCode&&this.selectedIndex<d&&this.selectedIndex++:Event.KEY_UP==a.keyCode?this.selectedIndex=d:Event.KEY_DOWN==a.keyCode&&(this.selectedIndex=0),c=[e=this.selectedIndex];isNaN(e)||(a=this._items(e),d=Element.scrollParent(b),b=d.offsetHeight,d=a.offsetTop-d.scrollTop,e=a.offsetHeight,f=this.container(),
a.offsetParent!==f&&(d-=f.offsetTop),0>d?a.scrollIntoView(!0):d+e>b&&a.scrollIntoView(!1));this.setSelectionIndexes(c)}},selectedIndexChanged:function(){if(this.bindings.selectionIndexes||this.bindings.selectedIndex||this.bindings.selectedObject||this.bindings.selectedValue){var a=this.viewElement(),a=this.multiple?this.computeSelectionIndexes():[this.selectedIndex=a.selectedIndex];this.setSelectionIndexes(a)}},_clearSelection:function(){var a=this.viewElement(),b="SELECT"!==a.tagName,c=Element.removeClassName,
d=coherent.Style.kSelectedClass;this._items().forEach(function(a){a.selected=!1;b&&c(a,d)});a.selectedIndex=-1},observeSelectedIndexChange:function(a){a=a.newValue;this.setSelectionIndexes(-1!==a&&null!==a&&"undefined"!==typeof a?[a]:[])},observeSelectedObjectChange:function(a){a=(this.__content||[]).indexOf(a.newValue);this.setSelectionIndexes(-1===a?[]:[a])},observeSelectionIndexesChange:function(a){this.setSelectionIndexes(a.newValue||[])},_updateDomWithContent:function(a){this._items.refresh();
for(var b=coherent.View.rebindNodeTreeWithRelativeSource,c=coherent.View.unbindNodeTree,d=this.selectedObjects(),e=[],f=a.length,g=this._items(),h=g.length,i=Math.min(h,f),j=0,l,k,n,m;j<i;){l=a[j];-1!==d.indexOf(l)&&e.push(j);k=g[j];m=Element.assignId(k);n=this.objectCache[m];this.objectCache[m]=l;"undefined"===typeof n?this.setupElement(k,l):b(k,n,l);l=coherent.View.fromNode(k);if(!l||!l.bindings.visible)k.style.display="";++j}if(j<f){b=this.container();for(c=document.createDocumentFragment();j<
f;)l=a[j],-1!==d.indexOf(l)&&e.push(j),k=this.createElement(l,null,c),this._items.add(k),++j;b.appendChild(c)}else for(;j<h;)k=g[j],m=Element.assignId(k),c(k),this.objectCache[m]=null,"SELECT"==this.viewElement().tagName?(k.parentNode.removeChild(k),this._items.removePart(k),--h):(k.style.display="none",++j);this.highlightSelectionIndexes(e)},observeContentChange:function(a){function b(a,b){var c=Element.assignId(c),d=g[c];g[c]=b;f(a,d,b);a.style.display=""}this.container();this.viewElement();var c,
d,e;d=[];var f=coherent.View.rebindNodeTreeWithRelativeSource,g=this.objectCache;switch(a.changeType){case coherent.ChangeType.setting:this.__content=a.newValue||[];this._updateDomWithContent(this.__content);break;case coherent.ChangeType.insertion:for(c=0;c<a.indexes.length;++c)(d=this._items(a.indexes[c]))&&"none"===d.style.display?(e=d,b(d,a.newValue[c])):(e=this.createElement(a.newValue[c],d),this._items.insertPartAtIndex(e,a.indexes[c])),this.animated&&(Element.addClassName(e,coherent.Style.kInsertedClass),
coherent.Animator.removeClassName(e,coherent.Style.kInsertedClass,{discreteTransitionPoint:1,duration:this.updateAnimationDuration}));break;case coherent.ChangeType.replacement:d=function(a,c){b(a,c);coherent.Animator.removeClassName(a,coherent.Style.kReplacingClass,{duration:250,discreteTransitionPoint:1})};for(c=0;c<a.indexes.length;++c)e=this._items(a.indexes[c]),this.animated?coherent.Animator.addClassName(e,coherent.Style.kReplacingClass,{duration:this.updateAnimationDuration,discreteTransitionPoint:0,
callback:d.bind(this,a.newValue[c])}):b(e,a.newValue[c]);break;case coherent.ChangeType.deletion:d=this.selectionIndexes();for(c=a.indexes.length-1;0<=c;--c){var h=a.indexes[c];d.removeObject(h);e=this._items(h);this._items.removePartAtIndex(h);this.animated?coherent.Animator.addClassName(e,coherent.Style.kDeletedClass,{duration:this.updateAnimationDuration,discreteTransitionPoint:0,callback:this.removeChild.bind(this)}):this.removeChild(e)}this.setSelectionIndexes(d);break;default:console.log("Unknown change type: "+
a.changeType)}this.bindings.displayValues&&this.bindings.displayValues.update();this.bindings.contentValues&&this.bindings.contentValues.update()},setupElement:function(a,b){coherent.Browser.MobileSafari&&!a.__setup&&(a.__setup=!0,a.addEventListener("click",function(){},!1));if(this.template){var c=coherent.dataModel;coherent.dataModel=this.__context;this.template.call(this,a,b);coherent.dataModel=c}else coherent.View.createViewsForNodeTree(a,b,this.__context);c=Element.assignId(a);this.objectCache[c]=
b;return a},createElement:function(a,b,c){this.viewElement();var c=c||this.container(),d=Element.clone(this.templateElement),b=c.insertBefore(d,b||null);return this.setupElement(b,a)},onmousedown:function(a){var b=this.viewElement();if(!b.disabled)if("SELECT"===b.tagName)this.base(a);else{var a=a.target||a.srcElement,c=this.container(),d=this._items();if(!(a==c||a==b)){for(;a&&a.parentNode!=c;)a=a.parentNode;a==c||a==b||(this._activeItem=d.indexOf(a),Element.addClassName(a,coherent.Style.kActiveClass))}}},
onmouseup:function(){this.viewElement().disabled||(-1!==this._activeItem&&Element.removeClassName(this._items(this._activeItem),coherent.Style.kActiveClass),this._activeItem=-1)},ontouchmove:function(a){this.viewElement().disabled||(-1!==this._activeItem&&Element.removeClassName(this._items(this._activeItem),coherent.Style.kActiveClass),this._activeItem=-1,this.base(a))},onclick:function(a){var b=this.viewElement();if(b.disabled)this.base(a),Event.stop(a);else if("SELECT"===b.tagName)this.base(a);
else{var b=a.target||a.srcElement,c=-1,d=this.container(),e=this._items();if(b!=d){for(;b&&b.parentNode!=d;)b=b.parentNode;b&&(c=e.indexOf(b),Element.assignId(b));this.multiple?(d=this.selectionIndexes(),a.shiftKey?this.setSelectionIndexes(IndexRange(this.selectedIndex,c)):a.ctrlKey||a.metaKey?(a=d.indexOf(c),-1===a?(this.selectedIndex=c,d.push(c)):d.splice(a,1),this.setSelectionIndexes(d)):(this.selectedIndex=c,this.setSelectionIndexes([c]))):(this.selectedIndex=c,this.setSelectionIndexes([c]));
b&&"A"==b.tagName&&b.blur();this.sendAction()}}}});
coherent.Overlay=Class.create(coherent.View,{content:Part(".content"),container:Part(".container"),__structure__:{".close":coherent.Anchor({action:"close",visibleBinding:"canClose"}),".spinner":coherent.View({visibleBinding:"loading"}),".buttons":coherent.ListView({visibleBinding:"recoveryOptions",contentBinding:"recoveryOptions",action:"recoveryButtonClicked",acceptsFirstResponder:function(){return!1},template:coherent.View({__structure__:{button:coherent.View({textBinding:"*.text"})}})})},minWidth:200,
minHeight:200,contentScreen:null,spinnerDelay:500,spinnerClassName:"overlay-waiting",timeout:5E3,focusableSelectors:"input, select, textarea, button, a[href]",tabStart:Part("#tab-start"),tabStop:Part("#tab-stop"),closeBtn:Part(".close"),innerHTML:'<span class="chrome tl"></span><span class="chrome tr"></span><span class="chrome top"></span><span class="chrome left"></span><span class="chrome right"></span><span class="chrome bottom"></span><span class="chrome bl"></span><span class="chrome br"></span><a href="#" class="close">close</a><a href="#" id="tab-start" tabindex="1"></a><span class="chrome center"></span><div class="spinner"></div><div class="container"><div class="content"></div><a href="#" id="tab-stop"></a><ul class="buttons"><li><button></button></li></ul></div>',
errorInnerHTML:'<div class="blue-header-popup">        <div class="header">            <h2>Server did not respond</h2>        </div>        <div class="content clearfix">            <p><strong>Your request to the server got no response. Either the request took too long, or the server may be down temporarily. Please try again.</strong></p>            <div class="error-actions">                <a href="#" class="cancel continue"><span class="replaced">Continue</span></a>            </div>        </div>        <div class="footer empty-footer">            <p>&nbsp;</p>        </div>    </div>',
keyDependencies:{canClose:["loading","displayCloseWidget"]},init:function(){this.__cache={};this.__urlCache={};var a=this.viewElement();Element.setStyle(a,"display","none");this.setValueForKey(!1,"visible");this.__curFocusIndex=0;this.__focusableElements=this.__curFocusElement=null},__resetFocusableElements:function(){this.__focusableElements=Element.queryAll(this.viewElement(),this.focusableSelectors).sort(function(a,b){var c=0,d=a.tabIndex,e=b.tabIndex;a==this.tabStop()?c=1:b==this.tabStop()?c=
-1:a==this.closeBtn()?c=1:b==this.closeBtn()?c=-1:0<d&&0<e?c=d-e:0<d?c=-1:0<e?c=1:0>d&&0>e?c=0:0>d?c=1:0>e&&(c=-1);return c}.bind(this)).filter(function(a){return"hidden"!==a.type&&0<=a.tabIndex})},__getNextFocusableIndex:function(a){var b=this.__focusableElements.length,c=0;3==b?c=1:3<b&&(c=this.__getNextTabbableIndex(this.__curFocusIndex,a));return c},__getNextTabbableIndex:function(a,b){var c=a,d=this.__focusableElements,e=d.length-1,f;do{c=b?0===c?e:c-1:c==e?0:c+1;f=d[c];try{return f.focus(),
c}catch(g){}}while(c!=a);return c},__setFocus:function(a,b){var c=this.__focusableElements[a];!b&&(c&&c.focus)&&c.focus();this.__curFocusElement=c;this.__curFocusIndex=a},enableTabHandler:function(){this.__resetFocusableElements();this.__setFocus(this.__curFocusIndex);this.__keyboardObserver=this.__keyboardHandler.bindAsEventListener(this);Event.observe(document,"keydown",this.__keyboardObserver)},disableTabHandler:function(){Event.stopObserving(document,"keydown",this.__keyboardObserver)},__keyboardHandler:function(a){switch(a.keyCode||
a.which){case Event.KEY_TAB:Event.stop(a);this.__setFocus(this.__getNextFocusableIndex(a.shiftKey));(a.target||a.srcElement)==this.tabStop()&&this.__resetFocusableElements();break;case Event.KEY_ESC:this.valueForKey("canClose")&&(this.hide(),Event.stop(a))}},__updateTabStateAfterClick:function(a){if((a=a.target||a.srcElement)&&Element.match(a,this.focusableSelectors)&&this.__inOverlay(a)){var b=function(a){return this.__focusableElements.indexOf(a)}.bind(this);0>b(a)&&this.__resetFocusableElements();
this.__setFocus(b(a),!0)}},__inOverlay:function(a){var b=this.viewElement();return!!Element.locateAncestor(a,function(a){return a==b},b.parentNode)},canClose:function(){return!this.loading&&this.displayCloseWidget},onclick:function(a){var b=this.viewElement();(b=Element.locateAncestor(a.target||a.srcElement,function(a){return Element.hasClassName(a,"cancel")},b))?(this.hide(),Event.stop(a)):this.__updateTabStateAfterClick(a);if(b=this.nextResponder())b.onclick(a)},display:function(a){a=Object.applyDefaults(a||
{},{timeout:this.timeout,spinnerDelay:this.spinnerDelay,obscurePage:!0,displayCloseWidget:!0,nextResponder:null,grow:!1,dimensions:{width:this.minWidth,height:this.minHeight}});if(!a.url&&!a.sourceId&&!a.html&&!a.text&&!a.error)throw Error("No source specified for the overlay.");this.setValueForKey(a.displayCloseWidget,"displayCloseWidget");a.nextResponder&&this.setNextResponder(a.nextResponder);if(!this.contentScreen){var b=function(a){this.close();Event.stop(a)};6===coherent.Browser.IE?(this.contentScreen=
document.createElement("IFRAME"),this.contentScreen.scrolling="no",this.contentScreen.frameBorder="0",this.contentScreen.src="about:blank"):(this.contentScreen=document.createElement("DIV"),this.displayCloseWidget&&Event.observe(this.contentScreen,"click",b.bindAsEventListener(this)));this.contentScreen.className="overlayScreen";Element.assignId(this.contentScreen);document.body.appendChild(this.contentScreen)}b=this.viewElement();b.parentNode!==document.body&&document.body.appendChild(b);this.__request&&
this.__request.abort();this.__clearTimers();a.grow&&this.__show(a);a.url?this.__loadContent(a):this.__showContent(a)},__clearTimers:function(){var a=[this.__loadingTimer,this.__waitingTimer],b;for(b=0;b<a.length;b++)a[b]&&(window.clearTimeout(a[b]),a[b]=0)},__prepareToShow:function(a){var b=document.getElementById(this.__spinnerDelayNodeId);b&&Element.setStyle(b,"display","none");a.obscurePage=!1;this.setValueForKey(!1,"loading");this.__showContent(a)},__loadContent:function(a){function b(){console.log("Failed to display overlay: timeout exceeded");
this.__clearTimers();a.html=this.errorInnerHTML;this.__prepareToShow(a)}function c(b){console.log("Failed to display overlay: "+b.message);this.__clearTimers();a.html=this.errorInnerHTML;this.__prepareToShow(a)}function d(){var a=document.getElementById(this.__spinnerDelayNodeId),b=Element.setStyle;this.__spinnerDelayNodeId||(a=document.body.appendChild(document.createElement("DIV")),b(a,"display","none"),a.className=this.spinnerClassName,this.__spinnerDelayNodeId=Element.assignId(a));b(a,"display",
"")}function e(b){var c=document.createElement("div"),b=coherent.Scripts.extract(b);a.scripts=b.scripts;a.html=b.toString();a.sourceId=Element.assignId(c);Element.setInnerHTML(c,a.html);this.__urlCache[a.url]=a.sourceId;this.__cache[c.id]=c;this.__clearTimers();this.__prepareToShow(a)}var f=this.__urlCache[a.url];f?(a.sourceId=f,this.__clearTimers(),this.__showContent(a)):(a.obscurePage&&this.__obscurePage(),f=XHR.get(a.url),f.addMethods(e.bind(this),c.bind(this)),this.setValueForKey(!0,"loading"),
this.__loadingTimer=b.bindAndDelay(this,a.timeout),this.__waitingTimer=d.bindAndDelay(this,a.spinnerDelay))},__obscurePage:function(){var a=this.contentScreen;this.__didObscurePage||(this.__didObscurePage=!0,Element.setStyle(a,"display","block"),(6===coherent.Browser.IE||coherent.Browser.MobileSafari)&&Element.setStyles(a,{position:"absolute",top:"0px",left:"0px",width:document.body.offsetWidth+"px",height:document.body.offsetHeight+"px"}),coherent.Animator.setStyles(a,{opacity:0.85},{duration:175}))},
__unobscurePage:function(){var a=this.contentScreen;this.__didObscurePage&&(this.__didObscurePage=!1,coherent.Animator.setStyles(a,{opacity:0},{duration:250,callback:function(){Element.setStyle(a,"display","none")}}))},__getNodeById:function(a){return this.__cache[a]=document.getElementById(a)||this.__cache[a]},__removeChildren:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},__suspendScrolling:function(){6===coherent.Browser.IE&&(Element.query("html").style.overflow="hidden")},__resumeScrolling:function(){6===
coherent.Browser.IE&&(Element.query("html").style.overflow="")},__showContent:function(a){var b=document.body,c=b.insertBefore(this.viewElement(),b.firstChild),b=this.content();this.container();"classname"in a&&(c.className=a.classname);Element.setStyles(c,{opacity:0,display:"",width:"",height:""});"sourceId"in a?(this.__removeChildren(b),c=this.__getNodeById(a.sourceId),c.parentNode&&c.parentNode.removeChild(c),b.appendChild(c)):"html"in a?(c=coherent.Scripts.extract(a.html),a.scripts=c.scripts,
b.innerHTML=c):"text"in a?(c=document.createTextNode(a.text),this.__removeChildren(b),b.appendChild(c)):"error"in a&&(c=document.createElement("span"),Element.setInnerHTML(c,a.error.description),this.__removeChildren(b),b.appendChild(c),this.setValueForKey(a.error,"error"),this.error.recoveryOptions&&this.error.recoveryAttempter?(c=this.error.recoveryOptions.map(function(a){var b=new coherent.KVO;b.text=a;return b}),this.setValueForKey(c,"recoveryOptions")):this.setValueForKey(null,"recoveryOptions"));
a.error||(this.setValueForKey(null,"error"),this.setValueForKey(null,"recoveryOptions"));this.beforeShow(b,a);this.setDisplayDimensions(this.getDisplayDimensions(b),a);this.__show(a)},beforeShow:function(){},getDisplayDimensions:function(a){return Element.getDimensions(a)},setDisplayDimensions:function(a,b){b.dimensions=a;b.dimensions.height=Math.max(this.minHeight,b.dimensions.height);b.dimensions.width=Math.max(this.minWidth,b.dimensions.width)},load:function(a){this.display({url:a})},__show:function(a){var b=
a.dimensions.width,c=a.dimensions.height;this.container();var d=this.viewElement(),e=Element.getViewport(),f=Element.setStyles,g=coherent.Animator.setStyles,e={display:"",position:"absolute",left:"50%",top:Math.max(c/2+15,Math.round(e.height/2+e.top))+"px"},h={opacity:1},i=this;(this.__grow=a.grow)?(e.width=this.minWidth+"px",e.height=this.minHeight+"px",e.marginLeft=-this.minWidth/2+"px",e.marginTop=-this.minHeight/2+"px",h.width=b+"px",h.height=c+"px",h.marginLeft=-b/2+"px",h.marginTop=-c/2+"px"):
(e.width=b+"px",e.height=c+"px",e.marginLeft=-b/2+"px",e.marginTop=-c/2+"px");a.obscurePage&&this.__obscurePage();f(d,e);coherent.Overlay.__currentOverlay=this;(function(){i.sendToDelegate("willShowOverlay");g(d,h,{duration:250,callback:function(){a.scripts&&coherent.Scripts.install(a.scripts);a.scripts=null;i.setValueForKey(!0,"visible");i.sendToDelegate("didShowOverlay");i.enableTabHandler()}})}).delay(100)},close:function(){return this.hide()},hide:function(a){var b=this.viewElement();this.container();
var c=this.content(),d=this,e=this.__removeChildren,f=Element.setStyle,g=coherent.Animator.setStyles,h={opacity:0};this.sendToDelegate("willHideOverlay");this.__grow&&(h.width=this.minWidth+"px",h.height=this.minHeight+"px",h.marginLeft=-this.minWidth/2+"px",h.marginTop=-this.minHeight/2+"px");this.__unobscurePage();g(b,h,{duration:250,callback:function(){b=document.body.appendChild(b);f(b,"display","none");d.sendToDelegate("didHideOverlay");a&&e(c)}});coherent.Overlay.__currentOverlay=null;this.setValueForKey(!1,
"visible");this.disableTabHandler()},recoveryButtonClicked:function(a){var a=a.selectedIndex,b=this.error,c=b.recoveryAttempter;-1!=a&&c&&c(b,a)}});coherent.Overlay.getCurrentOverlay=function(){return coherent.Overlay.__currentOverlay||null};
coherent.Bubble=Class.create(coherent.Overlay,{arrow:Part(".arrow"),innerHTML:'<span class="chrome tl"></span><span class="chrome tr"></span><span class="chrome top"></span><span class="chrome left"></span><span class="chrome right"></span><span class="chrome bottom"></span><span class="chrome bl"></span><span class="chrome br"></span><a href="#" class="close">close</a><span class="chrome center"></span><div class="spinner"></div><div class="container"><div class="content"></div><ul class="buttons"><li><button class="text-action"></button></li></ul></div><span class="chrome arrow"></span>',minWidth:50,
minHeight:20,maxWidth:800,maxHeight:500,init:function(){this.base();this.currentTarget=null},display:function(a){var a=Object.applyDefaults(a,{grow:!1}),b=Element.assignId(a.target);this.currentTarget!=b&&(this.currentTarget?this.base(a):(this.__timer&&window.clearTimeout(this.__timer),this.currentTarget=b,this.__timer=this.base.bindAndDelay(this,150,a)))},hide:function(a){a&&this.currentTarget!==a.target.id||(this.__timer&&window.clearTimeout(this.__timer),this.__timer=this.__hide.bindAndDelay(this))},
onmousedown:function(){this.__timer&&window.clearTimeout(this.__timer)},onmouseup:function(){this.hide()},__show:function(a){this.__timer&&window.clearTimeout(this.__timer);this.__timer=null;this.currentTarget=Element.assignId(a.target);var b=this.viewElement(),c=this.arrow(),d=this.content(),e=this.container();Element.setStyle(e,"opacity",1);e.style.position="";Element.setStyle(b,"opacity",0);b.style.display="";var e=Element.getRect(a.target),f=e.left+e.width/2,g=Element.getViewport(),h;if(a.within)h=
Element.getRect(a.within);else if(a.dimensions){h=parseInt(e.left,10)+Math.floor(e.width/2);var i=Math.floor(a.dimensions.width/2);h={left:h-i,right:h+i,width:a.dimensions.width}}else h=Element.getRect(document.body);b.style.width="";d=Element.getRect(d);d.width<=h.width?(d=f+d.width/2<h.right?{width:d.width+"px",left:Math.max(h.left,f-d.width/2)+"px",right:""}:{width:d.width+"px",left:h.right-d.width+"px",right:""},f=f-parseInt(d.left,10)+"px"):(d={width:h.width+"px",left:h.left+"px",right:""},f=
f-h.left+"px");Element.setStyles(b,d);Element.setStyle(c,"left",f);Element.removeClassName(b,"below");f=c.offsetHeight;d=f+parseInt(Element.getStyle(c,"marginBottom")||0,10);d=parseInt(e.top,10)-b.offsetHeight-d;if(d<g.top||"below"==a.position)Element.addClassName(b,"below"),d=f+parseInt(Element.getStyle(c,"marginTop")||0,10),d=parseInt(e.bottom,10)+d;b.style.top=d+"px";coherent.Animator.setStyles(b,{opacity:1},{duration:100})},__hide:function(){this.__timer&&window.clearTimeout(this.__timer);this.currentTarget=
this.__timer=null;var a=this.viewElement();coherent.Animator.setStyles(a,{opacity:0},{duration:100,callback:function(){a.style.display="none"}})}});coherent.Bubble.display=function(a){var b=document.getElementById("coherent_bubble_node");b?b=coherent.View.fromNode(b):(b=document.createElement("div"),b.id="coherent_bubble_node",document.body.appendChild(b),b=new coherent.Bubble(b));b.display(a)};coherent.Bubble.hide=function(a){var b=document.getElementById("coherent_bubble_node");b&&coherent.View.fromNode(b).hide(a)};
coherent.FieldGroup=Class.create(coherent.View,{validateFields:function(){for(var a=this.viewElement(),a=Element.queryAll(a,"input, textarea"),b=a.length,c,d,e=!0,f=0;f<b;++f)if((c=coherent.View.fromNode(a[f]))&&"validate"in c)c=c.validate(),c instanceof coherent.Error&&(e=!1,d=d||a[f]);d&&d.focus();return e}});
coherent.Fieldset=Class.create(coherent.FieldGroup,{bubbleClass:"bubble",init:function(){this.__currentViewId=!1;this.__fieldErrors={};coherent.page.addObserverForKeyPath(this,"observeFirstResponderChange","firstResponder")},presentError:function(a){var b=a.field;b&&(this.__fieldErrors[b.id]=a)},clearAllErrors:function(a){delete this.__fieldErrors[a.id];this.__currentViewId==a.id&&(this.__currentViewId=!1,coherent.Bubble.hide({target:document.getElementById(a.id)}))},observeFirstResponderChange:function(a){this.showErrorMessageForField(a.newValue)},
showErrorMessageForField:function(a){var b=!!a&&this.__fieldErrors[a.id];!b||!a.isDescendantOf(this)?(this.__currentViewId&&coherent.Bubble.hide({target:document.getElementById(this.__currentViewId)}),this.__currentViewId=!1):(this.__currentViewId=a.id,coherent.Bubble.display({classname:this.bubbleClass,error:b,position:b.position,target:a.viewElement(),within:this.viewElement(),nextResponder:a}))}});
coherent.Binding=Class.create({constructor:function(a,b,c){0!==arguments.length&&(this.object=a,this.keyPath=b,this.transformer=c,this.refresh())},bind:function(){this.object.addObserverForKeyPath(this,this.observeChangeForKeyPath,this.keyPath)},unbind:function(){this.object.removeObserverForKeyPath(this,this.keyPath)},refresh:function(){this.cachedOriginalValue=this.object.valueForKeyPath(this.keyPath);this.cachedValue=this.transformedValue(this.cachedOriginalValue)},transformedValue:function(a){return!this.transformer?
a:this.transformer.transformedValue(a)},validateProposedValue:function(a){if(this.transformer){if(!this.transformer.reverseTransformedValue)throw Error("Can't validate a value when the transformer doesn't have a reverseTransformedValue method");a=this.transformer.reverseTransformedValue(a)}a=this.object.validateValueForKeyPath(a,this.keyPath);return a instanceof coherent.Error?a:this.transformedValue(a)},setValue:function(a){if(this.cachedValue!==a){this.cachedValue=a;if(this.transformer){if(!this.transformer.reverseTransformedValue)return;
a=this.transformer.reverseTransformedValue(a)}this.cachedOriginalValue=a;var b=this.updating;this.updating=!0;this.object.setValueForKeyPath(a,this.keyPath);this.updating=b}},mutable:function(){if(this.transformer&&!this.transformer.reverseTransformedValue)return!1;var a=this.object.infoForKeyPath(this.keyPath);return a&&a.mutable},value:function(){return this.cachedValue},hasValue:function(){var a=this.value();return!(null===a||"undefined"===typeof a)},update:function(){var a=this.value(),a=new coherent.ChangeNotification(this.object,
coherent.ChangeType.setting,a);this.updating=!0;this.observerFn(a,this.keyPath);this.updating=!1},observerFn:function(){},observeChangeForKeyPath:function(a,b,c){if(!(this.updating&&a.newValue===this.cachedOriginalValue)){this.cachedOriginalValue=a.newValue;this.cachedOldValue=a.oldValue;var d=this.transformedValue(a.newValue),e=Object.clone(a);e.newValue=d;e.oldValue=null;coherent.ChangeType.setting===a.changeType&&(this.cachedValue=d);a=this.updating;this.updating=!0;this.observerFn(e,b,c);this.updating=
a}}});coherent.Binding.bindingRegex=/^(.*?)(?:\((.*)\))?$/;coherent.Binding.compoundRegex=/^\s*([^&|].*?)\s*(\&\&|\|\|)\s*(\S.+)\s*$/;
coherent.Binding.bindingFromString=function(a,b){var c;if((c=a.match(coherent.Binding.compoundRegex))&&4==c.length)return c=new coherent.CompoundBinding(c[2],coherent.Binding.bindingFromString(c[1],b),coherent.Binding.bindingFromString(c[3],b)),c.bind(),c;c=a.match(coherent.Binding.bindingRegex);if(!c||3>c.length)throw new InvalidArgumentError("bindingString isn't in correct format");var d=c[1],e;c[2]&&(e=coherent.findTransformerWithName(c[2]));c="$"==d.charAt(0)?new coherent.VariableBinding(b||coherent.dataModel,
d,e):new coherent.Binding(b||coherent.dataModel,d,e);c.bind();return c};coherent.VariableKeyPath=Class.create({constructor:function(a,b){this.keyPath=a;this.kvo=b},origKeyPath:function(){return this.keyPath},resolve:function(){return coherent.VariableKeyPath.resolve(this.keyPath,this.kvo)},variablePaths:function(){return coherent.VariableKeyPath.variableKeys(this.keyPath)}});
coherent.VariableKeyPath.resolve=function(a,b){if("$"!==a.charAt(0))throw new InvalidArgumentError("variable keypath isn't in correct format");for(var c=a.substr(1).split("$"),d="",e={},f=0;f<c.length;f++){var g=c[f];if(e[g])d+=e[g];else if(0<g.length){if("."!==g.charAt(0)&&"."!==g.charAt(g.length-1)&&(g=b.valueForKeyPath(g),"undefined"===typeof g||null===g))return;d+=g}}return d};
coherent.VariableKeyPath.variableKeys=function(a){var b=[],c={};a.substr(1).split("$").forEach(function(a){0<a.length&&("."!==a.charAt(0)&&"."!==a.charAt(a.length-1))&&!c[a]&&(c[a]=!0,b.push(a))});return b};
coherent.VariableBinding=Class.create(coherent.Binding,{constructor:function(a,b,c){this.variableKeyPath=new coherent.VariableKeyPath(b,a);this.cachedVariablesMap={};this.base(a,b,c);this.observers={}},addObserver:function(a,b,c){b=new coherent.ObserverEntry(a,b,c);b.vbuid=coherent.VariableBinding.observerId++;a.vbuid=b.vbuid;this.observers[b.vbuid]=b},removeObserver:function(a){delete this.observers[a.vbuid]},getObservers:function(){return this.observers},valueForResolvedKeyPath:function(a){return null===
a||"undefined"===typeof a||-1!=a.indexOf("undefined")?void 0:this.object.valueForKeyPath(a)},bind:function(){this.bindVariablePaths();this.bindResolvedPath()},bindVariablePaths:function(){for(var a in this.cachedVariablesMap)this.object.addObserverForKeyPath(this,this.observeChangeForVariablePath,a)},bindResolvedPath:function(){this.object.addObserverForKeyPath(this,this.observeChangeForResolvedPath,this.cachedResolvedKey)},unbind:function(){this.unbindVariablePaths();this.unbindResolvedPath()},unbindVariablePaths:function(){for(var a in this.cachedVariablesMap)this.object.removeObserverForKeyPath(this,
a)},unbindResolvedPath:function(){this.object.removeObserverForKeyPath(this,this.cachedResolvedKey)},refresh:function(){this.refreshCacheForVariablePaths();this.refreshCacheForResolvedPath()},refreshCacheForVariablePaths:function(){this.variableKeyPath.variablePaths().forEach(function(a){this.cachedVariablesMap[a]=this.object.valueForKeyPath(a)},this)},refreshCacheForResolvedPath:function(){var a=this.resolvedKeyPathFromCache(),b=this.valueForResolvedKeyPath(a);this.cachedValue=this.cachedOriginalValue=
b;this.cachedResolvedKey=a},resolvedKeyPathFromCache:function(){var a=this.cachedVariablesMap,b="";this.variableKeyPath.origKeyPath().substr(1).split("$").forEach(function(c){0<c.length&&(b="."!==c.charAt(0)&&"."!==c.charAt(c.length-1)?b+a[c]:b+c)});return b},observeChangeForVariablePath:function(a,b,c){this.unbindResolvedPath();this.cachedVariablesMap[b]=a.newValue;var d=this.resolvedKeyPathFromCache(),b=this.valueForResolvedKeyPath(d);this.cachedResolvedKey=d;a=Object.clone(a);a.newValue=b;a.oldValue=
this.cachedOriginalValue;this.observeChangeForResolvedPath(a,"",c);this.bindResolvedPath()},observeChangeForResolvedPath:function(a,b,c){this.observeChangeForKeyPath(a,this.variableKeyPath.origKeyPath(),c)}});coherent.VariableBinding.observerId=1;
coherent.CompoundBinding=Class.create(coherent.Binding,{constructor:function(a,b,c){this.base();if(!a||!b||!c)throw new InvalidArgumentError("No parameters to CompoundBinding initialiser are optional");this.operation=a;this.left=b;this.right=c;this.left.observerFn=this.right.observerFn=this.observeChange.bind(this);switch(this.operation){case coherent.CompoundBinding.AND:this.cachedValue=this.left.value()&&this.right.value();break;case coherent.CompoundBinding.OR:this.cachedValue=this.left.value()||
this.right.value();break;default:throw new InvalidArgumentError("Unknown operation value for CompoundBinding");}},bind:function(){this.left.bind();this.right.bind()},unbind:function(){this.left.unbind();this.right.unbind()},mutable:function(){return!1},setValue:function(){throw Error("Attempting to set value of CompoundBinding");},observeChange:function(){var a=this.cachedValue;switch(this.operation){case coherent.CompoundBinding.AND:this.cachedValue=this.left.value()&&this.right.value();break;case coherent.CompoundBinding.OR:this.cachedValue=
this.left.value()||this.right.value();break;default:throw Error("Unknown operation value for CompoundBinding");}a!==this.cachedValue&&this.update()}});coherent.CompoundBinding.AND="&&";coherent.CompoundBinding.OR="||";
Class.extend(Array,{containsObject:function(a){return-1!==this.indexOf(a)},valueForKey:function(a){if(!a||0===a.length)throw new InvalidArgumentError("the key is empty");if("@count"==a)return this.length;var b=Array(this.length),c,d=this.length;for(c=0;c<d;++c)b[c]=this[c].valueForKey(a);return b},setValueForKey:function(a,b){if(!b||0===b.length)throw new InvalidArgumentError("key is empty");var c,d=this.length;for(c=0;c<d;++c)this[c].setValueForKey(a,b)},indexesOfObjects:function(a){var b,c=a.length,
d=[],e;for(b=0;b<c;++b)e=this.indexOf(a[b]),-1!==e&&d.push(e);return d},addObject:function(a){var b=this.length,c=new coherent.ChangeNotification(this,coherent.ChangeType.insertion,[a],null,[b]);this.push(a);this.observeElementAtIndex(b);this.notifyObserversOfChangeForKeyPath(c,coherent.KVO.kAllPropertiesKey)},addObjects:function(a){var b,c=a.length;for(b=0;b<c;++b)this.addObject(a[b])},insertObjectAtIndex:function(a,b){if(0>b||b>=this.length)throw new RangeError("index must be within the bounds of the array");
var c=new coherent.ChangeNotification(this,coherent.ChangeType.insertion,[a],null,[b]);this.splice(b,0,a);this.observeElementAtIndex(b);this.notifyObserversOfChangeForKeyPath(c,coherent.KVO.kAllPropertiesKey)},insertObjectsAtIndexes:function(a,b){if(a.length!==b.length)throw new InvalidArgumentError("length of objects and indexes parameters must be equal");var c=a.length,d,e;for(d=0;d<c;++d)e=b[d],this.splice(e,0,a[d]),this.observeElementAtIndex(e);c=new coherent.ChangeNotification(this,coherent.ChangeType.insertion,
a,null,b);this.notifyObserversOfChangeForKeyPath(c,coherent.KVO.kAllPropertiesKey)},replaceObjectAtIndex:function(a,b){var c=this[b];this[b]=a;c=new coherent.ChangeNotification(this,coherent.ChangeType.replacement,[a],[c],[b]);this.notifyObserversOfChangeForKeyPath(c,coherent.KVO.kAllPropertiesKey)},replaceObjectsAtIndexes:function(a,b){var c=a.length,d,e;for(d=0;d<c;++d)e=b[d],this.stopObservingElementAtIndex(e),this[e]=a[d],this.observeElementAtIndex(e);c=new coherent.ChangeNotification(this,coherent.ChangeType.replacement,
a,null,b);this.notifyObserversOfChangeForKeyPath(c,coherent.KVO.kAllPropertiesKey)},removeObject:function(a){a=this.indexOf(a);-1!==a&&this.removeObjectAtIndex(a)},removeObjects:function(a){for(var b=a.length,c,d=0;d<b;++d)c=this.indexOf(a[d]),-1!==c&&this.removeObjectAtIndex(c)},removeObjectsAtIndexes:function(a){for(var b=a.length,c=0;c<b;++c)this.removeObjectAtIndex(a[c])},removeObjectAtIndex:function(a){if(0>a||a>=this.length)throw new RangeError("index must be within the bounds of the array");
this.stopObservingElementAtIndex(a);var b=this.splice(a,1),a=new coherent.ChangeNotification(this,coherent.ChangeType.deletion,null,b,[a]);this.notifyObserversOfChangeForKeyPath(a,coherent.KVO.kAllPropertiesKey)},removeAllObjects:function(){var a,b=[],c=this.length;b.length=c;for(a=0;a<c;++a)this.stopObservingElementAtIndex(a),b[a]=a;a=this.splice(0,c);b=new coherent.ChangeNotification(this,coherent.ChangeType.deletion,null,a,b);this.notifyObserversOfChangeForKeyPath(b,coherent.KVO.kAllPropertiesKey)},
objectsAtIndexes:function(a){var b,c=[],d=a.length;c.length=a.length;for(b=0;b<d;++b)c[b]=this[a[b]];return c},observeChildObjectChangeForKeyPath:function(a,b){var c=a.object,d=this.indexOf(c);this.__uid||this.initialiseKeyValueObserving();-1===d?c._removeParentLink(this,null,this.__uid):(c=new coherent.ChangeNotification(c,coherent.ChangeType.replacement,[a.newValue],[a.oldValue],[d]),this.notifyObserversOfChangeForKeyPath(c,b))},observeElementAtIndex:function(a){if((a=this[a])&&a._addParentLink)this.__uid||
this.initialiseKeyValueObserving(),a._addParentLink(this,null,this.__uid)},stopObservingElementAtIndex:function(a){if((a=this[a])&&a._removeParentLink)this.__uid||this.initialiseKeyValueObserving(),a._removeParentLink(this,null,this.__uid)},initialiseKeyValueObserving:function(){var a,b=this.length;this.__observers={};this.__uid=this.__uid||coherent.generateUid();for(a=0;a<b;++a)this.observeElementAtIndex(a)},toJSON:function(){return this}});coherent.KVO.adapt(Array.prototype);
coherent.ArrayOperator={avg:function(a){return this.sum(a)/a.length},count:function(){throw new InvalidArgumentError("@count operator must end the keyPath");},distinctUnionOfArrays:function(a){return this.unionOfArrays(a).distinct()},distinctUnionOfObjects:function(a){return a.distinct()},max:function(a){var b=null,c,d,e;c=0;for(d=a.length;c<d;++c)if(e=a[c],null===b||e>b)b=e;return b},min:function(a){var b=null,c,d,e;c=0;for(d=a.length;c<d;++c)if(e=a[c],null===b||e<b)b=e;return b},sum:function(a){var b=
0,c=a.length,d;for(d=0;d<c;++d)b+=a[d];return b},unionOfArrays:function(a){var b=[],c,d;d=0;for(c=a.length;d<c;++d)b=b.concat(a[d]);return b},unionOfObjects:function(a){return a}};
coherent.KVOTable=Class.create(coherent.KVO,{valueForKeyPath:function(a){"array"===coherent.typeOf(a)&&(a=a.join("."));return this.valueForKey(a)},setValueForKeyPath:function(a,b){"array"===coherent.typeOf(b)&&(b=b.join("."));return this.setValueForKey(a,b)},infoForKeyPath:function(a){"array"===coherent.typeOf(a)&&(a=a.join("."));return this.infoForKey(a)}});
coherent.Scripts={extract:function(a){var b=[],a=new String(a.replace(RegExp("(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)","img"),function(a,d){b.push(d);return""}));a.scripts=b;return a},install:function(a){function b(a){if(a&&a.length)if(window.execScript)window.execScript(a);else{var b=document.createElement("script"),a=document.createTextNode(a);b.appendChild(a);b.type="text/javascript";b.defer=!1;document.getElementsByTagName("head").item(0).appendChild(b)}}a&&("string"===typeof a?b(a):a.forEach(b))}};
Element.colours={black:"#000000",white:"#ffffff"};
coherent.Browser.IE&&(Element.setStyle=function(a,b,c){"opacity"!=b?a.style[b]=c:(b=a.style.filter,a=a.style,1==c||""===c?a.filter=b.replace(/alpha\([^\)]*\)/gi,""):(1E-5>c&&(c=0),a.filter=b.replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+100*c+")"))},Element.setStyles=function(a,b){var c=a.style,d;for(d in b)"opacity"==d?Element.setStyle(a,d,b[d]):c[d]=b[d]},Element.getStyles=function(a,b){function c(b){var c=0;if("width"===b)return c+=parseInt(d.borderLeftWidth,10)||0+parseInt(d.borderRightWidth,
10)||0+parseInt(d.paddingLeft,10)||0+parseInt(d.paddingRight,10)||0,Math.max(0,a.offsetWidth-c)+"px";c+=parseInt(d.borderTopWidth,10)||0+parseInt(d.borderBottomWidth,10)||0+parseInt(d.paddingTop,10)||0+parseInt(d.paddingBottom,10)||0;return Math.max(0,a.offsetHeight-c)+"px"}var d=a.currentStyle,e={},f;if("string"===typeof b)return"opacity"===b?(f=d.filter.match(/opacity=(\d+)/i),null===f?1:parseInt(f[1],10)/100):"height"==b||"width"==b?c(b):"backgroundPosition"==g?d.backgroundPositionX+" "+d.backgroundPositionY:
d[b];for(var b=b||Element.PROPERTIES,g,h=b.length,i=0;i<h;++i)g=b[i],"opacity"===g?(f=d.filter.match(/opacity=(\d+)/i),e[g]=null===f?1:parseInt(f[1],10)/100):e[g]="height"===g||"width"===g?c(g):"backgroundPosition"===g?d.backgroundPositionX+" "+d.backgroundPositionY:d[g];return e},Element.getStyle=Element.getStyles,Element.noScopeElements="<style <script <link &lt;style &lt;script &lt;link".split(" "),Element.setInnerHTML=function(a,b){Element.innerHTML(a,b,!1)},Element.appendInnerHTML=function(a,
b){Element.innerHTML(a,b,!0)},Element.innerHTML=function(a,b,c){b=String.stringify(b);b=b.escapeForInnerHTML();this.noScopeElements.some(function(a){return-1!==b.indexOf(a)})?(a.innerHTML=c?'<input type="hidden"/>'+a.innerHTML+b:'<input type="hidden"/>'+b,a.removeChild(a.firstChild)):a.innerHTML=c?a.innerHTML+b:b},Element.clone=function(a){var b=a.cloneNode(!1);if("TR"!=a.tagName)return b.innerHTML=a.innerHTML,b;var c,d,e;for(c=0;c<a.children.length;++c)d=a.children[c],e=d.cloneNode(!1),e.id="",e.innerHTML=
d.innerHTML,b.appendChild(e);return b});
coherent.Browser.IE&&(Object.extend(Event,{preventDefault:function(a){a.returnValue=!1},onDomReady:function(a){function b(){try{document.documentElement.doScroll("left"),document.body.firstChild,document.namespaces}catch(a){b.delay(1);return}Event._domHasFinishedLoading()}Event._domHasFinishedLoading.done?window.setTimeout(a,0):(Event._readyCallbacks||(b.delay(1),Event.observe(window,"load",Event._domHasFinishedLoading),Event._readyCallbacks=[]),Event._readyCallbacks.push(a))}}),window.addEventListener||
Object.extend(Event,{observe:function(a,b,c){"on"!=b.slice(0,2)&&(b="on"+b);a.attachEvent(b,c)},stopObserving:function(a,b,c){"on"!=b.slice(0,2)&&(b="on"+b);a.detachEvent(b,c)},stop:function(a){a=a||window.event;a.returnValue=!1;a.cancelBubble=!0}}));
coherent.Formatter=Class.create({invalidValueMessage:_("error.invalid_value"),constructor:function(a){Object.extend(this,a)},stringForValue:function(a){return null===a||"undefined"===typeof a?"":String(a)},valueForString:function(a){return a},isStringValid:function(){return!0},isValidInputCharacter:function(){return!0}});
coherent.NumberFormatter=Class.create(coherent.Formatter,{invalidValueMessage:_("error.invalid_number"),validFloatCharacters:"0123456789.-",validIntCharacters:"0123456789-",allowsFloats:!0,stringForValue:function(a){return null===a||"undefined"===typeof a?"":String(a)},valueForString:function(a){return this.allowsFloats?parseFloat(a):parseInt(a,10)},isStringValid:function(a){var a=this.valueForString(a),b=!isNaN(a);b&&!isNaN(this.minimum)&&(b=a>=this.minimum);b&&!isNaN(this.maximum)&&(b=a<=this.maximum);
return b?!0:new coherent.Error({description:this.invalidValueMessage})},isValidInputCharacter:function(a){return this.allowsFloats?-1!==this.validFloatCharacters.indexOf(a):-1!==this.validIntCharacters.indexOf(a)}});
coherent.RegexFormatter=Class.create(coherent.Formatter,{constructor:function(a){this.base(a);this.typeofValidCharacters=typeof this.validCharacters;this.invalidRegex&&"exec"in this.invalidRegex&&(this.invalidRegex=[this.invalidRegex]);this.validRegex&&"exec"in this.validRegex&&(this.validRegex=[this.validRegex])},isStringValid:function(a){var b,c,d,e=!0;if(this.invalidRegex&&this.invalidRegex.length){d=this.invalidRegex;b=0;for(c=d.length;b<c;++b)if(d[b].test(a)){e=!1;break}}if(e&&this.validRegex&&
this.validRegex.length){e=!1;d=this.validRegex;b=0;for(c=d.length;b<c;++b)if(d[b].test(a)){e=!0;break}}return e?!0:new coherent.Error({description:this.invalidValueMessage})},isValidInputCharacter:function(a){return!this.validCharacters?!0:"string"===this.typeofValidCharacters?-1!==this.validCharacters.indexOf(a):this.validCharacters.test(a)}});
coherent.easing=function(){var a=Math.PI/2,b=Math.PI;return{linear:function(a){return a},cubicBezier:function(a,b,e,f,g){function h(a,b){for(var c=0,d=1,e=a,f,g,h=8;h--;){f=((l*e+j)*e+i)*e-a;if(Math.abs(f)<b)return e;g=(3*l*e+2*j)*e+i;if(1E-6>Math.abs(g))break;e-=f/g}e=a;if(e<c)return c;if(e>d)return d;for(;c<d;){f=((l*e+j)*e+i)*e;if(Math.abs(f-a)<b)break;a>f?c=e:d=e;e=0.5*(d-c)+c}return e}var i=3*a,j=3*(e-a)-i,l=1-i-j,k=3*b,n=3*(f-b)-k,m=1-k-n,r,g=g/1E3||5;r=function(a){a=h(a,1/(200*g));return((m*
a+n)*a+k)*a};r.timingFunction="cubic-bezier";r.p1x=a;r.p1y=b;r.p2x=e;r.p2y=f;return r},ease:function(a){a=coherent.easing.cubicBezier(0.25,0.1,0.25,1,a);a.timingFunction="ease";return a},easeIn:function(a){a=coherent.easing.cubicBezier(0.42,0,1,1,a);a.timingFunction="ease-in";return a},easeOut:function(a){a=coherent.easing.cubicBezier(0,0,0.58,1,a);a.timingFunction="ease-out";return a},easeInOut:function(a){a=coherent.easing.cubicBezier(0.42,0,0.58,1,a);a.timingFunction="ease-in-out";return a},linearCompleteAndReverse:function(a){return 0.5<
a?2-2*a:2*a},inSine:function(b){return 1-Math.cos(b*a)},outSine:function(b){return Math.sin(b*a)},inOutSine:function(a){return(1-Math.cos(a*b))/2},inBack:function(a,b){void 0==b&&(b=1.70158);return a*a*((b+1)*a-b)},outBack:function(a,b){void 0==b&&(b=1.70158);a-=1;return a*a*((b+1)*a+b)+1},outBackStrong:function(a,b){void 0==b&&(b=1.70158*1.5);a-=1;return a*a*((b+1)*a+b)+1},inOutQuad:function(a){return 1>(a/=0.5)?0.5*a*a:-0.5*(--a*(a-2)-1)}}}();
coherent.Animator=function(){function a(a,b,c){var d={},c=c||{};Element.depthFirstTraversal(a,function(a){if(!a||"PARAM"==a.tagName.toUpperCase())return!1;var e=Element.assignId(a);d[e]=v(a,b);if(c[e])return!1});return d}function b(){return[this.r,this.g,this.b,this.a].join()}function c(a){if("string"!=typeof a)return a;var c;if(c=Element.colours[a.toLowerCase()])a=c;if(c=a.match(/^rgb(?:a)?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d(?:\.\d+)?)\s*)?\)$/i))return{r:parseInt(c[1],10),g:parseInt(c[2],
10),b:parseInt(c[3],10),a:parseInt(c[4]||1,10),toString:b};if("#"!==a.charAt(0)){if("transparent"==a)return{r:255,g:255,b:255,a:0};throw Error("Invalid colour: "+a);}return 4==a.length?{r:parseInt(a.charAt(1)+a.charAt(1),16),g:parseInt(a.charAt(2)+a.charAt(2),16),b:parseInt(a.charAt(3)+a.charAt(3),16),a:1,toString:b}:{r:parseInt(a.substr(1,2),16),g:parseInt(a.substr(3,2),16),b:parseInt(a.substr(5,2),16),a:1,toString:b}}function d(a,b,d,e,f){this.property=a;this.element=b;this.start=c(d);this.end=
c(e);coherent.Support.CSS3ColorModel?(0===this.start.a?(this.start.r=this.end.r,this.start.g=this.end.g,this.start.b=this.end.b):0===this.end.a&&(this.end.r=this.start.r,this.end.g=this.start.g,this.end.b=this.start.b),this.step=this.stepRGBA):this.step=this.stepRGB;this.delta={r:this.end.r-this.start.r,g:this.end.g-this.start.g,b:this.end.b-this.start.b,a:this.end.a-this.start.a};this.shouldCleanup=!!f}function e(a,b,c,d,e){this.property=a;this.element=b;this.start=parseInt(c||0,10);this.end=parseInt(d||
0,10);this.delta=this.end-this.start;this.shouldCleanup=!!e}function f(a,b,c,d){this.element=a;this.start=parseFloat(b||0);this.end=parseFloat(c||0);this.delta=c-b;this.shouldCleanup=!!d}function g(a,b,c,d,e){this.property=a;this.element=b;this.start=c;this.end=d;this.shouldCleanup=!!e}function h(a,b,c){this.element=a;this.start=b;this.end=c}function i(a,b,c,d){function e(a){switch(a){case "top":return"0% 50%";case "right":return"100% 50%";case "bottom":return"50% 100%";case "left":return"0% 50%";
case "center":return"50% 50%";default:return a=a.replace(/top|left/g,"0%"),a=a.replace(/bottom|right/g,"100%")}}function f(a){return parseInt(a,10)}var b=e(b),c=e(c),h=b.match(/%|px/)[0],i=c.match(/%|px/)[0];if(h!=i)return new g("backgroundPosition",a,b,c,d);this.element=a;this.unit=h;this.start=Array.map(b.split(" "),f);this.end=Array.map(c.split(" "),f);this.delta=[this.end[0]-this.start[0],this.end[1]-this.start[1]];this.shouldCleanup=!!d;return this}function j(a,b,c,d){this.element=a;this.startX=
parseInt(b[0]||0,10);this.endX=parseInt(c[0]||0,10);this.startY=parseInt(b[1]||0,10);this.endY=parseInt(c[1]||0,10);this.deltaX=this.endX-this.startX;this.deltaY=this.endY-this.startY;this.shouldCleanup=!!d}function l(a,b,c,l,k){switch(a){case "_className":return new h(b,c,l);case "display":return new g(a,b,c,l,k);case "backgroundPosition":return new i(b,c,l,k);case "backgroundColor":case "color":case "borderColor":case "borderTopColor":case "borderRightColor":case "borderBottomColor":case "borderLeftColor":return new d(a,
b,c,l,k);case "opacity":return new f(b,c,l,k);case "scroll":return new j(b,c,l,k);default:return new e(a,b,c,l,k)}}function k(){var a,b,c,d,e=(new Date).getTime();coherent.EventLoop._start=e;for(a in p)for(c in b=p[a].properties,b)if(d=b[c][0],e>=d.endTime){d.step(1);d=a;var f=c,g=[],h=p[d];if(h&&h.properties[f]){var i=h.properties[f].shift();i.shouldCleanup&&"function"===typeof i.cleanup&&i.cleanup();"function"==typeof i.callback&&g.push(i.callback);h.properties[f].length||(delete h.properties[f],
h.propCount--);h.propCount||("function"==typeof p[d]._callback&&g.push(h._callback),delete p[d],w--);!w&&u&&(window.clearInterval(u),u=null);h=g.length;for(i=0;i<h;i++)g[i](document.getElementById(d),f)}}else d.startTime<=e&&d.step((e-d.startTime)/d.totalTime)}function n(a,b,c){c=Object.applyDefaults(c,q);if(c.delay)arguments.callee.delay(c.delay,a,b,c),delete c.delay;else{var d=Element.assignId(a),e=p[d];e||(w++,e=p[d]={_node:a,propCount:0,properties:{},timers:{}});"function"==typeof c.callback&&
(e._callback=c.callback);var d=c.startTime||coherent.EventLoop.getStart(),f=d+c.duration,g=c.startStyles||v(a,Set.toArray(b));"margin"in b&&(b.marginLeft=b.marginRight=b.marginTop=b.marginBottom=b.margin,delete b.margin);"padding"in b&&(b.paddingLeft=b.paddingRight=b.paddingTop=b.paddingBottom=b.padding,delete b.padding);"borderColor"in b&&(b.borderLeftColor=b.borderRightColor=b.borderTopColor=b.borderBottomColor=b.borderColor,delete b.borderColor);"borderWidth"in b&&(b.borderLeftWidth=b.borderRightWidth=
b.borderTopWidth=b.borderBottomWidth=b.borderWidth,delete b.borderWidth);for(var h in b){var i=b[h],j=d+(i.delay||0),m=i.duration?i.duration+j:f,n=i,r=i.curve||c.curve,D=i.discreteTransitionPoint||c.discreteTransitionPoint||0.5,E="undefined"!==typeof i.cleanup?i.cleanup:c.cleanup,B;"object"===typeof n&&"value"in n&&(n=n.value);h in e.properties?B=e.properties[h]:(e.propCount++,B=[]);var F=function(a,b){var c=b.startTime<m&&b.endTime>m,d=b.startTime<=j&&b.endTime>=m;b.startTime<j&&b.endTime>j||(c||
d)||a.push(b);return a};B.length&&(B=B.reduce(F,[]));n=l(h,a,g[h],n,E);n.curve=r;n.discreteTransitionPoint=D;n.startTime=j;n.endTime=m;n.totalTime=m-j;"object"===typeof i&&"callback"in i&&(n.callback=i.callback);c.stepBackToZero&&n.step(0);B.push(n);e.properties[h]=B}u||(u=window.setInterval(k,10))}}function m(b,c,d){function e(a){var b=a.id,c=d.actions[b],f=g[b]||{},h=k[b]||{},i={};if(!c){var j=f.display,l=h.display;"none"==j&&"none"==l&&(c=coherent.Animator.IGNORE_NODE);"none"==j&&"none"!==l&&(c=
coherent.Animator.FADE_IN_NODE);"none"!==j&&"none"==l&&(c=coherent.Animator.FADE_OUT_NODE)}"function"===typeof c&&(c=c(a,g,k));"object"==typeof c&&(i=c,c=coherent.Animator.MORPH_NODE);switch(c){case coherent.Animator.IGNORE_NODE:return!1;case coherent.Animator.FADE_NODE:return m[b]=m[b]||{},m[b].opacity={value:"0",duration:d.duration,curve:coherent.easing.linearCompleteAndReverse},!1;case coherent.Animator.FADE_OUT_NODE:return document.getElementById(b).style.display="block",m[b]=m[b]||{},m[b].opacity=
{value:"0",duration:d.duration/2,cleanup:!1,callback:function(){document.getElementById(b).style.display=""}},!1;case coherent.Animator.FADE_IN_NODE:return f.opacity=0,document.getElementById(b).style.display="block",m[b]=m[b]||{},m[b].opacity={value:"1",duration:d.duration/2,delay:d.duration/2,callback:function(){document.getElementById(b).style.display=""}},!1;default:for(var t in f)if(a=p[b],j=(c=i[t])?c.value||c:h[t],a&&t in a.properties||String(f[t])!=String(j))m[b]=m[b]||{},t in i?(m[b][t]=
c.value?c:{value:c},m[b][t].cleanup=!1):m[b][t]=j;return!0}}var f=p[b.id];if(b.className===c&&(!f||!f._className||f._className.value===c))d.callback&&d.callback();else if(d=Object.applyDefaults(d,q),d.delay)arguments.callee.delay(d.delay,b,c,d),delete d.delay;else if(f=Element.assignId(b),document.getElementById(f)){var f=d.only,g=a(b,f,d.ignore),h=b.className;b.className=c;for(var i in g){var j=p[i];if(j)for(var l in j.properties)j._node.style[l]=""}var k=a(b,f,d.ignore);b.className=h;var m={};m[b.id]=
{_className:{value:c,duration:d.duration,callback:d.callback}};delete d.callback;Element.depthFirstTraversal(b,e);d.stepBackToZero=!0;d.cleanup=!0;d.startTime=(new Date).getTime();for(var u in m)if(i=document.getElementById(u))d.startStyles=g[u],n(i,m[u],d)}else b.className=c,d.callback&&d.callback()}function r(a,b){var c=Element.regexForClassName(b);return a.replace(c," ")}var q={duration:500,actions:{}},u=null,p={},w=0,v=Element.getStyles;d.prototype.stepRGB=function(a){this.curve&&(a=this.curve(a));
a=["rgb(",Math.round(a*this.delta.r+this.start.r),",",Math.round(a*this.delta.g+this.start.g),",",Math.round(a*this.delta.b+this.start.b),")"].join("");this.element.style[this.property]=a};d.prototype.stepRGBA=function(a){this.curve&&(a=this.curve(a));a=["rgba(",Math.round(a*this.delta.r+this.start.r),",",Math.round(a*this.delta.g+this.start.g),",",Math.round(a*this.delta.b+this.start.b),",",a*this.delta.a+this.start.a,")"].join("");this.element.style[this.property]=a};d.prototype.cleanup=function(){this.element.style[this.property]=
""};e.prototype.step=function(a){this.curve&&(a=this.curve(a));this.element.style[this.property]=Math.round(a*this.delta+this.start)+"px"};e.prototype.cleanup=function(){this.element.style[this.property]=""};"undefined"!=typeof document.createElement("div").style.opacity?(f.prototype.step=function(a){this.curve&&(a=this.curve(a));a=a*this.delta+this.start;this.element.style.opacity=1<=a?1:a.toFixed(3)},f.prototype.cleanup=function(){this.element.style.opacity=""}):coherent.Browser.IE&&(f.prototype.step=
function(a){this.curve&&(a=this.curve(a));a=a*this.delta+this.start;this.element.style.filter=1<=a?"":"Alpha(Opacity="+Math.round(100*a)+")"},f.prototype.cleanup=function(){this.element.style.cssText=this.element.style.cssText.replace(/filter:.*?(?:;|$)/i,"")});g.prototype.step=function(a){a>=this.discreteTransitionPoint&&(this.element.style[this.property]=this.end,this.step=function(){})};g.prototype.cleanup=function(){this.element.style[this.property]=""};h.prototype.step=function(a){a>=this.discreteTransitionPoint&&
(this.element.className=this.end,this.step=function(){})};i.prototype.step=function(a){this.curve&&(a=this.curve(a));this.element.style.backgroundPosition=Math.round(a*this.delta[0]+this.start[0])+this.unit+" "+Math.round(a*this.delta[1]+this.start[1])+this.unit};i.prototype.cleanup=function(){coherent.Browser.IE?(this.element.style.backgroundPositionX="",this.element.style.backgroundPositionY=""):this.element.style.backgroundPosition=""};j.prototype.step=function(a){this.curve&&(a=this.curve(a));
this.element.scrollTo(Math.round(a*this.deltaX+this.startX),Math.round(a*this.deltaY+this.startY))};j.prototype.cleanup=function(){this.element.scrollTo(this.startX,this.startY)};return{actors:function(){return p},addClassName:function(a,b,c){if(b){var d=Element.regexForClassName(b),e=a.className;d.test(e)||(e=e?e+(" "+b):b);m(a,e,c)}},removeClassName:function(a,b,c){var d=a.className;d===b?m(a,"",c):(d="string"===typeof b?r(d,b):b.reduce(r,d),m(a,d,c))},setClassName:function(a,b,c){m(a,b,c)},replaceClassName:function(a,
b,c,d){b?(b=Element.regexForClassName(b),c=a.className.replace(b,"$1"+c+"$2")):c=a.className+" "+c;m(a,c,d)},setStyles:n,abort:function(){p={};u&&(window.clearInterval(u),u=null)},abortAnimation:function(a){delete p[a.id]}}}();coherent.Animator.FADE_NODE="fade";coherent.Animator.FADE_IN_NODE="fade_in";coherent.Animator.FADE_OUT_NODE="fade_out";coherent.Animator.IGNORE_NODE="ignore";coherent.Animator.MORPH_NODE="morph";
coherent.Animator.innerHTML=function(a,b,c){function d(){Element.setInnerHTML(a,b);coherent.Animator.setStyles(a,{opacity:1},{duration:c/2,callback:e,cleanup:!0})}function e(){a.style.overflow=""}c=c||500;if("none"!=a.style.display){var f=a.innerHTML,g=Element.getStyles(a,"height");Element.setInnerHTML(a,b);var h=Element.getStyles(a,"height");Element.setInnerHTML(a,f);a.style.height=g;a.style.overflow="hidden";coherent.Animator.setStyles(a,{opacity:{value:0,callback:d}},{duration:c/2});coherent.Animator.setStyles(a,
{height:{value:h,curve:coherent.easing.inOutSine}},{duration:c,cleanup:!0})}else a.innerHTML=b};coherent.Animator.innerText=function(a,b,c){function d(b){b=document.createTextNode(b);a.innerHTML="";a.appendChild(b)}function e(){d(b);coherent.Animator.setStyles(a,{opacity:1},{duration:c/2,cleanup:!0})}c=c||500;"none"!=a.style.display?coherent.Animator.setStyles(a,{opacity:0},{duration:c/2,callback:e}):d(b)};
coherent.Animator.scrollTo=function(a,b){var c=Element.getViewport(),d=(window.height||document.body.scrollHeight)-c.height,e=a,f;"string"==typeof a?f=document.getElementById(a.replace("#","")):"nodeName"in a&&(f=a);f&&(e=Element.getRect(f),e=[c.left,Math.min(d,e.top)]);b=Object.applyDefaults({duration:375,curve:coherent.easing.cubicBezier(0.175,0.9,0.2,1,375),startStyles:{scroll:[c.left,c.top]},callback:function(){f&&f.id&&(window.location.hash="#"+f.id)}},b);coherent.Animator.setStyles(window,{scroll:e},
b)};var CancelledError=coherent.defineError("CancelledError"),InvalidStateError=coherent.defineError("InvalidStateError");
(function(){coherent.Deferred=Class.create({constructor:function(a){this.canceller=a;this._result=null;this._status=-1;this._callbacks=[]},_fire:function(a){for(;this._callbacks.length;){this._status=a instanceof Error?1:0;this._result=a;var b=this._callbacks.shift()[this._status];if(b&&(a=b(a),a instanceof coherent.Deferred)){var c=this,b=function(a){c._fire(a);return a};a.addMethods(b,b);return}}this._status=a instanceof Error?1:0;this._result=a},result:function(){return this._result},cancel:function(){if(-1!==
this._status)throw new InvalidStateError("Can not cancel Deferred because it is already complete");var a=this.canceller&&this.canceller();a instanceof Error||(a=new CancelledError("Deferred operation cancelled"));this.failure(a)},addMethods:function(a,b){this._callbacks.push([a,b]);if(-1===this._status)return this;this._fire(this._result);return this},addCallback:function(a){return this.addMethods(a,null)},addErrorHandler:function(a){return this.addMethods(null,a)},callback:function(a){if(-1!==this._status)throw new InvalidStateError("Can not signal callback because Deferred is already complete: result="+
a);this._fire(a)},failure:function(a){if(-1!==this._status)throw new InvalidStateError("Can not signal failure because Deferred is already complete: error="+a);this._fire(a)}})})();
coherent.URL=Class.create({constructor:function(a){this.url=a.trim();a=/^(([^\:\/\?#]+)\:)?(\/\/([^\/\?#]*))?([^\?#]*)(\?([^#]*))?(#(.*))?$/;a=this.url.match(a)||[];this.protocol=a[2]||"";this.authority=a[4]||"";this.path=a[5].trim()||"";this.query=a[7]||"";this.fragment=a[9]||"";a=/^(([^@]+)@)?([^\:]+)(:(.+))?$/;a=this.authority.match(a)||[];this.userInfo=a[2]||"";this.host=a[3]||"";this.port=a[5]||""},toHash:function(a){var b=this.query.split("&").map(function(a){return escape(a)}),a="undefined"!==
typeof a?a:",";b.sort();return[this.protocol,this.authority,this.path,b,this.fragment].join(a)}});
coherent.FormControl=Class.create(coherent.View,{exposedBindings:["value","name"],init:function(){this.base();var a=this.viewElement(),b=this.bindings;b.value&&(!b.value.hasValue()&&a.value)&&b.value.setValue(a.value);b.name&&(!b.name.hasValue()&&a.name)&&b.name.setValue(a.name)},observeValueChange:function(a){var b=this.viewElement(),a=a.newValue;"undefined"===typeof a?b.disabled=!0:this.bindings.enabled||(b.disabled=!1);this.bindings.editable||(b.readOnly=!this.bindings.value.mutable()||coherent.Markers.MultipleValues===
a||coherent.Markers.NoSelection===a);b.readOnly?Element.addClassName(b,coherent.Style.kReadOnlyClass):Element.removeClassName(b,coherent.Style.kReadOnlyClass);b.disabled?Element.addClassName(b,coherent.Style.kDisabledClass):Element.removeClassName(b,coherent.Style.kDisabledClass);b.value=a},observeNameChange:function(a){this.viewElement().name=a.newValue},validate:function(){return this.viewElement().value}});
coherent.Button=Class.create(coherent.FormControl,{__viewClassName__:"Button",__tagSpec__:["input[type=button]","input[type=submit]","input[type=reset]","button"],requireBindingsForInferredViewType:!1,onmousedown:function(){var a=this.viewElement();Element.addClassName(a,coherent.Style.kActiveClass)},onmouseup:function(){var a=this.viewElement();Element.removeClassName(a,coherent.Style.kActiveClass)},onclick:function(a){this.disabled?Event.stop(a):this.sendAction()}});
coherent.EventLoop={currentEvent:null,getStart:function(){this._start||(this._start=(new Date).getTime());return this._start},begin:function(a){this._start=(new Date).getTime();this.currentEvent=a},end:function(){this._start=this.currentEvent=null}};
coherent.Form=Class.create(coherent.FieldGroup,{exposedBindings:["actionUrl","method"],sendActionOn:["submit"],init:function(){this.base();var a=this.viewElement(),b=this.bindings;b.actionUrl&&(!b.actionUrl.hasValue()&&a.action)&&b.actionUrl.setValue(a.action);b.method&&(!b.method.hasValue()&&a.method)&&b.method.setValue(a.method);Event.observe(a,"submit",this.onsubmit.bind(this))},onsubmit:function(a){this.action&&this.sendActionOn.containsObject("submit")&&(Event.stop(a),this.sendAction())},observeActionUrlChange:function(a){this.viewElement().action=
a.newValue},observeMethodChange:function(a){this.viewElement().method=a.newValue}});
coherent.ImageView=Class.create(coherent.View,{__viewClassName__:"Image",__tagSpec__:["img","input[type=image]"],exposedBindings:["src","alt","width","height"],multipleValuesPlaceholder:_("marker.image.multipleValues"),nullPlaceholder:_("marker.image.placeholder"),noSelectionPlaceholder:_("marker.image.noSelection"),init:function(){this.base();var a=this.viewElement();Event.observe(a,"error",this.onerror.bind(this));Event.observe(a,"load",this.onload.bind(this));var b=this.bindings;b.src&&(!b.src.hasValue()&&
a.src)&&b.src.setValue(a.src);b.alt&&(!b.alt.hasValue()&&a.alt)&&b.alt.setValue(a.alt);b.width&&(!b.width.hasValue()&&a.width)&&b.width.setValue(a.width);b.height&&(!b.height.hasValue()&&a.height)&&b.height.setValue(a.height)},onload:function(){var a=this.viewElement();this.setValueForKey(!1,"loading");Element.removeClassName(a,coherent.Style.kLoadingClass)},onerror:function(){var a=this.viewElement();this.setValueForKey(!1,"loading");Element.updateClass(a,coherent.Style.kInvalidValueClass,coherent.Style.kLoadingClass)},
src:function(){var a=this.viewElement().src;return"about:blank"===a?null:a},setSrc:function(a){this.bindings.src&&this.bindings.src.setValue(a);this.setValueForKey(!0,"loading");var b=this.viewElement();Element.updateClass(b,coherent.Style.kLoadingClass,coherent.Style.kInvalidValueClass);a||(a="about:blank");var c=b.src;b.src=a;if(coherent.Browser.Safari&&b.src===c)this.onload()},observeSrcChange:function(a){var b=this.viewElement(),a=a.newValue,c=!0;switch(a){case "":case null:case void 0:a=this.attributeOrProperty("nullPlaceholder");
break;case coherent.Markers.NoSelection:a=this.attributeOrProperty("noSelectionPlaceholder");break;case coherent.Markers.MultipleValues:a=this.attributeOrProperty("multipleValuesPlaceholder");break;default:c=!1}c?Element.addClassName(b,coherent.Style.kMarkerClass):Element.removeClassName(b,coherent.Style.kMarkerClass);this.setSrc(a)},observeWidthChange:function(a){var b=this.viewElement(),a=parseInt(a.newValue,10);isNaN(a)?b.removeAttribute("width"):b.width=a},observeAltChange:function(a){var b=this.viewElement(),
a=a.newValue;b.alt=null===a||"undefined"===typeof a?"":a},observeHeightChange:function(a){var b=this.viewElement(),a=parseInt(a.newValue,10);isNaN(a)?b.removeAttribute("height"):b.height=a}});
coherent.Media=Class.create(coherent.View,{exposedBindings:["src","currentTime","volume","muted"],init:function(){var a=this.viewElement(),b=this.bindings;b.src&&(!b.src.hasValue()&&a.src)&&b.src.setValue(a.src);b.currentTime&&!b.currentTime.hasValue()&&b.currentTime.setValue(a.currentTime);b.duration&&!b.duration.hasValue()&&b.duration.setValue(a.duration);b.volume&&!b.volume.hasValue()&&b.volume.setValue(a.volume);b.muted&&!b.muted.hasValue()&&b.muted.setValue(a.muted);Event.observe(a,"ended",this.mediaDidEnd.bindAsEventListener(this))},
pause:function(){var a=this.viewElement();a.paused||a.pause()},play:function(){this.viewElement().play();this.forceChangeNotificationForKey("ended")},stop:function(){var a=this.viewElement();a.currentTime=a.duration},muted:function(){return this.viewElement().muted},mediaDidEnd:function(){this.forceChangeNotificationForKey("ended")},ended:function(){return this.viewElement().ended},src:function(){return this.viewElement().src},setSrc:function(a){this.bindings.src&&this.bindings.src.setValue(a);var b=
this.viewElement(),c=this;(function(){b.src=a;b.load();c.forceChangeNotificationForKey("ended")}).delay(0)}});
coherent.Page=Class.create(coherent.Responder,{constructor:function(){this.firstResponder=null;this.__hoverTrackingIds={};this._onmousedragHandler=this._onmousedrag.bindAsEventListener(this);this._delegates={click:[]};this.onclick=this._fireDelegates},targetViewForEvent:function(a){for(var a=a.target||a.srcElement,b,c=coherent.View.fromNode;a&&a!=document&&!(b=c(a));)a=a.parentNode;return!a||a==document?null:b},makeFirstResponder:function(a){if(this.firstResponder==a)return!0;if(this.firstResponder&&
!this.firstResponder.resignFirstResponder())return!1;this.firstResponder&&Element.removeClassName(this.firstResponder.viewElement(),coherent.Style.kFocusClass);if(a&&!a.becomeFirstResponder())return!1;this.willChangeValueForKey("firstResponder");this.firstResponder=a;this.didChangeValueForKey("firstResponder");a&&(a.focus(),Element.addClassName(a.viewElement(),coherent.Style.kFocusClass));return!0},addTrackingInfo:function(a,b){"string"!==typeof a&&(a=Element.assignId(a));var c=this.__hoverTrackingIds[a];
c||(c=this.__hoverTrackingIds[a]=[]);c.push(b)},superview:function(){return null},presentError:function(a){(function(){var b=a.description;a.recoverySuggestion&&(b+="\n"+a.recoverySuggestion);window.alert(b);coherent.page.makeFirstResponder(a.field)}).delay(0)},delegate:function(a,b,c){if("string"===typeof b)this._delegates[b].push({sel:a,fn:c});else for(var d in b){if(!(d in this._delegates))throw Error("Invalid delegation event type: "+d);this._delegates[d].push({sel:a,fn:b[d]})}},superview:function(){return null},
_fireDelegates:function(a){var b=a.target||a.srcElement,c=Element.match;(this._delegates[a.type]||[]).forEach(function(d){c(b,d.sel)&&d.fn(a)})},_findFirstResponder:function(a){for(;a&&!a.acceptsFirstResponder();)a=a.superview();a?this.makeFirstResponder(a):this.makeFirstResponder(null)},_onmousedown:function(a){var b=this.targetViewForEvent(a);b&&(this._findFirstResponder(b),b.onmousedown(a),Event.observe(document,"mousemove",this._onmousedragHandler));this._mousedownView=b},_onmouseup:function(a){if(this._mousedownView)this._mousedownView.onmouseup(a);
Event.stopObserving(document,"mousemove",this._onmousedragHandler)},_onmousedrag:function(a){if(this._mousedownView)this._mousedownView.onmousedrag(a)},_onmouseover:function(a){for(var b=this.__hoverTrackingIds||{},c=this.__mouseOverIds||{},d={},a=a.target||a.srcElement,e=document.body,f,g,h,i,j;a&&a!=e;a=a.parentNode)if((g=a.id)&&g in b)if(d[g]=!0,!(g in c)){f=b[g];i=f.length;for(h=0;h<i;++h)j=f[h],j.onmouseenter&&j.onmouseenter.call(j.owner,a,j.ownerInfo)}for(g in c)if(!(g in d)&&(a=document.getElementById(g))){f=
b[g];i=f.length;for(h=0;h<i;++h)j=f[h],j.onmouseleave&&j.onmouseleave.call(j.owner,a,j.ownerInfo)}this.__mouseOverIds=d},_onmouseout:function(){},_onclick:function(a){if(!(coherent.Browser.Mozilla&&2===a.button)){var b=this.targetViewForEvent(a);if(b)b.onclick(a);else this._fireDelegates(a)}},_ondblclick:function(a){if(this._mousedownView)this._mousedownView.ondblclick(a)},_onkeydown:function(a){var b=this.firstResponder;if(b)b.onkeydown(a)},_onkeyup:function(a){var b=this.firstResponder;if(b)b.onkeyup(a)},
_onkeypress:function(a){var b=this.firstResponder;if(b)b.onkeypress(a)},_onfocus:function(a){var b=a.target||a.srcElement;b!=window&&(b==document?(this.makeFirstResponder(this._previousFirstResponder||null),this._previousFirstResponder=null):(a=this.targetViewForEvent(a))&&a.acceptsFirstResponder()?this.makeFirstResponder(a):this.makeFirstResponder(null))},_onblur:function(a){var b=a.target||a.srcElement;b!=window&&(b==document?(this._previousFirstResponder=this.firstResponder,this.makeFirstResponder(null)):
(a=this.targetViewForEvent(a))&&this.firstResponder==a&&this.makeFirstResponder(null))},_ontouchstart:function(a){var b=this.targetViewForEvent(a);b&&(b.ontouchstart(a),b.onmousedown(a));this._touchstartView=b},_ontouchmove:function(a){if(this._touchstartView)this._touchstartView.ontouchmove(a)},_ontouchend:function(a){this._touchstartView&&(this._touchstartView.ontouchend(a),this._touchstartView.onmouseup(a))},_ontouchcancel:function(a){this._touchstartView&&(this._touchstartView.ontouchend(a),this._touchstartView.onmouseup(a))},
_onunload:function(){var a,b=coherent.View.viewLookup;for(a in b)b[a].teardown(),delete b[a]}});
(function(){coherent.page=new coherent.Page;window._setTimeout=window.setTimeout;window.setTimeout=function(a,b){if(!a)return null;if("string"===typeof a)return a="coherent.EventLoop.begin();do {"+a+"} while (false); coherent.EventLoop.end();",window._setTimeout(a,b);var e=Array.from(arguments,2);return window._setTimeout(function(){coherent.EventLoop.begin();var b=a.apply(this,e);coherent.EventLoop.end();return b},b)};window._setInterval=window.setInterval;window.setInterval=function(a,b){if(!a)return null;
if("string"===typeof a)return a="coherent.EventLoop.begin();do {"+a+"} while (false); coherent.EventLoop.end();",window._setInterval(a,b);var e=Array.from(arguments,2);return window._setInterval(function(){coherent.EventLoop.begin();var b=a.apply(this,e);coherent.EventLoop.end();return b},b)};var a=coherent.page,b;b=function(b){return function(d){d=d||window.event;Event.shiftKey=d.shiftKey;coherent.EventLoop.begin(d);a[b](d);coherent.EventLoop.end()}};window.addEventListener?(document.addEventListener("mouseover",
b("_onmouseover"),!1),document.addEventListener("mouseout",b("_onmouseout"),!1),document.addEventListener("mousedown",b("_onmousedown"),!1),document.addEventListener("mouseup",b("_onmouseup"),!1),document.addEventListener("click",b("_onclick"),!1),document.addEventListener("dblclick",b("_ondblclick"),!1),document.addEventListener("keydown",b("_onkeydown"),!1),document.addEventListener("keyup",b("_onkeyup"),!1),document.addEventListener("keypress",b("_onkeypress"),!1),document.addEventListener("focus",
b("_onfocus"),!0),document.addEventListener("blur",b("_onblur"),!0),window.addEventListener("focus",b("_onfocus"),!1),window.addEventListener("blur",b("_onblur"),!1),coherent.Support.Touches&&(document.addEventListener("touchstart",b("_ontouchstart"),!0),document.addEventListener("touchmove",b("_ontouchmove"),!0),document.addEventListener("touchend",b("_ontouchend"),!0),document.addEventListener("touchcancel",b("_ontouchcancel"),!0))):window.attachEvent&&(document.attachEvent("onmouseover",b("_onmouseover")),
document.attachEvent("onmouseout",b("_onmouseout")),document.attachEvent("onmousedown",b("_onmousedown")),document.attachEvent("onmouseup",b("_onmouseup")),document.attachEvent("onclick",b("_onclick")),document.attachEvent("ondblclick",b("_ondblclick")),document.attachEvent("onkeydown",b("_onkeydown")),document.attachEvent("onkeyup",b("_onkeyup")),document.attachEvent("onkeypress",b("_onkeypress")),document.attachEvent("onfocusin",b("_onfocus")),document.attachEvent("onfocusout",b("_onblur")),window.attachEvent("focus",
b("_onfocus")),window.attachEvent("blur",b("_onblur")),window.attachEvent("onunload",b("_onunload")))})();
coherent.TextField=Class.create(coherent.FormControl,{__viewClassName__:"TextField",__tagSpec__:["input[type=text]","input[type=password]","input[type=hidden]","textarea"],init:function(){this.base();var a=this.viewElement();Event.observe(a,"change",this.valueChanged.bindAsEventListener(this));Event.observe(a,"drop",this.fieldReceivedDropEvent.bindAsEventListener(this));this.editing=!1;this.validationError=null;var b=this.bindings;b.maxLength&&(!b.maxLength.hasValue()&&a.maxLength)&&b.maxLength.setValue(a.maxLength)},
exposedBindings:["errorMessage","maxLength"],multipleValuesPlaceholder:_("marker.input.multipleValues"),nullPlaceholder:_("marker.input.placeholder"),noSelectionPlaceholder:_("marker.input.noSelection"),keypressUpdateTimeout:500,continuallyUpdatesValue:!0,sendsActionOnEndEditing:!0,sendActionOn:["blur","keydown"],beginEditing:function(){this.editing=!0},endEditing:function(){Element.removeClassName(this.viewElement(),coherent.Style.kEditingClass);this.editing=!1;this.sendsActionOnEndEditing&&this.action&&
this.sendAction()},validate:function(){var a=this.viewElement().value,b;if(this.formatter){b=this.formatter.isStringValid(a);if(!0!==b)return this.presentError(b),b;a=this.formatter.valueForString(a)}(!this.bindings.errorMessage||!this.bindings.errorMessage.value())&&this.clearAllErrors();if(this.bindings.value){a=this.bindings.value.validateProposedValue(a);if(a instanceof coherent.Error)return this.presentError(a),a;a!=this.bindings.value.value()&&this.bindings.value.setValue(a)}return a},presentError:function(a){this.validationError=
a;Element.addClassName(this.viewElement(),coherent.Style.kInvalidValueClass);return this.base.apply(this,arguments)},clearAllErrors:function(){this.validationError=null;Element.removeClassName(this.viewElement(),coherent.Style.kInvalidValueClass);return this.base.apply(this,arguments)},acceptsFirstResponder:function(){var a=this.viewElement();return a.disabled||a.readOnly?!1:!0},becomeFirstResponder:function(){var a=this.viewElement();if(a.disabled||a.readOnly)return!1;this.markerValue&&this.clearMarkerValue();
this.hasFocus=!0;this.beginEditing();return!0},resignFirstResponder:function(){var a=this.viewElement();this.hasFocus=!1;""===a.value&&this.setMarkerValue("nullPlaceholder");this.endEditing();return!0},setMarkerValue:function(a){var b=this.viewElement(),c=this.attributeOrProperty(a);this.markerValue=a;b.value=c;Element.addClassName(b,coherent.Style.kMarkerClass)},clearMarkerValue:function(){var a=this.viewElement();this.markerValue=!1;a.value="";Element.removeClassName(a,coherent.Style.kMarkerClass)},
valueChanged:function(){this.updateTimer&&(window.clearTimeout(this.updateTmer),this.updateTimer=null);this.markerValue||this.validate()},fieldReceivedDropEvent:function(){this.viewElement().value="";this.clearMarkerValue()},onkeyup:function(a){if(!Event.isMetaKey(a)){var a=this.viewElement(),b=a.selectionStart,c=a.selectionEnd;Element.addClassName(a,coherent.Style.kEditingClass);coherent.Browser.Mozilla&&(a.selectionStart=b,a.selectionEnd=c);this.continuallyUpdatesValue&&(this.updateTimer&&window.clearTimeout(this.updateTimer),
!a.readOnly&&!a.disabled&&(this.updateTimer=this.valueChanged.bindAndDelay(this,this.keypressUpdateTimeout)))}},onkeydown:function(a){this.action&&a.keyCode===Event.KEY_RETURN&&(this.valueChanged(null),this.validationError||(this.sendAction(),Event.stop(a)))},onkeypress:function(a){var b=Event;if(this.formatter&&!(0===a.charCode||b.isMetaKey(a)||a.charCode===b.KEY_BACKSPACE||b.isModifiedKey(a)))b=String.fromCharCode(a.charCode||a.keyCode),this.formatter.isValidInputCharacter(b)||Event.stop(a)},observeValueChange:function(a){var b=
this.viewElement(),a=a.newValue;this.formatter&&(a=this.formatter.stringForValue(a));"undefined"===typeof a?b.disabled=!0:this.bindings.enabled||(b.disabled=!1);this.bindings.editable||(b.readOnly=!this.bindings.value.mutable()||coherent.Markers.MultipleValues===a||coherent.Markers.NoSelection===a);b.readOnly?Element.addClassName(b,coherent.Style.kReadOnlyClass):Element.removeClassName(b,coherent.Style.kReadOnlyClass);b.disabled?Element.addClassName(b,coherent.Style.kDisabledClass):Element.removeClassName(b,
coherent.Style.kDisabledClass);(!this.bindings.errorMessage||!this.bindings.errorMessage.value())&&this.clearAllErrors();if(!this.hasFocus)switch(b.type){case "text":case "password":case "textarea":null===a||"undefined"===typeof a||""===a?this.setMarkerValue("nullPlaceholder"):coherent.Markers.NoSelection===a?this.setMarkerValue("noSelectionPlaceholder"):coherent.Markers.MultipleValues===a?this.setMarkerValue("multipleValuesPlaceholder"):(this.clearMarkerValue(),b.value=a);break;default:b.value=a}},
observeErrorMessageChange:function(a){a.newValue?(a=new coherent.Error({description:a.newValue}),this.presentError(a)):this.clearAllErrors()},observeMaxLengthChange:function(a){var a=a.newValue,b=this.viewElement();"INPUT"==b.nodeName&&(b.maxLength=a)}});
coherent.SearchField=Class.create(coherent.TextField,{__viewClassName__:"Search",__tagSpec__:"input[type=search]",exposedBindings:["predicate"],init:function(){this.base();var a=this.viewElement();"search"===a.type&&Event.observe(a,"search",this.valueChanged.bindAsEventListener(this))},keypressUpdateTimeout:25,valueChanged:function(a){this.base(a);this.bindings.predicate&&this.bindings.predicate.setValue(this.createFilterPredicate())},createFilterPredicate:function(){var a=this.viewElement(),b=this.attributeOrProperty("predicate"),
c=a.value.toLowerCase();return function(a){a=a.valueForKeyPath(b);if(!a)return!!c;a=a.toLocaleString?a.toLocaleString():a.toString();a=a.toLowerCase();return-1!==a.indexOf(c)}},observePredicateChange:function(){}});
coherent.SelectField=Class.create(coherent.ListView,{__viewClassName__:"Select",__tagSpec__:"select",exposedBindings:["errorMessage","displayValues","contentValues","selectedValue","name"],init:function(){this.base();this._items=function(a){var b=this.viewElement().options;return a?b[a]:b}},_initFromDOM:function(){var a=this.viewElement(),b=this.bindings,c=this.objectClass||coherent.KVO,d=[],e=[],f=a.options,g=f.length,h,i,j;a.name&&(b.name&&!b.name.hasValue())&&b.name.setValue(a.name);if(g&&(!b.content||
!b.content.hasValue())){var a=b.displayValues&&b.displayValues.keyPath,l=b.contentValues&&b.contentValues.keyPath;h=b.content&&b.content.keyPath;a=a&&a.beginsWith(h)?a.substring(h.length+1):null;l=l&&l.beginsWith(h)?l.substring(h.length+1):null;for(h=0;h<g;++h)i=f[h],Element.assignId(i),j=e[h]=new c,a&&j.setValueForKeyPath(i.text,a),l&&j.setValueForKeyPath(i.value,l),i.selected&&d.push(h);this.__content=e;this.__selectionIndexes=d;this.selectedIndex=d.length?d[0]:-1;b.content&&b.content.setValue(e);
d.length&&(b.selectionIndexes&&b.selectionIndexes.setValue(d),b.selectedObject&&b.selectedObject.setValue(this.selectedIndex),b.selectedIndex&&b.selectedIndex.setValue(this.selectedIndex),b.selectedValue&&b.selectedValue.setValue(f[this.selectedIndex].value))}},observeContentChange:function(a){var b=this.viewElement(),c,d,e=[];switch(a.changeType){case coherent.ChangeType.setting:d=this.__content=a.newValue||[];for(var f=d.length,a=this.selectedObjects();b.options.length>f;)b.remove(b.options.length-
1);for(c=0;c<f;++c)-1!==a.indexOf(d[c])&&e.push(c),c==b.options.length&&(coherent.Browser.IE?b.add(new Option):b.add(new Option,null));break;case coherent.ChangeType.insertion:for(c=0;c<a.indexes.length;++c)d=a.indexes[c],coherent.Browser.IE||(d=b.options[d]),b.add(new Option,d);break;case coherent.ChangeType.replacement:for(c=0;c<a.indexes.length;++c)b.options[a.indexes[c]]=new Option;break;case coherent.ChangeType.deletion:e=this.selectionIndexes();for(c=a.indexes.length-1;0<=c;--c)d=a.indexes[c],
b.remove(d),e.removeObject(d);this.setSelectionIndexes(e);break;default:console.log("Unknown change type: "+a.changeType)}this.bindings.displayValues&&this.bindings.displayValues.update();this.bindings.contentValues&&this.bindings.contentValues.update();this.setSelectionIndexes(e)},observeContentValuesChange:function(a){var b,c=this.viewElement().options,d=c.length;switch(a.changeType){case coherent.ChangeType.setting:if(!a.newValue)break;for(b=0;b<d;++b)c[b].value=a.newValue[b];break;case coherent.ChangeType.insertion:case coherent.ChangeType.replacement:for(d=
0;d<a.indexes.length;++d)b=a.indexes[d],b=c[b],b.value=a.newValue[d];break;default:console.log("Unknown change type: "+a.changeType)}},observeDisplayValuesChange:function(a){var b,c=this.viewElement().options,d=c.length;switch(a.changeType){case coherent.ChangeType.setting:if(!a.newValue)break;for(b=0;b<d;++b)c[b].innerHTML=a.newValue[b];break;case coherent.ChangeType.insertion:case coherent.ChangeType.replacement:for(d=0;d<a.indexes.length;++d)b=a.indexes[d],b=c[b],b.innerHTML=a.newValue[d];break;
default:console.log("Unknown change type: "+a.changeType)}},observeSelectedValueChange:function(a){if(!this.bindings.content||this.bindings.content.value()){var b=this.viewElement(),c=b.options,d=c.length,a=a.newValue;b.disabled="undefined"===typeof a||coherent.Markers.MultipleValues===a||coherent.Markers.NoSelection===a;for(var b=[],a=a||"",e=0;e<d;++e)if(c[e].value==a){b=[e];break}this.setSelectionIndexes(b)}},observeNameChange:function(a){this.viewElement().name=a.newValue},observeErrorMessageChange:function(a){a.newValue?
(a=new coherent.Error({description:a.newValue}),this.presentError(a)):this.clearAllErrors()},onkeydown:function(){},presentError:function(a){this.validationError=a;Element.addClassName(this.viewElement(),coherent.Style.kInvalidValueClass);return this.base.apply(this,arguments)},clearAllErrors:function(){this.validationError=null;Element.removeClassName(this.viewElement(),coherent.Style.kInvalidValueClass);return this.base.apply(this,arguments)}});
coherent.TableHeaderView=Class.create(coherent.View,{__viewClassName__:"TableHeader",exposedBindings:["sortDescriptors"],init:function(){this.base();var a=this.viewElement();if(a.rows.length){var a=a.rows[0].cells,b=a.length,c;this.__selectedColumn=-1;this.__sortKeyIndex={};for(var d=0;d<b;++d)(c=a[d].getAttribute("sortKey"))&&(this.__sortKeyIndex[c]=d)}},selectedColumn:function(){return this.__selectedColumn},setSelectedColumn:function(a){var b=this.viewElement();if(b.rows.length&&this.__selectedColumn!==
a){var c=b.rows[0];-1!==this.__selectedColumn&&(b=c.cells[this.__selectedColumn],Element.updateClass(b,[],[coherent.Style.kSelectedClass,b.__ascending?coherent.Style.kAscendingClass:coherent.Style.kDescendingClass]));this.__selectedColumn=a;-1!==this.__selectedColumn&&(b=c.cells[this.__selectedColumn],Element.updateClass(b,[coherent.Style.kSelectedClass,b.__ascending?coherent.Style.kAscendingClass:coherent.Style.kDescendingClass],b.__ascending?coherent.Style.kDescendingClass:coherent.Style.kAscendingClass))}},
onclick:function(a){for(var b=this.viewElement(),c,a=a.target||a.srcElement;a&&!(c=a.getAttribute("sortKey"));){if(a.parentNode==b)return;a=a.parentNode}if(a){b=this.__sortKeyIndex[c];if(this.__selectedColumn==b){a.__ascending=a.__ascending?!1:!0;var b=coherent.Style.kAscendingClass,d=coherent.Style.kDescendingClass;a.__ascending?Element.updateClass(a,b,d):Element.updateClass(a,d,b)}else this.setSelectedColumn(b);c=new coherent.SortDescriptor(c,a.__ascending?!0:!1);this.bindings.sortDescriptors&&
this.bindings.sortDescriptors.setValue([c])}},observeSortDescriptorsChange:function(a){a=a.newValue;if(!a||!a.length||1<a.length)this.setSelectedColumn(-1);else{a=this.__sortKeyIndex[a[0].keyPath];if("undefined"===typeof a||null===a)a=-1;this.setSelectedColumn(a)}}});
coherent.ToggleButton=Class.create(coherent.FormControl,{exposedBindings:["checked","selection"],__viewClassName__:"ToggleButton",__tagSpec__:["input[type=checkbox]","input[type=radio]"],init:function(){this.base();var a=this.viewElement(),b=this.bindings;b.checked&&!b.checked.hasValue()&&b.checked.setValue(a.checked);b.selection&&(!b.selection.hasValue()&&a.checked&&a.value)&&b.selection.setValue(a.value)},onclick:function(){var a=this.viewElement(),b=a.checked;this.bindings.selection&&this.bindings.selection.setValue(a.value);
this.bindings.checked&&this.bindings.checked.setValue(b);this.sendAction()},observeValueChange:function(a){this.base(a);var b=this.viewElement(),a=a.newValue;b.value=a;this.bindings.selection&&(b.checked=this.bindings.selection.value()==a,this.bindings.checked&&this.bindings.checked.setValue(b.checked))},observeCheckedChange:function(a){var b=this.viewElement();b.checked=!!a.newValue;this.bindings.selection&&this.bindings.selection.setValue(b.value)},observeSelectionChange:function(a){var b=this.viewElement(),
a=a.newValue===b.value;b.checked=a;this.bindings.checked&&this.bindings.checked.setValue(a)}});
coherent.ViewController=Class.create(coherent.Responder,{view:null,title:null,automaticallySetupBindings:!1,constructor:function(a,b){this.base(b);this.__viewId="string"===typeof a?a:a&&1===a.nodeType?Element.assignId(a):a.id;var c=document.getElementById(this.__viewId);this.viewElement=function(){return c}},registerWithName:function(a){a&&(this.name=a,coherent.registerModelWithName(this,a))},nextResponder:function(){return this.view.superview()},structure:function(){return this.__structure__},viewElement:function(){return this.view.viewElement()},
addTrackingInfo:function(a,b){coherent.page.addTrackingInfo(a,b)},__postConstruct:function(){if(document.getElementById(this.__viewId))this.__init();else Event.onDomReady(this.__init.bind(this))},__init:function(){this.__initialising=!0;var a=document.getElementById(this.__viewId);if(!a)throw Error("Unable to locate node with ID: "+this.__viewId);var b=this.__context,c=coherent.dataModel;this.__context=coherent.dataModel=this;var d=this.structure()||{},e={},f,g;this.__copyParameters(this.__parameters||
{});var h=coherent.View.fromNode(a);for(g in d)if((f=d[g])&&"function"==typeof f&&(f=f.valueOf()).__factoryFn__)e[g]=f,f.call(this,g,!0);for(g in e)e[g].call(this,g,!1);h||(coherent.View.createViewsForNodeTree(a,null,this),h=coherent.View.createViewForNode(a));this.view=h;this.view.setNextResponder(this);coherent.dataModel=c;this.__context=b;this.setupBindings();this.init();this.updateBindings();this.createObservers();delete this.__initialising;delete this.viewElement},init:function(){}});
coherent.ViewController.__subclassCreated__=function(a){var b=a.prototype,a=a.superclass.prototype;b.__structure__!==a.__structure__&&Object.applyDefaults(b.__structure__,a.__structure__)};window.$P=function(){};var $=function(a){return"string"===typeof a||a instanceof String?document.getElementById(a):a};Package=function(){var a={};return function(b){if(!(b in a)){a[b]=!0;var c=window,b=b.split("."),d=b.length,e,f;for(e=0;e<d;++e)f=b[e],c[f]||(c[f]={}),c=c[f]}}}();coherent.strings["marker.image.placeholder"]="/rs/img/block1px.gif";coherent.strings["error.required_value"]="This field is required.";Package("apple");"undefined"==typeof AC&&(AC={});
AC.addEvent=function(a,b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)};AC.removeEvent=function(a,b,c){return a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,c)};AC.removeClassName=function(a,b){b=RegExp(b,"g");a.className=a.className.replace(b,"").replace(/ +/g," ").replace(/ +$/gm,"").replace(/^ +/gm,"")};AC.getPreviousSibling=function(a){for(;a=a.previousSibling;)if(1==a.nodeType)return a};
"undefined"==typeof AC.Detector&&(AC.Detector={_iOSVersion:null,iOSVersion:function(){null===this._iOSVersion&&(this._iOSVersion=navigator.userAgent.match(/applewebkit/i)&&(navigator.platform.match(/iphone/i)||navigator.platform.match(/ipod/i)||navigator.platform.match(/ipad/i))?parseFloat(navigator.userAgent.match(/os ([\d_]*)/i)[1].replace("_",".")):!1);return this._iOSVersion},_style:null,_prefixes:null,_preFixes:null,_css:null,isCSSAvailable:function(a){this._style||(this._style=document.createElement("browserdetect").style);
this._prefixes||(this._prefixes="-webkit- -moz- -o- -ms- -khtml- ".split(" "));this._preFixes||(this._preFixes="Webkit Moz O ms Khtml ".split(" "));this._css||(this._css={});a=a.replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z\d])([A-Z])/g,"$1-$2").replace(/^(\-*webkit|\-*moz|\-*o|\-*ms|\-*khtml)\-/,"").toLowerCase();switch(a){case "gradient":if(void 0!==this._css.gradient)return this._css.gradient;a="background-image:";this._style.cssText=(a+this._prefixes.join("gradient(linear,left top,right bottom,from(#9f9),to(white));"+
a)+this._prefixes.join("linear-gradient(left top,#9f9, white);"+a)).slice(0,-a.length);this._css.gradient=-1!==this._style.backgroundImage.indexOf("gradient");return this._css.gradient;case "inset-box-shadow":if(void 0!==this._css["inset-box-shadow"])return this._css["inset-box-shadow"];this._style.cssText=this._prefixes.join("box-shadow:#fff 0 1px 1px inset;");this._css["inset-box-shadow"]=-1!==this._style.cssText.indexOf("inset");return this._css["inset-box-shadow"];default:var b=a.split("-"),c=
b.length,d;if(0<b.length){a=b[0];for(d=1;d<c;d++)a+=b[d].substr(0,1).toUpperCase()+b[d].substr(1)}b=a.substr(0,1).toUpperCase()+a.substr(1);if(void 0!==this._css[a])return this._css[a];for(c=this._preFixes.length-1;0<=c;c--)if(void 0!==this._style[this._preFixes[c]+a]||void 0!==this._style[this._preFixes[c]+b])return this._css[a]=!0;return!1}}});
apple.GlobalNav=function(){var a=this;this.globalHeader=document.getElementById("apple-header");this.globalSearch=Element.query("#apple-header .search .wrapper input");if(this.globalHeader){if(navigator.userAgent.match(/applewebkit/i)){if(navigator.geolocation){if(navigator.platform.match(/ipad/i)||navigator.platform.match(/iphone/i)||navigator.platform.match(/ipod/i))this.globalHeader.className+=" ios"}else this.globalHeader.className+=" decelerate";AC.Detector.iOSVersion()&&3.2>=AC.Detector.iOSVersion()&&
(this.globalHeader.className+=" ios3");if(!AC.Detector.isCSSAvailable("inset-box-shadow")||navigator.userAgent.match(/chrome/i)&&navigator.userAgent.match(/windows/i))this.globalHeader.className+=" noinset"}this.decorateSearchInput();this.vml();this.decorateTabStates();this.cancelRevealTimeout=window.setTimeout(function(){a.cancelReveal()},3E3);AC.Detector.isCSSAvailable("transition-property")&&AC.Detector.isCSSAvailable("gradient")&&(!1===AC.Detector.iOSVersion()||3.2<=AC.Detector.iOSVersion())?
(this.globalHeader.className+=" enhanced",window.setTimeout(function(){a.reveal()},30)):this.show()}};
apple.GlobalNav.prototype.decorateSearchInput=function(){if(this.globalSearch){var a=this,b=!0,c=Element.query(".search-reset");Element.locateAncestor(this.globalSearch,function(a){return Element.hasClassName(a,"sitesearch-wrapper")});AC.addEvent(c,"mousedown",function(){b=!1;window.setTimeout(function(){b=!0},75)});AC.addEvent(this.globalSearch,"focus",function(){b&&window.setTimeout(function(){a.globalHeader.className+=" searchmode"},10)});AC.addEvent(this.globalSearch,"blur",function(){b?window.setTimeout(function(){AC.removeClassName(a.globalHeader,
"searchmode")},10):b=!0})}};
apple.GlobalNav.prototype.vml=function(){var a,b,c,d;!AC.Detector.isCSSAvailable("border-radius")&&(document.namespaces&&this.globalHeader)&&(document.namespaces.add("v","urn:schemas-microsoft-com:vml"),a=document.createDocumentFragment(),b=document.createElement("v:roundrect"),b.setAttribute("id","globalheader-roundrect"),b.setAttribute("stroked",!0),b.setAttribute("strokeColor","#737373"),b.setAttribute("arcSize",".1"),a.appendChild(b),c=this.globalHeader.currentStyle.backgroundImage,this.globalHeader.style.backgroundImage=
"none",c=c.replace(/url\(["']*([^"']*)["']*\)/,"$1"),d=document.createElement("v:fill"),d.setAttribute("id","globalheader-fill"),d.setAttribute("type","tile"),d.setAttribute("src",c),b.appendChild(d),b=document.createElement("v:roundrect"),b.setAttribute("id","globalheader-shadow"),b.setAttribute("stroked",!1),b.setAttribute("fillColor","#999"),b.setAttribute("arcSize",".1"),a.appendChild(b),this.globalHeader.appendChild(a))};
apple.GlobalNav.prototype.getPreviousNavItem=function(a){for(;"li"!==a.tagName.toLowerCase();)a=a.parentNode;a=AC.getPreviousSibling(a);if(!a||"li"!==a.tagName.toLowerCase())return!1;a=a.getElementsByTagName("a");return!a[0]?!1:a[0]};
apple.GlobalNav.prototype.decorateTabStates=function(){this.globalNavItems=Element.queryAll(this.globalHeader,"ul.links a");var a=this,b=this.globalHeader.className.replace(/ .*/,""),c;for(c=this.globalNavItems.length-1;0<=c;c--)this.globalNavItems[c].href.match(b)&&(this.currentTab=this.globalNavItems[c]),AC.addEvent(this.globalNavItems[c],"mousedown",function(b){b=b.target?b.target:b.srcElement;if((b=a.getPreviousNavItem(b))&&b!==a.currentTab)b.className+=" before"}),AC.addEvent(this.globalNavItems[c],
"mouseout",function(b){b=b.target?b.target:b.srcElement;(b=a.getPreviousNavItem(b))&&b!==a.currentTab&&AC.removeClassName(b,"before")});this.currentTab&&(this.currentTab=this.getPreviousNavItem(this.currentTab),this.currentTab.className+=" before")};
apple.GlobalNav.prototype.reveal=function(){if(!this.revealCanceled){var a=this;AC.Detector.isCSSAvailable("animation-name")&&!document.referrer.match(/^\w*:\/\/([^\.]*\.)+apple\.com/)?(this.globalHeader.className+=" outside",this.globalHeader.addEventListener("webkitAnimationEnd",function(){a.revealed()},!1)):window.setTimeout(function(){a.revealed()},300)}};
apple.GlobalNav.prototype.revealed=function(a){!this.revealCanceled&&(!a||"number"==typeof a||a.target==this.globalHeader&&a.animationName.match(/reveal/i))&&this.show()};apple.GlobalNav.prototype.show=function(){var a=this;window.clearTimeout(this.cancelRevealTimeout);this.globalHeader.style.visibility="visible";window.setTimeout(function(){a.loaded()},100)};apple.GlobalNav.prototype.loaded=function(){this.globalHeader.className+=" globalheader-loaded"};
apple.GlobalNav.prototype.cancelReveal=function(){this.revealCanceled=!0;this.show()};Package("apple.util");Math.clamp=function(a,b,c){return Math.min(Math.max(b,a),c)};apple.util.aliasMethodChain=function(a,b,c,d){a[b+"Without"+c.charAt(0).toUpperCase()+c.substring(1)]=a[b];a[b]=d};apple.util.elementSupportsAttribute=function(a,b){var c=document.createElement(a);return b in c?!0:!1};
apple.util.makeSubclass=function(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.superclass=b;b.prototype.constructor!=b&&(b.prototype.constructor=b);a.prototype.base=function(a){var c=this,f=b.prototype[a];return"function"!=typeof f?f:function(){return f.apply(c,arguments)}}};apple.util.TEMPLATE_REGEX=/\$\{(\w+)\}/g;
apple.util.expandTemplate=function(a,b,c){return a.replace(this.TEMPLATE_REGEX,function(a,e){var f=b[e];return null===f||"undefined"===typeof f?c:f})};apple.util.addOverflowEllipsis=function(a,b){var c=Element.getStyle(a,"display"),d=a.textContent||a.innerText,e=0,f=0,g=d.length,h=d;a.style.display="inline";if(!(a.offsetWidth<=b)){for(;a.offsetWidth!=b&&e<g;)f=Math.floor(e+(g-e)/2),h=d.substr(0,f)+"&hellip;",a.innerHTML=h,a.offsetWidth<b?e=f+1:g=f;a.innerHTML=h}Element.setStyle(a,"display",c)};
apple.util.assignId=Element.assignId;apple.util.applyDefaults=Object.applyDefaults;apple.util.merge=Object.merge;
Object.extend(Element,{hide:function(a){if("undefined"==typeof a.cssDisplayCache){var b=a.style.display;"none"!=b&&(a.cssDisplayCache=b)}a.style.display="none"},show:function(a){a.style.display=a.cssDisplayCache||"";a.cssDisplayCache=void 0},getDimensions:function(a){var a=$(a),b=Element.getStyle(a,"display");if(b&&"none"!=b)return{left:a.offsetLeft,top:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight};var b=a.style,c=b.visibility,d=b.position,e=b.display;b.visibility="hidden";b.position="absolute";
b.display="block";a={width:a.offsetWidth,height:a.offsetHeight,left:a.offsetLeft,top:a.offsetTop};b.display=e;b.position=d;b.visibility=c;return a},getMarginBox:function(a){var b=Element.getStyles(a,["marginTop","marginBottom","marginRight","marginLeft"]),c;for(c in b)b[c]=parseInt(b[c],10)||0;return{width:a.offsetWidth+(b.marginLeft+b.marginRight),height:a.offsetHeight+(b.marginTop+b.marginBottom)}},setMarginBox:function(a,b){var c=Element.getStyles(a,"marginTop marginBottom marginRight marginLeft paddingTop paddingBottom paddingRight paddingLeft borderTopWidth borderBottomWidth borderRightWidth borderLeftWidth".split(" ")),
d;for(d in c)c[d]=parseInt(c[d],10)||0;d=c.marginTop+c.marginBottom+c.borderTopWidth+c.borderBottomWidth+c.paddingTop+c.paddingBottom;a.style.width=b.width-(c.marginLeft+c.marginRight+c.borderLeftWidth+c.borderRightWidth+c.paddingLeft+c.paddingRight)+"px";a.style.height=b.height-d+"px"},makeClipping:function(a){a=$(a);if(!a)return a;a._originalOverflow=a.style.overflow||a.style.overflowY||a.style.overflowX;a.style.overflow="hidden";return a},undoClipping:function(a){a=$(a);if(!a||!("_originalOverflow"in
a))return a;a.style.overflow=a._originalOverflow||"";a._originalOverflow=null;return a},makePositioned:function(a,b){a=$(a);if(!a)return a;var b=b||"relative",c=Element.getStyle(a,"position");if("relative"==c||"absolute"==c||b==c)return a;a._originalPosition=c;a.style.position=b||"relative";window.opera&&(a.style.top=a.style.left="0");return a},undoPositioned:function(a){a=$(a);if(!a||!("_originalPosition"in a))return a;a.style.position=a._originalPosition||"";a._originalPosition=null;return a},getPositionedOffset:function(a){var a=
$(a),b=0,c=0;do if(b+=a.offsetTop||0,c+=a.offsetLeft||0,a=a.offsetParent){if("BODY"==a.tagName)break;var d=Element.getStyle(a,"position");if("relative"==d||"absolute"==d)break}while(a);return{left:c,top:b}},makeAbsolute:function(a){a=$(a);if("absolute"!=a.style.position){var b=Element.getPositionedOffset(a),c=b.top-parseFloat(Element.getStyle(a,"margin-top")||0),b=b.left-parseFloat(Element.getStyle(a,"margin-left")||0),d=a.clientWidth-parseFloat(Element.getStyle(a,"padding-left")||0)-parseFloat(Element.getStyle(a,
"padding-right")||0),e=a.clientHeight-parseFloat(Element.getStyle(a,"padding-top")||0)-parseFloat(Element.getStyle(a,"padding-bottom")||0);a._originalLeft=a.style.left;a._originalTop=a.style.top;a._originalWidth=a.style.width;a._originalHeight=a.style.height;a._originalPosition=a.style.position;a.style.position="absolute";a.style.top=c+"px";a.style.left=b+"px";a.style.width=d+"px";a.style.height=e+"px"}},undoMakeAbsolute:function(a){a=$(a);"absolute"==a.style.position&&(a.style.position=a._originalPosition,
a.style.left=a._originalLeft,a.style.top=a._originalTop,a.style.width=a._originalWidth,a.style.height=a._originalHeight)},getElementsByClassName:function(a,b){return Element.queryAll(b,"."+a)},getOpacity:function(a){return Element.getStyles(a,"opacity")},setOpacity:function(a,b){a=$(a);a.style.opacity=1==b||""===b?"":1E-5>b?0:b;return a},getPadding:function(a){a=document.defaultView.getComputedStyle(a,null);return{left:parseFloat(a.paddingLeft)||0,top:parseFloat(a.paddingTop)||0,right:parseFloat(a.paddingRight)||
0,bottom:parseFloat(a.paddingBottom)||0}},setStyles:function(a,b){for(var c in b)"opacity"!=c?a.style[c]=b[c]:Element.setOpacity(a,b[c])},setStyle:function(a,b,c){var d={};d[b]=c;Element.setStyles(a,d)}});var useOpacity="undefined"!=typeof document.createElement("div").style.opacity;
useOpacity||Object.extend(Element,{setOpacity:function(a,b){var a=$(a),c=Element.getStyle(a,"filter"),d=a.style;if(1==b||""===b)return d.filter=c.replace(/alpha\([^\)]*\)/gi,""),a;1E-5>b&&(b=0);d.filter=c.replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+100*b+")";return a}});
coherent.Browser.IE&&Object.extend(Element,{getPadding:function(a){a=a.currentStyle;return{left:parseFloat(a.paddingLeft)||0,top:parseFloat(a.paddingTop)||0,right:parseFloat(a.paddingRight)||0,bottom:parseFloat(a.paddingBottom)||0}}});
Object.extend(Event,{sendMouseEvent:function(){return document.createEvent?function(a,b,c,d){var e=document.createEvent("MouseEvents");e.initMouseEvent?e.initMouseEvent(b,c,d,window,0,0,0,0,0,!1,!1,!1,!1,0,null):(e=document.createEvent("UIEvents"),e.initEvent(b,c,d),e.view=window,e.detail=0,e.screenX=0,e.screenY=0,e.clientX=0,e.clientY=0,e.ctrlKey=!1,e.altKey=!1,e.metaKey=!1,e.shiftKey=!1,e.button=0,e.relatedTarget=null);return a.dispatchEvent(e)}:function(a,b,c,d){var e=document.createEventObject("MouseEvents");
e.bubbles=c;e.cancelable=d;e.view=window;e.detail=0;e.screenX=0;e.screenY=0;e.clientX=0;e.clientY=0;e.ctrlKey=!1;e.altKey=!1;e.metaKey=!1;e.shiftKey=!1;e.button=1;return a.fireEvent("on"+b,e)}}(),isNumpadNumKey:function(a){return 96<=a&&111>=a},isAlphaNumKey:function(a){if(!this._reverseKeys){var b={},c=Event.KEYS,d;for(d in c)b[c[d]]=d;this._reverseKeys=b}return this.isNumpadNumKey(a)||!this._reverseKeys[a]},mousePosition:function(a){var b={x:0,y:0};if(a.pageX||a.pageY)b.x=a.pageX,b.y=a.pageY;else{var c=
document.documentElement||document.body;b.x=a.clientX+c.scrollLeft-c.clientLeft;b.y=a.clientY+c.scrollTop-c.clientTop}return b},isMouseOverElement:function(a,b){var c=Event.mousePosition(a),d=Element.getRect(b),e=d.top,f=e+b.offsetHeight,d=d.left,g=d+b.offsetWidth;return c.x>=d&&c.x<=g&&c.y>=e&&c.y<=f},onUnload:function(a){arguments.callee.__fn||(arguments.callee.__fn=function(){for(var a=arguments.callee.__handlers;a.length;)a.pop()();delete arguments.callee.__handlers},Event.observe(window,"unload",
arguments.callee.__fn),arguments.callee.__fn.__handlers=[]);arguments.callee.__fn.__handlers.push(a)},fixEvent:function(a){!a&&window.event&&(a=window.event);if(coherent.Browser.IE){a.target||(a.target=a.srcElement);a.currentTarget||(a.currentTarget=a.srcElement);a.layerX||(a.layerX=a.offsetX);a.layerY||(a.layerY=a.offsetY);var b=a.srcElement&&a.srcElement.ownerDocument?a.srcElement.ownerDocument:document,b="BackCompat"==b.compatMode?b.body:b.documentElement;a.pageX||(a.pageX=a.clientX+(b.scrollLeft||
0));a.pageY||(a.pageY=a.clientY+(b.scrollTop||0));"mouseover"==a.type&&(a.relatedTarget=a.fromElement);"mouseout"==a.type&&(a.relatedTarget=a.toElement)}return a},KEYS:{KEY_BACKSPACE:8,KEY_TAB:9,KEY_CLEAR:12,KEY_ENTER:13,KEY_SHIFT:16,KEY_CTRL:17,KEY_ALT:18,KEY_PAUSE:19,KEY_CAPS_LOCK:20,KEY_ESCAPE:27,KEY_SPACE:32,KEY_PAGE_UP:33,KEY_PAGE_DOWN:34,KEY_END:35,KEY_HOME:36,KEY_LEFT_ARROW:37,KEY_UP_ARROW:38,KEY_RIGHT_ARROW:39,KEY_DOWN_ARROW:40,KEY_INSERT:45,KEY_DELETE:46,KEY_HELP:47,KEY_LEFT_WINDOW:91,KEY_RIGHT_WINDOW:92,
KEY_SELECT:93,KEY_NUMPAD_0:96,KEY_NUMPAD_1:97,KEY_NUMPAD_2:98,KEY_NUMPAD_3:99,KEY_NUMPAD_4:100,KEY_NUMPAD_5:101,KEY_NUMPAD_6:102,KEY_NUMPAD_7:103,KEY_NUMPAD_8:104,KEY_NUMPAD_9:105,KEY_NUMPAD_MULTIPLY:106,KEY_NUMPAD_PLUS:107,KEY_NUMPAD_ENTER:108,KEY_NUMPAD_MINUS:109,KEY_NUMPAD_PERIOD:110,KEY_NUMPAD_DIVIDE:111,KEY_F1:112,KEY_F2:113,KEY_F3:114,KEY_F4:115,KEY_F5:116,KEY_F6:117,KEY_F7:118,KEY_F8:119,KEY_F9:120,KEY_F10:121,KEY_F11:122,KEY_F12:123,KEY_F13:124,KEY_F14:125,KEY_F15:126,KEY_NUM_LOCK:144,KEY_SCROLL_LOCK:145}});
window.JSONP={get:function(a,b){if(!a)return{};var c=((new Date).getTime()+Math.floor(1E5*Math.random())).toString(32),d=new coherent.Deferred,e=b.callbackParamName||"callback",f="apple_jsonp_callback_"+c,c=b.params||{},g;if(b.enableCache){g="apple_jsonp_callback";var h=c.query;window.queryParamsToFunctionNameMap=window.queryParamsToFunctionNameMap||{};window.queryParamsToFunctionNameMap[h]=f;window[g]||(window[g]=function(a){h=a.body.query;var b=window.queryParamsToFunctionNameMap[h];if(b&&window[b])window[b](a)})}else g=
f;c[e]=g;var e=a+(-1==a.indexOf("?")?"?":"&")+Object.toQueryString(c),i=document.createElement("script");i.type="text/javascript";i.src=e;window[f]=function(a){try{d.callback(a)}catch(b){}i.parentNode.removeChild(i);try{delete window[f]}catch(c){}};document.getElementsByTagName("HEAD")[0].appendChild(i);return d}};Package("apple");
window.JSONRPC=function(){function a(a,e,f,g){var g=Object.applyDefaults(g,b),h="JSONP"===g.protocol?JSONP.get(e,g):XHR.request(a,e,f,g);h.addCallback(function(a){var b;var c=g.metrics,d;a.head&&a.head.data&&a.head.data.microEvent?d=a.head.data.microEvent:a.body&&a.body.microEvent&&(d=a.body.microEvent,delete a.body.microEvent);var e;a.head&&a.head.data&&a.head.data.metrics?e=a.head.data.metrics:a.body&&a.body.metrics&&(e=a.body.metrics,delete a.body.metrics);if(d||e||c)e=Object.extend(c||{},e),apple.metrics.fireEventCollection({microEvent:d,
metrics:e});if(a){c=!1;switch(parseInt(a.head.status,10)){case 301:case 302:case 303:case 304:case 305:case 306:case 307:c=!0}if(c){var c=a.head.data,f=c.url,h=c.method,q=c.args;apple.metrics.onEventCompletion(function(){if("post"===h){var a=document.createElement("form");a.action=f;a.method="post";var b,c,d={},e=function(a,b,c){var d=document.createElement("input");d.name=b;d.type="hidden";a.appendChild(d);d.value=c};for(b in q)c=q[b],q[b]!==d[b]&&(c instanceof Array?c.forEach(function(c){e(a,b,
c)}):e(a,b,c));a.style.position="absolute";a.style.visibility="hidden";a.style.height="0px";a.style.width="0px";document.body.appendChild(a);a.submit()}else if(c=f,d=q,c){if(d=Object.toQueryString(d))c=c.indexOf("?")?c+"&":c+"?",c+=d;window.location.href=c}});c=!0}else c=!1}else c=!1;c?(b=Error("Response redirected"),b.redirect=!0):(a?(c=parseInt(a.head.status,10),c=400<=c&&600>c?!0:!1):c=!0,c&&(b=Error("Response returned errors")));return b?(b.response=a,b):a.body});c.forEach(function(a){h.addCallback(a)},
this);return h}var b={sync:!1,responseContentType:"application/json"},c=[];a.get=function(b,c,f){return a("GET",b,c,f)};a.post=function(b,c,f){return a("POST",b,c,f)};a.__registerGlobalCallback=function(a){c.push(a)};return a}();
window.DeferredJSON=Class.create(coherent.KVO,{constructor:function(a){Object.extend(this,a)},__keysToIgnore:Set("actionKey","_url","url","loading","clearOldKeys"),__factory__:function(a){function b(){}var c=Array.from(arguments),d=this;return function(){a&&["extractContent","extractUpdates","setCallback"].forEach(function(b){b in a&&"string"===typeof a[b]&&(a[b]=this[a[b]].bind(this))},this);b.prototype=d.prototype;var e=new b;d.prototype.constructor.apply(e,c);return e}},url:function(){return this._url},
setUrl:function(a){return this._url=a},refresh:function(){this.setValueForKey(!0,"loading");var a=this.url();if(!a)return null;a=JSONRPC.get(a,this.extraArgs,{sync:this.sync});a.addMethods(this.set.bind(this),this.failure.bind(this));return a},performAction:function(a,b){var c=Object.extend({},this.extraArgs),c=Object.extend(c,b);if(!this.actionKey)throw Error("actionKey value not set.");c[this.actionKey]=a;return this.sendRequest(this.url(),c)},sendRequest:function(a,b,c){c=c||{method:"post"};this.setValueForKey(!0,
"loading");a=JSONRPC[c.method](a,b);a.addMethods(this.set.bind(this),this.failure.bind(this));return a},failure:function(a){a.redirect||this.setValueForKey(!1,"loading");return a},hasContent:function(){return Set.toArray(this.keys()).length},keys:function(){return this.__contentKeys||new Set},set:function(a){function b(a,b){var c=b.mutableKeys(),e,f;a&&this.mutableKeys().forEach(function(a){-1===c.indexOf(a)&&this[a]&&(b.setValueForKey(null,a),c.push(a))},this);c.forEach(function(a){a&&(Set[a in b&&
null!==b[a]?"add":"remove"](this.__contentKeys,a),this.willChangeValueForKey(a),this[a]=b[a])},this);c.forEach(function(a){a&&this.didChangeValueForKey(a)},this);if(d&&d.data)for(e in d.data)f=d.data[e],"object"==typeof f&&null!==f&&(f=coherent.KVO.adaptTree(f)),this.setValueForKeyPath(f,e);this.setCallback&&this.setCallback(b);return b}this.__contentKeys=this.__contentKeys||new Set;a.url&&this.setUrl(a.url);if(!a.content&&!a.update&&!a.replace)return this.refresh();this.setValueForKey(!1,"loading");
var c=a.content||{},d=a.update,e=a.content?!0:!1;if(a.replace)for(var f in a.replace)c[f]=a.replace[f];c.addObserverForKeyPath||(c=coherent.KVO.adaptTree(c));d&&this.extractUpdates&&(d=this.extractUpdates(d));this.extractContent&&(c=this.extractContent(c));return!1===c?!1:c instanceof coherent.Deferred?(c.addCallback(b.bind(this,e)),c):b.call(this,e,c)}});$P(window.DeferredJSON.prototype,"set","Content");Package("apple.behavior.metrics");
apple.behavior.metrics.ClickMap=function(a){this.anchorClickHandler=function(b){(b=Element.locateAncestor(b.target||b.srcElement,function(a){return"A"===a.tagName},a))&&apple.behavior.metrics.storePageEventData(b)};this.formSubmitHandler=function(a){apple.behavior.metrics.storePageEventData(a.target||a.srcElement)}};
apple.behavior.metrics.storePageEventData=function(a){var b=metricsStorage,c,d,e;e=a.pathname||a.action;if(!(a.hostname&&a.hostname!==document.location.hostname)&&(c=a.getAttribute("data-evar1"),d=a.getAttribute("data-evar30"),a=a.getAttribute("data-prop42"),c||a))e=apple.metrics.getStorageKey(e),c={timestamp:(new Date).getTime(),evar1:c,evar30:d,prop42:a},c=apple.data.json.stringify(c),b.set(e,c),b.set(apple.metrics.Metrics.CONSTANTS.pageLoadDataKeyLatestKeyName,e)};
apple.behavior.metrics.cleanupStaleStorage=function(){for(var a=metricsStorage,b=(new Date).getTime(),c=apple.metrics.transformKey(apple.metrics.Metrics.CONSTANTS.pageLoadDataKeyPrefix),d,e,f=a.length()-1;0<=f;f--)if((d=a.getKey(f))&&-1!==d.indexOf(c))e=(e=a.get(d))?apple.data.json.parse(e):{},e=e.timestamp||b,864E5<=b-e&&a.remove(d)};
Event.onLoad(function(){if(apple.metrics.evarDataNodesEnabled){var a=document.body,b=new apple.behavior.metrics.ClickMap(a);Event.observe(a,"click",b.anchorClickHandler.bind(b));for(var a=document.forms,c=0;c<a.length;c++){var d=a[c];d._submit=d.submit;d.submit=function(a){apple.behavior.metrics.storePageEventData(a?a.target||a.srcElement:this);this._submit()};Event.observe(d,"submit",b.formSubmitHandler.bind(b))}apple.behavior.metrics.cleanupStaleStorage.delay(2E3)}});Package("apple.behavior");
apple.behavior.Striper=function(){function a(a){for(var a=a.getElementsByTagName("tbody"),d=0;d<a.length;d++)for(var e=a[d].getElementsByTagName("tr"),f=0;f<e.length;f++){for(var g=e[f].className.split(" "),h=0;h<b.length;h++)-1!=g.indexOf(b[h])&&g.splice(g.indexOf(b[h]),1);g.push(b[f%b.length]);e[f].className=g.join(" ")}}var b=["odd","even"];return function(b){var d,e;d="undefined"===typeof b?document.getElementsByTagName("table"):"string"===typeof b?[document.getElementById(b)]:[b];for(e=0;e<Math.min(5,
d.length);e++)a(d[e]);for(b=10;e<d.length;e++)window.setTimeout(function(){var b=d[e];return function(){a(b)}}(),b),b+=10}}();Event.onDomReady(apple.behavior.Striper);Package("apple.behavior");
apple.behavior.TextFieldPlaceholder=function(){function a(a){var i;a:{i=a.viewElement();var j=Element.query('label[for="'+i.id+'"].'+f);if(!j&&a.nullPlaceholder&&a.nullPlaceholder.toString())j=document.createElement("label"),j.setAttribute("for",i.id),j.htmlFor=i.id,j.innerHTML="<span>"+a.nullPlaceholder+"</span>",j.className=f;else if(j)try{a.nullPlaceholder=j.getElementsByTagName("span")[0]?j.getElementsByTagName("span")[0].firstChild.nodeValue:j.innerHTML}catch(l){i=!1;break a}else{i=!1;break a}a.label=
j;var k=i.parentNode;"SPAN"!=k.nodeName.toUpperCase()&&(k=document.createElement("span"),i.parentNode.replaceChild(k,i));h.test(k.className)||Element.addClassName(k,g);i.parentNode!=k&&k.appendChild(i);k.insertBefore(j,i);i=!0}i&&(a.onkeydown=b,a.becomeFirstResponder=c,a.setMarkerValue=d,a.clearMarkerValue=e,Event.observe(a.viewElement(),"input",a.clearMarkerValue.bind(a)),Event.observe(a.viewElement(),"paste",a.clearMarkerValue.bind(a)),Event.onDomReady(function(){a.viewElement().value&&!a.validationError&&
a.clearMarkerValue()}))}function b(a){l.call(this,a);a=a.keyCode;(Event.isAlphaNumKey(a)||32==a||8==a||46==a)&&this.clearMarkerValue()}function c(){Element.addClassName(this.label,"focus");return k.call(this)}function d(a){"nullPlaceholder"==a&&(this.viewElement().value="",this.label.style.display="",Element.removeClassName(this.label,"hidden"),Element.removeClassName(this.label,"focus"))}function e(){var a=this.viewElement().parentNode;Element.removeClassName(a,coherent.Style.kInvalidValueClass);
Element.addClassName(this.label,"hidden")}if(!coherent||!coherent.TextField)return null;var f="placeholder",g="field-with-placeholder",h=Element.regexForClassName(g),i=coherent.TextField.prototype,j=i.init,l=i.onkeydown,k=i.becomeFirstResponder,n=i.presentError,m=i.endEditing,r=i.onkeyup;coherent.TextField.prototype.init=function(){j.call(this);a(this);this.viewElement().value&&this.clearMarkerValue()};coherent.TextField.prototype.presentError=function(a){var b=this.viewElement().parentNode;Element.addClassName(b,
coherent.Style.kInvalidValueClass);return n.call(this,a)};coherent.TextField.prototype.onkeyup=function(a){r.call(this,a);this.updateTimer&&Element.addClassName(this.viewElement().parentNode,coherent.Style.kEditingClass)};coherent.TextField.prototype.endEditing=function(){Element.removeClassName(this.viewElement().parentNode,coherent.Style.kEditingClass);m.call(this)};return function(b){b instanceof coherent.TextField&&(b.markerValue&&b.clearMarkerValue(),a(b))}}();
"undefined"===typeof window.LivePerson&&(window.LivePerson={});
Object.extend(window.LivePerson,{chatButtonId:"lpChatButton",inviteId:"inviteBadge",chatInvitation:"Chat now!",animator:null,init:function(){var a=$("aos_header");a&&(this.isPancakeMode=Element.hasClassName(a,"collapsed")||Element.hasClassName(a,"compact-header"))},createInvitation:function(){var a=$(this.chatButtonId);if(!a)return null;var b=$(this.inviteId);if(null!==b)return null;b=document.createElement("button");b.id=this.inviteId;b.appendChild(document.createTextNode(this.chatInvitation));a.parentNode.insertBefore(b,
a);this.isPancakeMode?(a=Element.getPositionedOffset(a),b.style.left=a.left+"px",b.style.top=a.top+"px"):(this.originalWidth=Element.getDimensions(b).width,b.style.width="0");b.onclick=this.inviteButtonClicked.bindAsEventListener(this);return b},showInviteButton:function(){this.animator.play(this.getInviteAnimation(),this.onShowInviteComplete.bind(this))},hideInviteButton:function(){this.animator.reverse(this.onHideInviteComplete.bind(this))},removeInviteButton:function(){var a=$(this.inviteId);a.parentNode.removeChild(a)},
onShowInviteComplete:function(){window.setTimeout(this.hideInviteButton.bind(this),2500)},onHideInviteComplete:function(){!0===this.inviteTimedOut?this.removeInviteButton():window.setTimeout(this.showInviteButton.bind(this),2500)},getInviteAnimation:function(){var a=apple.fx.easeOutSine,b=this.originalWidth,c=$(this.inviteId);return function(d){d=a(d);c.style.width=d*b+"px"}},oninvite:function(){this.createInvitation()&&!this.isPancakeMode&&(this.animator=new apple.fx.Animator({duration:250}),this.animator.play(this.getInviteAnimation(),
this.onShowInviteComplete.bind(this)))},ontimeout:function(){this.isPancakeMode?this.removeInviteButton():this.inviteTimedOut=!0},inviteButtonClicked:function(){this.invitationAccepted()}});Event.onDomReady(window.LivePerson.init.bind(window.LivePerson));
(function(){window.apple||(window.apple={});window.apple.data||(window.apple.data={});window.apple.data.xml||(window.apple.data.xml={});var a=function(a,d){var e,f=[],g;if(a.ownerDocument&&a.ownerDocument.evaluate){e=a.ownerDocument.evaluate(d,a,null,XPathResult.ANY_TYPE,null);for(g=e.iterateNext();g;)f.push(g),g=e.iterateNext()}else if(a.ownerDocument&&"selectNodes"in a.ownerDocument)f=a.selectNodes(d);else throw b("UserAgent does not support xPath evaluation on this node");return f},b=function(){return{name:"AppleDataXmlError",
message:"An error occurred"}};apple.data.xml.FIRST="first";apple.data.xml.ALL="all";apple.data.xml.find=function(c,d,e){var f=d||c,d=e||d;switch(c){case "first":if(f.ownerDocument&&f.ownerDocument.evaluate)c=f.ownerDocument.evaluate(d,f,null,XPathResult.ANY_TYPE,null),c=c.iterateNext();else if(f.ownerDocument&&"selectNodes"in f.ownerDocument)c=f.selectSingleNode(d);else throw b("UserAgent does not support xPath evaluation on this node");break;case "all":c=a(f,d);break;default:c=a(f,d)}return c};apple.data.xml.error=
b})();Package("apple.fx");apple.fx.Animator=function(a){this._direction=1;this.t=0;this.config=Object.applyDefaults(a,arguments.callee.DEFAULTS)};apple.fx.Animator.DEFAULTS={actions:[],duration:250,frameRate:60,callback:null};apple.fx.Animator.prototype.setDuration=function(a){this.config.duration=a};apple.fx.Animator.prototype.finishNow=function(){this.config.actions.forEach(function(a){a(1);"finish"in a&&a.finish(1)})};
apple.fx.Animator.prototype.stop=function(){this._timer&&window.clearTimeout(this._timer);this._timer=0};apple.fx.Animator.prototype.play=function(a,b){this.stop();"function"==typeof a&&(a=[a]);a&&this.config.actions!=a&&(0<this.t&&1>this.t&&this.finishNow(),this.config.actions=a.filter(function(a){return null!==a&&"undefined"!=typeof a}),this.t=0);1==this.t&&(this.t=0);this._direction=1;this._run(this.config.actions,this._direction,this.t,b||this.config.callback)};
apple.fx.Animator.prototype.reverse=function(a){this.stop();this._direction=0<this._direction?-1:1;this._run(this.config.actions,this._direction,this.t,a||this.config.callback)};
apple.fx.Animator.prototype._run=function(a,b,c,d){function e(){for(l=g._timer=0;l<j;++l)"finish"in a[l]&&a[l].finish(g.t);d&&d(g.t)}function f(){var b=(new Date).getTime()-h;b>i&&(b=i);g.t=1-b/i;for(l=0;l<j;++l)a[l](g.t);b==i?e():g._timer=window.setTimeout(n,k)}var g=this,h,i=this.config.duration,j=a.length,l,k=Math.round(1E3/this.config.frameRate);for(l=0;l<j;++l)"setup"in a[l]&&a[l].setup();var n=function(){var b=(new Date).getTime()-h;b>i&&(b=i);g.t=Math.round(1E3*(b/i))/1E3;for(l=0;l<j;++l)a[l](g.t);
b==i?e():g._timer=window.setTimeout(n,k)};0>b&&(n=f,c=1-c);this._timer=window.setTimeout(function(){h=(new Date).getTime()-i*c;n()},0)};Package("apple.fx");apple.fx.ContentSwapper=function(a){a=Object.applyDefaults(a,arguments.callee.DEFAULTS);this.base("constructor")(a)};apple.util.makeSubclass(apple.fx.ContentSwapper,apple.fx.Animator);apple.fx.ContentSwapper.DEFAULTS={duration:1E3,transition:"crossfade"};
Class.extend(apple.fx.ContentSwapper,{fixElementDimensions:function(a){function b(a){for(a=a.lastChild;a&&1!==a.nodeType;)a=a.previousSibling;return a}var c=$(this._measureDiv);c||(c=document.createElement("div"),this._measureDiv=Element.assignId(c),c.style.position="relative",$(this.config.id).appendChild(c));a._originalWidth=a.style.width;a._originalHeight=a.style.height;if(!a.style.width||!a.style.height){c=a.style.display;a.style.display="block";for(var d=Element.getStyles(a,"width height paddingTop paddingRight paddingBottom paddingLeft".split(" ")),
e=0,f,g=b(a);g;)f=parseFloat(Element.getStyles(g,"marginBottom")||0,10),0>f&&(e+=f),g=b(g);f=parseInt(d.width||0,10)-parseFloat(d.paddingLeft||0,10)-parseFloat(d.paddingRight||0,10);d=parseInt(d.height||0,10)-parseFloat(d.paddingTop||0,10)-parseFloat(d.paddingBottom||0,10)+e;a.style.width=f+"px";a.style.height=d+"px";a.style.display=c}},undoFixElementDimensions:function(a){a.style.width=a._originalWidth||"";a.style.height=a._originalHeight||""},swap:function(a,b,c,d,e){b=$(b);c=$(c);this.fixElementDimensions(b);
this.fixElementDimensions(c);a=[].concat(this._setup(a,b,c));e&&(a=a.concat(e));var f=$(this.config.id);Element.makeClipping(f);Element.makePositioned(f);Element.makePositioned(b,"absolute");Element.makePositioned(c,"absolute");this.play(a,function(){Element.undoPositioned(c);Element.undoPositioned(b);Element.undoClipping(f);Element.undoPositioned(f);this.undoFixElementDimensions(c);this.undoFixElementDimensions(b);f.style.height="";f.style.width="";d&&d()}.bind(this))},_setup:function(a,b,c){var d=
$(this.config.id),e=d.offsetHeight-parseFloat(Element.getStyle(d,"padding-top")||0)-parseFloat(Element.getStyle(d,"padding-bottom")||0),f=apple.fx,a=a||"crossfade";d.style.height=e+"px";e=[];switch(a){case "fadein":e.push(new f.FadeIn(apple.fx.linearTween,c));e.push(new f.Hide(null,b));break;case "swapfade":b&&c?e.push(new f.FadeOutIn(apple.fx.linearTween,b,c)):b?e.push(new f.FadeOut(apple.fx.linearTween,b)):c&&e.push(new f.FadeIn(apple.fx.linearTween,c));break;case "left":case "right":e.push(new f.Pan(apple.fx.easeInOutSine,
b,c,"left"==a?-1:1));break;case "up":case "down":e.push(new f.Scroll(apple.fx.easeInOutSine,b,c,"up"==a?-1:1));break;default:b&&c?e.push(new f.CrossFade2(apple.fx.linearTween,b,c)):b?e.push(new f.FadeOut(apple.fx.linearTween,b)):c&&e.push(new f.FadeIn(apple.fx.linearTween,c))}b&&c&&(b.style.zIndex=1,c.style.zIndex=2,e.push(new f.Resize(apple.fx.easeInOutSine,d,Element.getDimensions(c),Element.getDimensions(b))));return new apple.fx.Chain(e)}});Package("apple.fx");
apple.fx.CrossFade=function(a,b){if(!a||10>a)a=this.getDefaultSpeed();b||(b=this.getDefaultIncrement());this.fadeSpeed=a;this.fadeInc=b;this.fadeStep=0};apple.fx.CrossFade.DEFAULT_SPEED=8;apple.fx.CrossFade.DEFAULT_INCREMENT=0.05;apple.fx.CrossFade.prototype.getDefaultSpeed=function(){return apple.fx.CrossFade.DEFAULT_SPEED};apple.fx.CrossFade.prototype.getDefaultIncrement=function(){return apple.fx.CrossFade.DEFAULT_INCREMENT};
apple.fx.CrossFade.prototype.fade=function(a,b,c){a=[].concat(a);b=[].concat(b);this.lastFromObjects&&(this.stopAnimation(),this.lastFromObjects.forEach(Element.hide));this.lastFromObject=a;this.fadeStep=0;a.forEach(function(a){Element.setStyles(a,{top:"0px",left:"0px",opacity:1});Element.show(a)});b.forEach(function(a){Element.setStyles(a,{top:"0px",left:"0px",opacity:0});Element.show(a)});this._fade(a,b,c)};apple.fx.CrossFade.prototype.swap=apple.fx.CrossFade.prototype.fade;
function roundToPlaces(a,b){if(!b)return Math.round(a);var c=Math.pow(10,b);return Math.round(a*c)/c}
apple.fx.CrossFade.prototype._fade=function(a,b,c){this.stopAnimation();this.fadeStep=roundToPlaces(this.fadeStep+this.fadeInc,6);if(1>this.fadeStep){var d=function(a){return function(b){Element.setOpacity(b,a)}},e=d(this.fadeStep),d=d(roundToPlaces(1-this.fadeStep,6));(b||[]).forEach(e);(a||[]).forEach(d);var f=this;this.timer=window.setTimeout(function(){f._fade(a,b,c)},this.fadeSpeed)}else this._finishFade(a,b,c)};
apple.fx.CrossFade.prototype._finishFade=function(a,b,c){this.lastFromObject=null;this.stopAnimation();(a||[]).forEach(Element.hide);(b||[]).forEach(function(a){Element.setOpacity(a,1)});c&&c()};apple.fx.CrossFade.prototype.stopAnimation=function(){this.timer&&window.clearTimeout(this.timer)};Package("apple.fx");
apple.fx.fadeShow=function(a,b,c,d){var a=$(a),e=Element.getStyle(a,"opacity");1>e?b*=1-e:Element.setStyle(a,"opacity",0);Element.show(a);var f=new apple.fx.Animator({duration:b}),g=new apple.fx.Fade(a,c,e,1);return{play:function(){f.play(g,d)}}};apple.fx.fadeHide=function(a,b,c,d){function e(){Element.hide(a);Element.setStyle(a,"opacity",1);d&&d(a,g)}var a=$(a),f=Element.getStyle(a,"opacity"),g=new apple.fx.Animator({duration:f*b}),h=new apple.fx.Fade(a,c,f,0);return{play:function(){g.play(h,e)}}};
Package("apple.fx");apple.fx.Morph=function(a){this.config=Object.applyDefaults(a,this.DEFAULTS)};apple.fx.Morph.prototype.DEFAULTS={duration:500,frameDelay:25,callback:function(){},style:{},easing:function(a){return 0.5+Math.sin((a+1.5)*Math.PI)/2}};
apple.fx.Morph.prototype.start=function(a){if(!this._timer){var b=$(this.config.element);if(b){a&&(this.config=Object.applyDefaults(a,this.DEFAULTS));this._animator=this.animate.bind(this);this._now=0;this._start=Object.applyDefaults(Element.getRect(b,!0),Element.getDimensions(b));this._start.opacity=Element.getStyle(b,"opacity");a=Element.getRect(b.parentNode,!0);this._start.top-=a.top;this._start.left-=a.left;this._delta={};for(var c in this.config.style)this._delta[c]=this.config.style[c]-this._start[c],
this._delta[c]||delete this._delta[c];this._timer=window.setTimeout(this._animator,this.config.frameDelay)}}};apple.fx.Morph.prototype.stop=function(){this._timer&&(window.clearTimeout(this._timer),this._timer=0,this._animator=null)};
apple.fx.Morph.prototype.animate=function(){var a,b=$(this.config.element);if(b){this._now+=this.config.frameDelay;for(var c in this._delta)a=this.config.easing(this._now/this.config.duration)*this._delta[c]+this._start[c],"opacity"==c?Element.setStyle(b,"opacity",a):b.style[c]=a+"px";this._now>=this.config.duration?this.config.callback&&this.config.callback():this._timer=window.setTimeout(this._animator,this.config.frameDelay)}};Package("apple.fx");
apple.fx.SwapFade=function(a){this.duration=a||200;this._timer=null};apple.fx.SwapFade.prototype._stopAnimation=function(){window.clearTimeout(this._timer);this._timer=null};
apple.fx.SwapFade.prototype.swap=function(a,b,c){function d(a){Element.hide(a);Element.setOpacity(a,1)}this._stopAnimation();var e=0,f=this.duration,g=f/2,h=!1;a.forEach(function(a){Element.setStyle(a,"top","0px");Element.setStyle(a,"left","0px");Element.setOpacity(a,1);Element.show(a)});b.forEach(function(a){Element.setStyle(a,"top","0px");Element.setStyle(a,"left","0px");Element.setOpacity(a,0);Element.show(a)});var i=function(){function j(a){0>a?a=0:1<a&&(a=1);a=Math.round(100*a)/100;return function(b){Element.setOpacity(b,
a)}}e+=10;e<g?a.forEach(j(1-e/g)):(h||(h=!0,a.forEach(d)),b.forEach(j((e-g)/g)));e>f?(b.forEach(j(1)),this._timer=null,c&&c()):this._timer=window.setTimeout(i,10)}.bind(this);this._timer=window.setTimeout(i,10)};Package("apple.fx");apple.fx.Swoosh=function(a,b,c){this.viewerId=a;b||(b=apple.fx.Swoosh.DEFAULT_PAN_SPEED);c||(c=apple.fx.Swoosh.DEFAULT_PAN_INCREMENT);this.panSpeed=b;this.panIncrement=c};apple.fx.Swoosh.DEFAULT_PAN_SPEED=20;apple.fx.Swoosh.DEFAULT_PAN_INCREMENT=40;
apple.fx.Swoosh.prototype.getDefaultSpeed=function(){return apple.fx.Swoosh.DEFAULT_PAN_SPEED};apple.fx.Swoosh.prototype.getDefaultIncrement=function(){return apple.fx.Swoosh.DEFAULT_PAN_INCREMENT};apple.fx.Swoosh.prototype.getViewer=function(){return $(this.viewerId)};
apple.fx.Swoosh.prototype.pan=function(a,b,c,d){this.lastFromObject&&(this.stopAnimation(),Element.hide(this.lastFromObject));this.lastFromObject=b;var e=this.getViewWidth();Element.setStyles(b,{top:"0px",left:"0px"});Element.setStyles(c,{top:"0px",left:(a?e:-e)+"px"});Element.show(b);Element.show(c);this._pan(Math.PI,e,a,b,c,d)};apple.fx.Swoosh.prototype.getViewWidth=function(){return parseInt(Element.getStyle(this.getViewer(),"width"),10)};
apple.fx.Swoosh.prototype._pan=function(a,b,c,d,e,f){this.stopAnimation();a+=Math.PI/this.panIncrement;if(a<=2*Math.PI){var g=Math.floor(b/2*(1+Math.cos(a)));c&&(g=-g);Element.setStyle(d,"left",g+"px");Element.setStyle(e,"left",g+(c?b:-b)+"px");var h=this;this.timer=window.setTimeout(function(){h._pan(a,b,c,d,e,f)},this.panSpeed)}else this._finishPan(d,e,f)};apple.fx.Swoosh.prototype._finishPan=function(a,b,c){this.lastFromObject=null;this.stopAnimation();Element.hide(a);c&&c()};
apple.fx.Swoosh.prototype.stopAnimation=function(){this.timer&&(window.clearTimeout(this.timer),this.timer=null)};Package("apple.fx");var halfPI=Math.PI/2,PI=Math.PI;apple.fx.linearTween=function(a){return a};apple.fx.easeInSine=function(a){return 1-Math.cos(a*halfPI)};apple.fx.easeOutSine=function(a){return Math.sin(a*halfPI)};apple.fx.easeInOutSine=function(a){return(1-Math.cos(a*PI))/2};apple.fx.easeInBack=function(a,b){void 0==b&&(b=1.70158);return a*a*((b+1)*a-b)};
apple.fx.easeOutBack=function(a,b){void 0==b&&(b=1.70158);a-=1;return a*a*((b+1)*a+b)+1};apple.fx.easeOutBackStrong=function(a,b){void 0==b&&(b=1.70158*1.5);a-=1;return a*a*((b+1)*a+b)+1};
apple.fx.Chain=function(){function a(g){if(d!=c){var i=(g*e-f[d])/b[d].duration;1<i&&(i=1);b[d](i);1>i||("finish"in b[d]&&b[d].finish(i),d++,d!=c&&("setup"in b[d]&&b[d].setup(),a(g)))}}var b;if(1==arguments.length&&"function"==typeof arguments[0])return arguments[0];b=1==arguments.length&&arguments[0]instanceof Array?arguments[0]:Array.from(arguments);b=b.filter(function(a){return null!==a&&"undefined"!=typeof a});for(var c=b.length,d=0,e=0,f=[],g=0;g<c;++g)f[g]=e,"duration"in b[g]||(b[g].duration=
1),e+=b[g].duration;a.setup=function(){d=0;"setup"in b[d]&&b[d].setup()};a.finish=function(){};return a};
apple.fx.Blend=function(){function a(a){for(d=0;d<c;++d)b[d](a)}var b;if(1==arguments.length&&"function"==typeof arguments[0])return arguments[0];b=1==arguments.length&&arguments[0]instanceof Array?arguments[0]:Array.from(arguments);b=b.filter(function(a){return null!==a&&"undefined"!=typeof a});var c=b.length,d;a.setup=function(){for(d=0;d<c;++d)"setup"in b[d]&&b[d].setup()};a.finish=function(a){for(d=0;d<c;++d)"finish"in b[d]&&b[d].finish(a)};return a};
apple.fx.AdjustCurve=function(a,b,c){b=b||0;c=c||1;if(0===b&&1===c)return a;var d=c-b,e=b/d;return function(b){return a(Math.min(1,b/d-e))}};apple.fx.Fade=function(a,b,c,d){function e(d){Element.setOpacity(b,c+f*a(d))}var f=d-c,g=0===d?["","none"]:["none",""];e.setup=function(){Element.setOpacity(b,c);b.style.display=""};e.finish=function(a){a=a?1:0;b.style.display=g[a];Element.setOpacity(b,a?d:c)};return e};apple.fx.FadeIn=function(a,b){return apple.fx.Fade(a,b,0,1)};
apple.fx.FadeOut=function(a,b){return apple.fx.Fade(a,b,1,0)};
apple.fx.CrossFade2=function(a,b,c){function d(d){Element.setOpacity(b,a(1-d));Element.setOpacity(c,a(d))}var e,f;d.setup=function(){e=Element.getStyle(b,"position");f=Element.getStyle(c,"position");b.style.display="";Element.setOpacity(b,1);b.style.position="absolute";Element.setOpacity(c,0);c.style.display="";c.style.position="absolute"};d.finish=function(a){c.style.display=a?"":"none";Element.setOpacity(c,1);b.style.display=a?"none":"";Element.setOpacity(b,1);c.style.position=f;b.style.position=
e};return d};apple.fx.FadeOutIn=function(a,b,c){function d(d){d*=2;1>=d?(Element.setOpacity(b,a(1-d)),Element.setOpacity(c,0)):(Element.setOpacity(b,0),Element.setOpacity(c,a(d-1)))}d.setup=function(){b.style.display="";Element.setOpacity(b,1);Element.setOpacity(c,0);c.style.display=""};d.finish=function(a){c.style.display=a?"":"none";Element.setOpacity(c,1);b.style.display=a?"none":"";Element.setOpacity(b,1)};return d};
apple.fx.Pan=function(a,b,c,d){function e(d){d=Math.round(h*a(d));b.style.left=d+"px";c.style.left=g+d+"px"}var f=b.offsetWidth,d=d||1,g=0<d?-f:f,h=d*f;e.setup=function(){b.style.display="";c.style.left=g+"px";c.style.display=""};e.finish=function(a){1==a&&(b.style.display="none",b.style.left="0")};return e};
apple.fx.Scroll=function(a,b,c,d){function e(d){d=Math.round(h*a(d));b.style.top=d+"px";c.style.top=g+d+"px"}var f=b.offsetHeight,d=d||1,g=0<d?-f:f,h=d*f;e.setup=function(){b.style.display="";c.style.top=g+"px";c.style.display=""};e.finish=function(a){1==a&&(b.style.display="none",b.style.top="0")};return e};
apple.fx.MoveBy=function(a,b,c){function d(c){c=a(c);b.style.left=g+Math.round(e*c)+"px";b.style.top=h+Math.round(f*c)+"px"}var e=c.x||c.left||0,f=c.y||c.top||0,g,h;d.setup=function(){g=parseFloat(Element.getStyle(b,"left")||0);h=parseFloat(Element.getStyle(b,"top")||0)};return d};
apple.fx.MoveTo=function(a,b,c){function d(c){c=a(c);b.style.left=g+Math.round(e*c)+"px";b.style.top=h+Math.round(f*c)+"px"}var e,f,g,h;d.setup=function(){g=parseFloat(Element.getStyle(b,"left")||0);h=parseFloat(Element.getStyle(b,"top")||0);e="x"in c||"left"in c?(c.x||c.left)-g:0;f="y"in c||"top"in c?(c.y||c.top)-h:0};return d};
apple.fx.Move=function(a,b,c,d){function e(c){c=a(c);b.style.left=h+Math.round(f*c)+"px";b.style.top=i+Math.round(g*c)+"px"}var f,g,h,i;e.setup=function(){h="x"in c||"left"in c?c.x||c.left:parseFloat(Element.getStyle(b,"left")||0);"y"in c||"top"in c?h=c.y||c.top:i=parseFloat(Element.getStyle(b,"top")||0);f="x"in d||"left"in d?(d.x||d.left)-h:0;g="y"in d||"top"in d?(d.y||d.top)-i:0};return e};
apple.fx.FadeInBackgroundImage=function(a,b,c){function d(b){Element.setOpacity(f,a(b))}var e=Element.assignId(b),f=document.getElementById(e+"_fadingBackgroundImage");"url("!=c.substr(0,4).toLowerCase()&&(c="url("+c+")");f||(f=document.createElement("div"),f.id=e+"_fadingBackgroundImage",f.style.display="none",f.style.position="absolute",f.style.top="0",f.style.left="0",f.style.zIndex="0",b.insertBefore(f,b.firstChild));f.style.backgroundImage=c;d.setup=function(){Element.makePositioned(b);Element.makeClipping(b);
f.style.backgroundPosition=Element.getStyle(b,"backgroundPosition");f.style.backgroundRepeat=Element.getStyle(b,"backgroundRepeat");f.style.width=b.offsetWidth+"px";f.style.height=b.offsetHeight+"px";Element.setOpacity(f,0);f.style.display=""};d.finish=function(){window.setTimeout(function(){f.style.display="none";Element.setOpacity(f,1);Element.undoPositioned(b);Element.undoClipping(b)},10)};return d};apple.fx.SetClassName=function(a,b,c){function d(){b.className=c}d.duration=0;return d};
apple.fx.SetInnerHTML=function(a,b,c){function d(){b.innerHTML=c}d.duration=0;return d};apple.fx.SetInnerText=function(a,b,c){function d(){var a=document.createTextNode(c);b.innerHTML="";b.appendChild(a)}d.duration=0;return d};
apple.fx.Resize=function(a,b,c,d){function e(c){var e=b.style,c=a(c);e.height=Math.round(c*f.height+d.height)+"px";e.width=Math.round(c*f.width+d.width)+"px"}var f=null;e.setup=function(){Element.makeClipping(b);d||(d=Element.getDimensions(b));f={width:c.width-d.width,height:c.height-d.height}};e.finish=function(a){var e=b.style;a?(e.height=Math.round(c.height)+"px",e.width=Math.round(c.width)+"px"):(e.height=Math.round(d.height)+"px",e.width=Math.round(d.width)+"px");Element.undoClipping(b)};return e};
apple.fx.Morph=function(a,b,c,d){function e(c){var e=b.style,c=a(c);g&&(e.left=Math.round(c*f.left+d.left)+"px",e.top=Math.round(c*f.top+d.top)+"px");h&&(e.height=Math.round(c*f.height+d.height)+"px",e.width=Math.round(c*f.width+d.width)+"px")}var f=null,g=!0,h=!0;e.setup=function(){d||(d=Element.getDimensions(b));var a=Element.getPadding(b);g="left"in c&&"left"in d&&"top"in c&&"top"in d;h="width"in c&&"width"in d&&"height"in c&&"height"in d;f={left:c.left-d.left-a.left,top:c.top-d.top-a.top,width:c.width-
d.width-a.left-a.right,height:c.height-d.height-a.top-a.bottom}};e.finish=function(a){var e=b.style;a?(g&&(e.top=Math.round(c.top)+"px",e.left=Math.round(c.left)+"px"),h&&(e.height=Math.round(c.height)+"px",e.width=Math.round(c.width)+"px")):(g&&(e.top=Math.round(d.top)+"px",e.left=Math.round(d.left)+"px"),h&&(e.height=Math.round(d.height)+"px",e.width=Math.round(d.width)+"px"))};return e};apple.fx.Hide=function(a,b){function c(){}c.finish=function(a){b.style.display=a?"none":""};return c};
apple.fx.ResizeImage=function(a,b,c,d){function e(c){var e=b.style,i,c=a(c);e.height=(i=Math.round(c*f.height+d.height))+"px";e.width=(c=Math.round(c*f.width+d.width))+"px";b.width=c;b.height=i}var f=null;e.setup=function(){d||(d=Element.getDimensions(b));f={width:c.width-d.width-(parseFloat(Element.getStyle(b,"padding-left"))||0)-(parseFloat(Element.getStyle(b,"padding-right"))||0),height:c.height-d.height-(parseFloat(Element.getStyle(b,"padding-top"))||0)-(parseFloat(Element.getStyle(b,"padding-bottom"))||
0)}};e.finish=function(a){var e;e=b.style;var f=a?c:d;e.height=(a=Math.round(f.height))+"px";e.width=(e=Math.round(f.width))+"px";b.height=a;b.width=e};return e};apple.fx.ColourRgbRegex=/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i;apple.fx.ColourHexRegex=/^\#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/;
apple.fx.ChangeColour=function(a,b,c,d,e){function f(a){var b=a.match(apple.fx.ColourRgbRegex);if(b)return[Math.clamp(parseInt(b[1],10),0,255),Math.clamp(parseInt(b[2],10),0,255),Math.clamp(parseInt(b[3],10),0,255)];if(b=a.match(apple.fx.ColourHexRegex)){var c=b[1];3==c.length?(a=c.charAt(0)+c.charAt(0),b=c.charAt(1)+c.charAt(1),c=c.charAt(2)+c.charAt(2)):(a=c.slice(0,2),b=c.slice(2,4),c=c.slice(4,6));return[Math.clamp(parseInt(a,16),0,255),Math.clamp(parseInt(b,16),0,255),Math.clamp(parseInt(c,16),
0,255)]}throw Error("Invalid colour string: "+a);}function g(a){a=Math.round(Math.clamp(a,0,255));return 16>a?"0"+a.toString(16):a.toString(16)}function h(d){d=a(d);d=["#",g(e[0]+i[0]*d),g(e[1]+i[1]*d),g(e[2]+i[2]*d)].join("");b.style[c]=d}var i;h.setup=function(){e=f(e||Element.getStyle(b,c));d=f(d);i=[d[0]-e[0],d[1]-e[1],d[2]-e[2]]};return h};apple.fx.ChangeColor=apple.fx.ChangeColour;Package("apple.io.json");
apple.io.json.invoke=function(a){function b(b){if(apple.io.json.isRedirect(b))a.redirect&&a.redirect(b),apple.io.json.redirect(b);else if(apple.io.json.hasErrors(b))a.error&&a.error(b);else{var c;b.head&&b.head.data&&b.head.data.metrics?c=b.head.data.metrics:b.body&&b.body.metrics&&(c=b.body.metrics,delete b.body.metrics);if(c||a.metrics)c=Object.extend(a.metrics||{},c),apple.metrics.fireEvent(c);b.preScript&&coherent.Scripts.install(b.preScript);a.success&&a.success(b);b.postScript&&coherent.Scripts.install(b.postScript);
apple.io.json.evaluateScriptKeys(b.body,a.scriptKeys)}}function c(b){a.error&&a.error(b)}var d=null,e=a.sync||!1,f=a.method||"get";try{d=XHR.request(f,a.url,a.urlArgs,{sync:e,responseContentType:"application/json"}),d.addMethods(b,c)}catch(g){a.error&&a.error(g)}return d};apple.io.json.redirect=function(a){(a=a.head.data)&&a.url&&("post"==a.method?apple.io.json.issuePostRedirect(a.url,a.args):apple.io.json.issueGetRedirect(a.url,a.args))};
apple.io.json.issuePostRedirect=function(a,b){if(a){var c=document.createElement("form");c.action=a;c.method="post";var d,e,f={},g=function(a,b,c){var d=document.createElement("input");a.appendChild(d);d.type="hidden";d.name=b;d.value=c};for(d in b)e=b[d],b[d]!==f[d]&&(e instanceof Array?e.forEach(function(a){g(c,d,a)}):g(c,d,e));c.style.position="absolute";c.style.visibility="hidden";c.style.height="0px";c.style.width="0px";document.body.appendChild(c);c.submit()}};
apple.io.json.issueGetRedirect=function(a,b){if(a){var c=null;b&&(c=Object.toQueryString(b));c&&(a=0>a.indexOf("?")?a+("?"+c):a+c);window.location.href=a}};apple.io.json.isRedirect=function(a){var b=!1;try{if(a)switch(parseInt(a.head.status,10)){case 301:case 302:case 303:case 304:case 305:case 306:case 307:b=!0}}catch(c){}return b};apple.io.json.hasErrors=function(a){var b=!1;try{if(a){var c=parseInt(a.head.status,10);200==c?b=!1:400<=c&&600>c&&(b=!0)}else b=!0}catch(d){}return b};
apple.io.json.evaluateScriptKeys=function(a,b){if(a&&b)for(var c=0;c<b.length;c++){var d=a[b[c]];d&&(d=coherent.Scripts.extract(d).scripts,coherent.Scripts.install(d))}};apple.io.json.createSimpleJsonMsg=function(a){return{head:{status:"200"},body:{content:a}}};Package("apple.quicktime");apple.quicktime._initialised=!1;apple.quicktime._version=void 0;
apple.quicktime.DEFAULTS={activeXClassId:"clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B",activeXCodebase:"http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0",mimeType:"video/quicktime",autoplay:!0,cache:!0,controller:!1,enablejavascript:!0,showlogo:!1,saveembedtags:!0,scale:"aspect"};apple.quicktime.mobileSafari=!!navigator.userAgent.match(/Mobile.*Safari/);apple.quicktime.isInstalled=function(){return this.mobileSafari||this._version||this.getVersion()?!0:!1};
apple.quicktime.getVersion=function(){if(this._version||this._initialised)return this._version;this._initialised=!0;var a=window.navigator.plugins,b=a?a.length:0;if(a&&b){var c;for(c=0;c<b;++c){var d=a[c].name.match(/quicktime\D*([\.\d]*)/i);if(d&&d[1])return this._version=d[1]}}else try{c=(new window.ActiveXObject("QuickTimeCheckObject.QuickTimeCheck")).QuickTimeVersion.toString(16),this._version=[c.charAt(0),c.charAt(1),c.charAt(2)].join(".")}catch(e){}return this._version};
apple.quicktime.isVersionCompatible=function(a){function b(a,c){var f=parseInt(a[0],10);isNaN(f)&&(f=0);var g=parseInt(c[0],10);isNaN(g)&&(g=0);return f===g?1<a.length?b(a.slice(1),c.slice(1)):!0:f<g?!0:!1}var a=String(a).split(/\./),c=String(this.getVersion()).split(/\./);return b(a,c)};
apple.quicktime.createMovie=function(a,b){var c=document.createElement("OBJECT"),a=Object.applyDefaults(Object.clone(a),this.DEFAULTS);"width height name id class title bgcolor".split(" ").forEach(function(b){b in a&&c.setAttribute(b,a[b])});"src autoplay cache controller enablejavascript showlogo saveembedtags loop".split(" ").forEach(function(b){var e=document.createElement("PARAM");b in a&&(e.setAttribute("name",b),e.setAttribute("value",a[b]),c.appendChild(e))});window.ActiveXObject?(c.setAttribute("classid",
a.activeXClassId),c.setAttribute("codebase",a.activeXCodebase)):(c.setAttribute("data",a.src),c.setAttribute("type",a.mimeType));b.appendChild(c);return c};
apple.quicktime.logProperties=function(a){var b;b="PluginStatus AutoPlay ControllerVisible Rate Time Volume Mute MovieName MovieID StartTime EndTime BgColor IsLooping LoopIsPalindrome PlayEveryFrame HREF Target QTNEXTUrl URL KioskMode Duration MaxTimeLoaded TimeScale MovieSize MaxBytesLoaded TrackCount Matrix Rectangle Language".split(" ").map(function(b){try{return[b,a["Get"+b]()].join(": ")}catch(d){return d.message}});console.log(b.join("\n"))};Package("apple.widget");
apple.widget.AlternateProductsUpdater=function(a){this.config=a||{};Object.applyDefaults(this.config,apple.widget.AlternateProductsUpdater.DEFAULTS);Event.onDomReady(this.init.bind(this))};apple.widget.AlternateProductsUpdater.DEFAULTS={priceId:"price",shippingId:"shipping",priceClass:"price",shippingClass:"availability",labelSuffix:"-label"};
apple.widget.AlternateProductsUpdater.prototype.init=function(){function a(a){var b=a.htmlFor;a.id=b+this.config.labelSuffix;a=document.getElementById(b);Event.observe(a,"click",c)}var b=document.getElementById(this.config.elementId);if(b&&(b=b.getElementsByTagName("label"))){var c=this.selectProduct.bindAsEventListener(this);Array.forEach(b,a,this)}};apple.widget.AlternateProductsUpdater.prototype.selectProduct=function(a){this.updateSelectedProduct(a.srcElement||a.target)};
apple.widget.AlternateProductsUpdater.prototype.updateSelectedProduct=function(a){var b=document.getElementById(a.id+this.config.labelSuffix);if(b){var a=document.getElementById(this.config.priceId),c=document.getElementById(this.config.shippingId),d=Element.getElementsByClassName(this.config.priceClass,b),b=Element.getElementsByClassName(this.config.shippingClass,b);a&&(d&&0<d.length)&&(a.innerHTML=d[0].innerHTML);c&&(b&&0<b.length)&&(c.innerHTML=b[0].innerHTML)}};Package("apple.widget");
apple.widget.AnimatedTextWidget=function(){var a=window.coherent,b=a.Animator,c=window.Element,d=c.getStyle,e=c.getStyles,f=c.setStyle,g=c.setStyles,h=c.undoClipping;return Class.create(a.View,{__viewClassName__:"apple.AnimatedText",animated:!0,observeVisibleChange:function(d){var j=this.viewElement(),l=e(j,["display","paddingTop","paddingBottom"]),k=l.display,n=!!d.newValue,l=(parseFloat(l.paddingTop)||0)+(parseFloat(l.paddingBottom)||0);n!==k&&(c.makeClipping(j),d.newValue?(g(j,{height:"0px",display:""}),
b.setStyles(j,{height:Math.max(0,j.scrollHeight-l)},{duration:300,curve:a.easing.inOutSine,callback:function(){f(j,"height","");h(j)}})):(f(j,"height",Math.max(j.offsetHeight-l,j.offsetHeight)+"px"),b.setStyles(j,{height:0},{duration:300,curve:a.easing.inOutSine,callback:function(){g(j,{display:"none",height:""});h(j)}})))},translateValue:function(b){var d=this.viewElement(),e=!0,f=this.attributeOrProperty;this.formatter&&(b=this.formatter.stringFromValue(b));switch(b){case "":case null:case void 0:if("string"===
typeof this.nullPlaceHolder||c.hasAttribute(d,"nullPlaceHolder"))b=f("nullPlaceholder");break;case a.Markers.NoSelection:b=f("noSelectionPlaceholder");break;case a.Markers.MultipleValues:b=f("multipleValuesPlaceholder");break;default:b=String(b),e=!1}e?c.addClassName(d,a.Style.kMarkerClass):c.removeClassName(d,a.Style.kMarkerClass);return b},observeTextChange:function(a){var c=this.viewElement(),a=this.translateValue(a.newValue);!this.animated||"none"===d(c,"display")?(a=document.createTextNode(a),
c.innerHTML="",c.appendChild(a)):a!==c.innerText&&b.innerText(c,a,300)},observeHtmlChange:function(a,c,e){var f=this.viewElement(),g=a.newValue,h=this.translateValue(g);!this.animated||"none"===d(f,"display")?h!==g?(a=document.createTextNode(h),f.innerHTML="",f.appendChild(a)):f.innerHTML=h:"string"===typeof h&&(h!==g?this.observeTextChange(a,c,e):"string"===typeof h&&h.trim()===String(f.innerHTML).trim()||b.innerHTML(f,h,300))}})}();Package("apple.widget");
apple.widget.AutoCompleter=function(a,b,c){this.country=b;this.field=c;this.cur=-1;this.layer=null;this.textbox=a;this.init()};
Object.extend(apple.widget.AutoCompleter.prototype,{init:function(){var a=this;this.textbox.onkeyup=function(b){b||(b=window.event);a.handleKeyUp(b)};this.textbox.onkeydown=function(b){b||(b=window.event);a.handleKeyDown(b)};this.textbox.onblur=function(){a.hideSuggestions()};this.createDropDown()},autosuggest:function(a,b){0<a.length?(b&&this.typeAhead(a[0]),this.showSuggestions(a)):this.hideSuggestions()},createDropDown:function(){var a=this;this.layer=document.createElement("div");this.layer.className=
"AutoCompleterResults";if(coherent.Browser.Safari){var b=/AppleWebKit\/(\d+(?:\.\d+)?)/.exec(navigator.userAgent);b&&523<=parseInt(b[1],10)&&(this.layer.className+=" capable")}this.layer.style.visibility="hidden";this.layer.style.left="-5000px";this.layer.style.top="0px";this.layer.onmousedown=this.layer.onmouseup=this.layer.onmouseover=function(b){var b=b||window.event,d=b.target||b.srcElement;"mousedown"==b.type?null!==d.firstChild.nodeValue&&(a.textbox.value=d.firstChild.nodeValue,a.hideSuggestions()):
"mouseover"==b.type?a.highlightSuggestion(d):a.textbox.focus()};document.body.appendChild(this.layer)},handleKeyDown:function(a){switch(a.keyCode){case 38:this.previousSuggestion();break;case 40:this.nextSuggestion();break;case 13:this.cancelEvent(a);this.hideSuggestions();break;case 27:this.hideSuggestions()}},cancelEvent:function(a){a.cancelBubble=!0;a.returnValue=!1;a.stopPropagation&&(a.stopPropagation(),a.preventDefault())},handleKeyUp:function(a){a=a.keyCode;8==a||46==a?this.autosuggest(this.search(this.textbox.value),
!1):32>a||(33<=a&&46>a||112<=a&&123>=a)||this.autosuggest(this.search(this.textbox.value),!0)},showSuggestions:function(a){var b=Element.getRect(this.textbox);this.layer.style.top=b.top+this.textbox.offsetHeight+"px";this.layer.style.left=b.left+this.textbox.offsetWidth/2+"px";this.layer.style.width="";b=null;this.layer.innerHTML="";var c=document.createElement("div");c.className="top";c.innerHTML='<span class="left"></span><span class="right"></span>';var d=document.createElement("div");d.className=
"middle";var e=document.createElement("div");e.className="bottom";e.innerHTML='<span class="left"></span><span class="right"></span>';for(var f=document.createElement("ul"),g=0;g<a.length;g++)b=document.createElement("li"),b.appendChild(document.createTextNode(a[g])),f.appendChild(b);d.appendChild(f);this.layer.appendChild(c);this.layer.appendChild(d);this.layer.appendChild(e);this.layer.style.visibility="visible";this.layer.style.width=d.offsetWidth+"px";this.layer.style.marginLeft=-0.5*this.layer.offsetWidth+
"px"},hideSuggestions:function(){this.layer.style.visibility="hidden"},highlightSuggestion:function(a){for(var b=this.layer.getElementsByTagName("li"),c=0;c<b.length;c++)b[c].className=b[c]==a?"selected":""},nextSuggestion:function(){var a=this.layer.getElementsByTagName("li");0<a.length&&this.cur<a.length-1&&(a=a[++this.cur],this.highlightSuggestion(a),this.textbox.value=a.firstChild.nodeValue)},previousSuggestion:function(){var a=this.layer.getElementsByTagName("li");0<a.length&&0<this.cur&&(a=
a[--this.cur],this.highlightSuggestion(a),this.textbox.value=a.firstChild.nodeValue)},selectRange:function(a,b){if(this.textbox.createTextRange){var c=this.textbox.createTextRange();c.moveStart("character",a);c.moveEnd("character",b-this.textbox.value.length);c.select()}else this.textbox.setSelectionRange&&this.textbox.setSelectionRange(a,b)},search:function(a){var b=[],c=apple.widget.AutoCompleter.data[this.country][this.field];if(0<a.length)for(a=a.toUpperCase()+" ";1<a.length&&0===b.length;){var a=
a.substring(0,a.length-1),d=c[a.substring(0,1)];if(d)for(var e=0;e<d.length;e++)0===d[e].indexOf(a)&&b.push(d[e])}return b},typeAhead:function(a){if((this.textbox.createTextRange||this.textbox.setSelectionRange)&&a&&this.textbox.value&&0===a.indexOf(this.textbox.value)){var b=this.textbox.value.length;this.textbox.value=a;this.selectRange(b,a.length)}}});apple.widget.AutoCompleter.requestURL="";apple.widget.AutoCompleter.requestParams={};apple.widget.AutoCompleter.willRequest=!1;
apple.widget.AutoCompleter.requestTimer=null;apple.widget.AutoCompleter.requestCallback=null;apple.widget.AutoCompleter.data=null;apple.widget.AutoCompleter.registerInput=function(a,b,c){apple.widget.AutoCompleter.willRequest=!0;var d=apple.widget.AutoCompleter.requestParams;b in d||(d[b]={});c in d[b]||(d[b][c]=[]);d[b][c].push(a)};
apple.widget.AutoCompleter.requestData=function(){function a(){apple.widget.AutoCompleter.requestCallback=function(){}}if(!1!==apple.widget.AutoCompleter.willRequest){var b={p:"apple.widget.AutoCompleter.processData"},c;for(c in apple.widget.AutoCompleter.requestParams){c in b||(b[c]=[]);for(var d in apple.widget.AutoCompleter.requestParams[c])b[c].push(d)}c=apple.widget.AutoCompleter.requestURL;d=-1!=c.indexOf("?")?"&":"?";c+=d+Object.toQueryString(b);b=document.createElement("script");b.src=c;apple.widget.AutoCompleter.requestCallback=
function(a){window.clearTimeout(apple.widget.AutoCompleter.requestTimer);apple.widget.AutoCompleter.requestTimer=null;apple.widget.AutoCompleter.processData(a)};apple.widget.AutoCompleter.requestTimer=window.setTimeout(a,1E4);document.getElementsByTagName("HEAD")[0].appendChild(b)}};
apple.widget.AutoCompleter.processData=function(a){apple.widget.AutoCompleter.data=a;var a=apple.widget.AutoCompleter.requestParams,b;for(b in a)for(var c in a[b])for(var d=0;d<a[b][c].length;d++)apple.widget.AutoCompleter.create(a[b][c][d],b,c)};apple.widget.AutoCompleter.create=function(a,b,c){if(a=document.getElementById(a))a.setAttribute&&a.setAttribute("AUTOCOMPLETE","off"),new apple.widget.AutoCompleter(a,b,c)};Event.onDomReady(apple.widget.AutoCompleter.requestData);Package("apple.widget");
function _makePartFinder(a){function b(a){return a.id in g}function c(){for(var b=[],c=0;c<d;++c)b.push(document.getElementById(a[c]));return b}var d=a.length;if(1==d){var e=a[0],f=function(){return[document.getElementById(e)]};f.single=function(){return document.getElementById(e)};f.isPart=function(a){return a.id==e};return f}var g=void 0;c.single=function(b){return document.getElementById(a[b])};c.isPart=function(c){g={};for(var e=0;e<d;++e)g[a[e]]=!0;this.isPart=b;return b(c)};return c}
apple.widget.BaseWidget=function(a,b){1==arguments.length?b=a||{}:(b=b||{},b.id="string"!=typeof a?Element.assignId(a):a||b.id);this._partCache={};this._widgetId=b.id;this.setConfig(b);Event.onDomReady(this.init.bind(this))};
Class.extend(apple.widget.BaseWidget,{setConfig:function(a){for(var b=this.constructor;b&&Object!==b;b=b.superclass)Object.applyDefaults(a,b.DEFAULTS||{});this.config=a},init:function(){},widget:function(){return document.getElementById(this._widgetId)},observeParts:function(a,b,c){var a=this.parts(a),d=a.length,e;for(e=0;e<d;++e)Event.observe(a[e],b,c)},observePart:function(a,b,c){a=this.part(a);Event.observe(a,b,c)},stopObservingParts:function(a,b,c){var a=this.parts(a),d=a.length,e;for(e=0;e<d;++e)Event.stopObserving(a[e],
b,c)},isPart:function(a,b){a in this._partCache||this.parts(a);return this._partCache[a].isPart(b)},part:function(a,b){b=b||0;return a in this._partCache?this._partCache[a].single(b):this.parts(a)[b]},parts:function(a){if(a in this._partCache)return this._partCache[a]();var b=this.widget(),c=a.split("."),d=[],e;if(0===c.length||2<c.length)return[];if(1==c.length){b=b.getElementsByTagName(c[0]);c=d.length=b.length;for(e=0;e<c;++e)d[e]=Element.assignId(b[e])}else{var f=[],g=0,h=RegExp("(?:^|\\s+)"+
c[1]+"(?:\\s+|$)"),b=b.getElementsByTagName(c[0]||"*"),c=f.length=d.length=b.length;for(e=0;e<c;++e){var i=b[e];h.test(i.className)&&(d[g]=Element.assignId(i),f[g]=i,++g)}d.length=g;f.length=g;b=f}this._partCache[a]=_makePartFinder(d);return Array.from(b)}});Package("apple.widget");apple.widget.ColumnEqualizer=function(a){this.elementList="string"===typeof a?Element.queryAll(a):a;this.calculateHeights()};
apple.widget.ColumnEqualizer.prototype.calculateHeights=function(){var a=0,b=0;this.elementList.forEach(function(c){b=c.style.height;c.style.height="";a=Math.max(a,parseInt(Element.getStyles(c,"height").replace("px",""),10));c.style.height=b});this.elementList.forEach(function(b){Element.setStyle(b,"height",a+"px")})};Package("apple.widget");apple.widget.ContentSwitcher=function(a){this.config=Object.applyDefaults(a,this.DEFAULTS);this._activateTimer=null;Event.onDomReady(this.init.bind(this))};
apple.widget.ContentSwitcher.STYLE={switchOnClick:0,switchOnHover:1};apple.widget.ContentSwitcher.prototype.nodesById=function(a){switch(typeof a){case "string":return[$(a)];case "undefined":return[];default:return a instanceof Array?a.map($):!a?[]:[a]}};
apple.widget.ContentSwitcher.prototype.DEFAULTS={hoverDelay:200,activeContentClass:"active",inactiveContentClass:"inactive",activeButtonClass:"active",inactiveButtonClass:"inactive",style:apple.widget.ContentSwitcher.STYLE.switchOnClick,transition:{swap:function(a,b,c){a=[].concat(a);b=[].concat(b);a.forEach(function(a){a.style.display="none"});b.forEach(function(a){a.style.display=""});c&&c()}}};
apple.widget.ContentSwitcher.prototype.init=function(){var a=apple.widget.ContentSwitcher.STYLE,a=a.switchOnHover==(this.config.style&a.switchOnHover),b=this.mouseOverButton.bindAsEventListener(this),c=this.mouseOutButton.bindAsEventListener(this),d=this.buttonClicked.bindAsEventListener(this),e;for(e in this.config.buttons){var f=$(e),g=this.config.buttons[e];"string"==typeof g&&(this.config.buttons[e]=g.split(/\s*,\s*/g));f&&(a?(Event.observe(f,"mouseover",b),Event.observe(f,"mouseover",b),Event.observe(f,
"mouseout",c),Event.observe(f,"click",Event.stop)):Event.observe(f,"click",d))}this._activeButtonId=this.findInitialActiveButton();this._activeContentIds=this.config.buttons[this._activeButtonId]||[this.overviewId];this._initialActiveButton=this._activeButtonId;this._initialActiveContentIds=this._activeContentIds;this.config.containerId&&(e=$(this.config.containerId),Event.observe(e,"mouseout",this.mouseOutContainer.bindAsEventListener(this)),Event.observe(e,"mouseover",this.mouseOverContainer.bindAsEventListener(this)))};
apple.widget.ContentSwitcher.prototype.findInitialActiveButton=function(){if(!this.config.overviewId)for(var a in this.config.buttons){var b=$(a),c=this.config.buttons[a];if(b&&c){var d=Element.regexForClassName(this.config.activeContentClass);if(d.test(b.className)||this.nodesById(c).some(function(a){$(a);return d.test(b.className)},this))return a}}};
apple.widget.ContentSwitcher.prototype.reset=function(){this._activeButtonId!=this._initialActiveButton&&(this.activateButton(this._initialActiveButton),this.activateContent(this._initialActiveContentIds))};
apple.widget.ContentSwitcher.prototype.activateButton=function(a){var b;this._activeButtonId&&(b=$(this._activeButtonId),Element.addClassName(b,this.config.inactiveButtonClass),Element.removeClassName(b,this.config.activeButtonClass));if(this._activeButtonId=a)b=$(a),Element.removeClassName(b,this.config.inactiveButtonClass),Element.addClassName(b,this.config.activeButtonClass)};
apple.widget.ContentSwitcher.prototype.activateContent=function(a){var b=this._activeContentIds||[],c=a||[],d=this.nodesById(b),e=this.nodesById(c);d.forEach(function(a){this.beforeHideContent(a.id);Element.removeClassName(a,this.config.activeContentClass);Element.addClassName(a,this.config.inactiveContentClass)},this);e.forEach(function(a){this.beforeShowContent(a.id);Element.removeClassName(a,this.config.inactiveContentClass);Element.addClassName(a,this.config.activeContentClass)},this);this._activeContentIds=
a||[];this.config.transition.swap(d,e);b.forEach(this.afterHideContent,this);c.forEach(this.afterShowContent,this)};apple.widget.ContentSwitcher.prototype.findTarget=function(a){if(!a)return a;for(;!a.id&&"body"!=a.nodeName;)a=a.parentNode;return!a.id?null:a};
apple.widget.ContentSwitcher.prototype.mouseOverButton=function(a){function b(){this.activateButton(c.id);this.activateContent(d)}var c=this.findTarget(Event.fixEvent(a).target);if(c){var d=this.config.buttons[c.id];d&&d!=this._activeContentId&&(this._activateTimer&&window.clearTimeout(this._activateTimer),this._activateTimer=window.setTimeout(b.bind(this),this.config.hoverDelay))}};
apple.widget.ContentSwitcher.prototype.mouseOutButton=function(a){var a=Event.fixEvent(a),b=this.findTarget(a.currentTarget);if(b){for(a=a.relatedTarget;a&&a!=b&&"body"!=a.nodeName;)a=a.parentNode;a!=b&&(this._activateTimer&&window.clearTimeout(this._activateTimer),this._activateTimer=null)}};apple.widget.ContentSwitcher.prototype.mouseOverContainer=function(a){Event.fixEvent(a)};
apple.widget.ContentSwitcher.prototype.mouseOutContainer=function(a){var a=Event.fixEvent(a),b=a.currentTarget;if(b&&this.config.overviewId){for(a=a.relatedTarget;a&&a!=b&&"body"!=a.nodeName;)a=a.parentNode;a!=b&&(this.activateContent([this.config.overviewId]),this.activateButton(null))}};
apple.widget.ContentSwitcher.prototype.buttonClicked=function(a){var b=this.findTarget(Event.fixEvent(a).target);if(b){var c=this.config.buttons[b.id];c&&b.id!=this._activeButtonId&&(this._activateTimer&&window.clearTimeout(this._activateTimer),this.activateButton(b.id),this.activateContent(c),Event.stop(a))}};apple.widget.ContentSwitcher.prototype.beforeShowContent=function(){};apple.widget.ContentSwitcher.prototype.beforeHideContent=function(){};
apple.widget.ContentSwitcher.prototype.afterShowContent=function(){};apple.widget.ContentSwitcher.prototype.afterHideContent=function(){};Package("apple.widget");
apple.widget.CrossFader=Class.create(coherent.View,{exposedBindings:["locked"],paused:!1,timer:null,selectedIndex:null,items:PartList("div.slide"),indicator:coherent.ListView("div.indicator",{contentBinding:"indicatorContent",selectedIndexBinding:"selectedIndex",enabledBinding:"locked(NOT)",innerHTML:"<span></span>"}),previousButton:coherent.Anchor("a.previous",{action:"showPreviousItem"}),nextButton:coherent.Anchor("a.next",{action:"showNextItem"}),init:function(){var a=this.items(),b=a.length,c=
this.viewElement();this.setValueForKey(!1,"locked");this.setValueForKey(0,"selectedIndex");Element.addClassName(a[0],"faded_in");if(2>b)Element.query(c,"div.pagination")&&(Element.query(c,"div.pagination").style.display="none");else{for(var d=1;d<b;d++)Element.addClassName(a[d],"faded_out");this.indicator&&(a=this.items().map(function(a,b){return{value:"Item "+(b+1)}}),this.setValueForKey(coherent.KVO.adapt(a),"indicatorContent"),this.addObserverForKeyPath(this,this.observeSelectedIndexChange,"selectedIndex"));
Event.observe(c,"mouseover",this.pause.bindAsEventListener(this));Event.observe(c,"mouseout",this.resume.bindAsEventListener(this));this.resume()}},observeSelectedIndexChange:function(a){this.locked||this.switchItems(a.oldValue,a.newValue,250)},showPreviousItem:function(a){if(!("undefined"===typeof a&&this.paused||this.locked)){var b;"undefined"!==typeof a&&(b=250);var a=this.selectedIndex,c;c=0===a?this.items().length-1:a-1;this.switchItems(a,c,b)}},showNextItem:function(a){if(!("undefined"===typeof a&&
this.paused||this.locked)){var b;"undefined"!==typeof a&&(b=250);var a=this.selectedIndex,c;c=a==this.items().length-1?0:a+1;this.switchItems(a,c,b)}},switchItems:function(a,b,c){c=c||apple.widget.CrossFader.FADE_DURATION;this.timer&&(window.clearTimeout(this.timer),this.timer=null);var d=this;this.setValueForKey(!0,"locked");Element.replaceClassName(this.items(a),"faded_in","fading_out");coherent.Animator.replaceClassName(this.items(a),"fading_out","faded_out",{duration:c,only:["opacity"],discreteTransitionPoint:1});
Element.replaceClassName(this.items(b),"faded_out","fading_in");coherent.Animator.replaceClassName(this.items(b),"fading_in","faded_in",{duration:c,only:["opacity"],discreteTransitionPoint:1,callback:function(){d.setValueForKey(b,"selectedIndex");d.setValueForKey(!1,"locked");d.resume()}})},pause:function(){this.paused=!0;this.timer&&window.clearTimeout(this.timer);this.timer=null},resume:function(a){a&&(this.paused=!1);this.timer&&window.clearTimeout(this.timer);this.timer=window.setTimeout(this.showNextItem.bind(this),
apple.widget.CrossFader.SLIDE_DELAY)}});apple.widget.CrossFader.SLIDE_DELAY=6E3;apple.widget.CrossFader.FADE_DURATION=750;Package("apple");apple.Dialog=Class.create({constructor:function(){this.createOverlay()},createOverlay:function(){var a=document.createElement("div");a.className="overlay";document.body.appendChild(a);this.overlay=new coherent.Overlay(a)}});Package("apple.widget");apple.widget.EmailSubscription=function(a,b){this.base("constructor")(a,b)};
apple.util.makeSubclass(apple.widget.EmailSubscription,apple.widget.BaseWidget);var ServerStatus={good:"SUCCESS",bad:"ERROR",busy:"BUSY",off:"OFF",on:"ON",format:"FORMAT"};
apple.widget.EmailSubscription.DEFAULTS={emailPlaceholder:"example: steve@me.com",submitUrl:"email-server-reply.txt",urlArgs:{},argName:"emailAddress",emailFieldSpec:"input.notify_email",submitButtonSpec:".notify_submit",formSpec:"form",fadeDuration:350,showForm:{SUCCESS:!1,ERROR:!1,BUSY:!1,ON:!0,OFF:!1,FORMAT:!0},loadingClass:"loading",rpcTimeout:1E4,emailRegex:/^[A-Z0-9._%+-]+@(?:[A-Z0-9-]+\.)+[A-Z]{2,4}$/i};
apple.widget.EmailSubscription.prototype.init=function(){this._animator=new apple.fx.Animator({duration:this.config.fadeDuration});this.setStatus("OFF");this.setStatus("ON");var a=this.part(this.config.formSpec),b=this.part(this.config.emailFieldSpec);this._field=new apple.widget.TextField(b.id,{placeholder:this.config.emailPlaceholder});var b=this.part(this.config.submitButtonSpec),c=this.submitHandler.bindAsEventListener(this);Event.observe(b,"click",c);Event.observe(a,"submit",c)};
apple.widget.EmailSubscription.prototype.partSpecForStatus=function(a){return"div.notify_"+(a||"").toLowerCase()};
apple.widget.EmailSubscription.prototype.setStatus=function(a,b,c){a=a||"ERROR";if(a!=this._status){this.widget();var d=this.part(this.config.formSpec),e=this.config.showForm[this._status],f=this.config.showForm[a],g=this.part(this.partSpecForStatus(this._status)),h=this.part(this.partSpecForStatus(a));this._status?c?(d.style.display=f?"block":"none",h.style.display="block",g.style.display="none",this._status=a):(c=new apple.fx.Fade(apple.fx.linearTween,g,1,0),h=new apple.fx.Fade(apple.fx.linearTween,
h,0,1),g=[c,h],e!=f&&(f?(d=new apple.fx.Fade(apple.fx.linearTween,d,0,1),g=[c,new apple.fx.Blend(h,d)]):(d=new apple.fx.Fade(apple.fx.linearTween,d,1,0),g=[new apple.fx.Blend(c,d),h])),this._status=a,this._animator.play(new apple.fx.Chain(g),b)):(d.style.display=f?"block":"none",h.style.display="block",this._status=a)}};
apple.widget.EmailSubscription.prototype.rpc=function(a,b,c){var a=-1!=a.indexOf("?")?a+"&":a+"?",a=a+("bustCache="+(new Date).getTime().toString(16)+":"+Math.random()),d,e=document.createElement("script");e.src=a;window.signalStatus=function(){window.clearTimeout(d);d=null;b&&b.apply(window,arguments)};d=window.setTimeout(function(){window.signalStatus=function(){};c&&c()},this.config.rpcTimeout);document.getElementsByTagName("HEAD")[0].appendChild(e)};
apple.widget.EmailSubscription.prototype.submitHandler=function(a){function b(){Element.removeClassName(d,this.config.loadingClass)}function c(a){a=a.replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase();this.setStatus(ServerStatus[a],b.bind(this))}(a.target||a.srcElement).blur();Event.stop(a);var d=this.widget(),e=this.part(this.config.emailFieldSpec);e&&this.config.submitUrl&&(a=e.value||"",a.match(this.config.emailRegex)?(Element.addClassName(d,this.config.loadingClass),e=Object.applyDefaults({},
this.config.urlArgs),e[this.config.argName]=a,a=[this.config.submitUrl,Object.toQueryString(e)].join("?"),this.rpc(a,c.bind(this),c.bind(this,"busy"))):(this.setStatus("FORMAT"),e.focus(),e.select()))};Package("apple.widget");apple.widget.Engraver=function(a){this.config=a;this.originalMessage=this.timer=null};apple.widget.Engraver.DEFAULT_DELAY=1E3;
apple.widget.Engraver.prototype.validateConfig=function(){if(!this.config)return!1;var a=this.getTextFields();if(!a)return!1;for(var b=0;b<a.length;b++)if(!a[b])return!1;return!this.getEngraveImage()?!1:!0};
apple.widget.Engraver.prototype.connectEvents=function(){!this.attachedEvents&&this.validateConfig()&&(Event.onDomReady(function(){var a=this.getTextFields();this.originalMessage=[];for(var b=0;b<a.length;b++){var c=$(a[b]);c.setAttribute("autocomplete","off");this.originalMessage[b]=c.value;Event.observe(c,"onkeyup",function(a){this.valueChanged(a)}.bind(this));Event.observe(c,"onchange",function(a){this.valueChanged(a)}.bind(this));Event.observe(c,"drop",function(a){this.valueChanged(a)}.bind(this));
Event.observe(c,"dragdrop",function(a){this.valueChanged(a)}.bind(this));Event.observe(c,"onfocus",function(a){this.valueChanged(a)}.bind(this))}}.bind(this)),this.attachedEvents=!0)};apple.widget.Engraver.prototype.valueChanged=function(){this.timer&&window.clearTimeout(this.timer);this.timer=window.setTimeout(this.engrave.bind(this),this.getDelay())};apple.widget.Engraver.prototype.getTextFields=function(){return this.config.textFields};apple.widget.Engraver.prototype.getEngraveImage=function(){return this.config.engraveImageId};
apple.widget.Engraver.prototype.getBaseUrl=function(){return this.config.baseUrl};apple.widget.Engraver.prototype.getDelay=function(){return this.config.delay?parseInt(this.config.delay,10):apple.widget.Engraver.DEFAULT_DELAY};
apple.widget.Engraver.prototype.engrave=function(){var a=$(this.getEngraveImage()),b=this.getBaseUrl(),c=this.getTextFields(),d=b.indexOf("?"),e=b.length>d+1;0<=d||(b+="?");for(var d=!0,f=0;f<c.length;f++)if(""!==$(c[f]).value){d=!1;break}for(f=0;f<c.length;f++)b+=e?"&":"",e=!0,b=d?b+this.getLineArgument(this.originalMessage[f],f):b+this.getLineArgument($(c[f]).value,f);a&&a.setAttribute("src",b)};
apple.widget.Engraver.prototype.getLineArgument=function(a,b){var a=this.encode(a),c="th";1==b%2&&(c="tl");return c+"="+a};apple.widget.Engraver.prototype.encode=function(a){try{return encodeURIComponent(a)}catch(b){return escape(a)}};Package("apple.widget");apple.widget.FormFormatter=function(){this.init(".user-form-block .field-with-placeholder > input")};
Object.extend(apple.widget.FormFormatter.prototype,{inlineBlockCompensation:4,init:function(a){a=this.gatherRows(a);this.parseRows(a)},gatherRows:function(a){var b=[];Element.queryAll(a).forEach(function(a){b.push(a.parentNode.parentNode)});return b.distinct()},parseRows:function(a){var b;a.forEach(function(a){b=Element.queryAll(a,"> *");b=this.parseChildren(b);b.adjustable=this.determineRelativeFlexFields(b.adjustable);this.formatRow(a,b)}.bind(this))},parseChildren:function(a){var b={adjustable:[],
nonadjustable:[]},c,d;a.forEach(function(a){c=Element.getDimensions(a).width;0===c&&!this.isEmptyNode(a)&&(c=this.unhideAndCalculate(a));this.isChildATextField(a)&&Element.addClassName(a,"text-input");d=this.isChildATextField(a)&&!this.isFieldWidthDeclared(a)?b.adjustable:b.nonadjustable;d.push({node:a,width:c})}.bind(this));return b},determineRelativeFlexFields:function(a){var b=a.length,c=[],d=0,e,f=0,g=0;if(1===b)a[0].relativeWidth=1;else{a.forEach(function(a){e=Element.query(a.node,"input");d=
e.maxLength;c.push(d);f+=d});for(var h=0;h<b;h++)g=Math.round(100*(c[h]/f)),g/=100,a[h].relativeWidth=g}return a},formatRow:function(a,b){var c=Element.getDimensions(a).width,d=0,e=0,f=0;0===c&&(c=this.unhideAndCalculate(a));b.nonadjustable.forEach(function(a){d+=a.width});e=c-d;b.adjustable.forEach(function(a){f=Math.round(a.relativeWidth*e-this.inlineBlockCompensation);Element.setStyle(a.node,"width",f+"px")}.bind(this))},isChildATextField:function(a){var b=Element.query(a,"input[type=text]"),a=
Element.query(a,"input[type=password]");return b||a?!0:!1},isFieldWidthDeclared:function(a){var b=Element.getDimensions(a).width,c=0,d=Element.getStyle(a,"minWidth");0===b&&(b=this.unhideAndCalculate(a));a.style.width="auto";"0px"!=d&&(a.style.minWidth=0);c=Element.getDimensions(a).width;0===c&&(c=this.unhideAndCalculate(a));a.style.width=b+"px";"0px"!=d&&(a.style.minWidth=d);return b==c?!1:!0},isEmptyNode:function(a){return""===a.innerHTML?!0:!1},unhideAndCalculate:function(a){var b=this.findHiddenParent(a),
c=0;b&&(b.style.display="block",c=Element.getDimensions(a).width,b.style.display="none");return c},findHiddenParent:function(a){var a=a.parentNode,b;if(a==document||!a)return!1;a.style&&(b=a.style.display);return"none"==b?a:this.findHiddenParent(a)}});Package("apple.widget");apple.widget.FormSubmitter=function(a){this.config=a;Event.onDomReady(this.init.bind(this))};
apple.widget.FormSubmitter.prototype.init=function(){this._initialized||(Event.observe(this.getForm(),"onsubmit",function(a){this.formHandler(a)}.bind(this)),Event.observe(this.getSubmit(),"onclick",function(a){this.submitHandler(a)}.bind(this)),this._initialized=!0)};apple.widget.FormSubmitter.prototype.getForm=function(){return $(this.config.formId)?$(this.config.formId):document.forms[this.config.formId]};apple.widget.FormSubmitter.prototype.getSubmit=function(){return $(this.config.submitId)};
apple.widget.FormSubmitter.prototype.formHandler=function(){return!0};apple.widget.FormSubmitter.prototype.submitHandler=function(){return!0};apple.widget.SelectLinkFormSubmitter=apple.widget.FormSubmitter;apple.widget.SelectLinkFormSubmitter.prototype.getSelect=function(){return $(this.config.selectId)};
apple.widget.SelectLinkFormSubmitter.prototype.formHandler=function(){var a=this.getForm(),b=this.getSelect();a&&(b&&b.options&&b.options[b.selectedIndex].value)&&(a.action=b.options[b.selectedIndex].value);return!0};Package("apple.widget");apple.widget.Gallery=function(a){this.config=a;this.index=0;this.config.initial||(this.config.initial=this.getTypeImage());this.setMediaType(this.config.initial);this.setShowingAlt(!1);this.setupImages();this.setupMovies();this.setupFX()};
apple.widget.Gallery.FX_NONE=0;apple.widget.Gallery.FX_PAN=1;apple.widget.Gallery.FX_FADE=2;apple.widget.Gallery.TYPE_IMAGE=100;apple.widget.Gallery.TYPE_MOVIE=101;apple.widget.Gallery.prototype.getFxNone=function(){return apple.widget.Gallery.FX_NONE};apple.widget.Gallery.prototype.getFxPan=function(){return apple.widget.Gallery.FX_PAN};apple.widget.Gallery.prototype.getFxFade=function(){return apple.widget.Gallery.FX_FADE};apple.widget.Gallery.prototype.getTypeImage=function(){return apple.widget.Gallery.TYPE_IMAGE};
apple.widget.Gallery.prototype.getTypeMovie=function(){return apple.widget.Gallery.TYPE_MOVIE};
apple.widget.Gallery.prototype.setupImages=function(){function a(a){c[a]++;window.setTimeout(b.bind(null,a),10)}function b(b){function g(){d[j][b+"Image"]=k;i&&(window.clearTimeout(i),a(b))}function h(){i=0;window.clearTimeout(i);a(b)}var i=0,j=c[b];if(!(j>=e)){var l=d[j][b];if(l){var k=new Image;k.onload=g;k.src=l;i=window.setTimeout(h,2E3)}else a(b)}}if(this.hasImages()){var c={thumb:0,full:0},d=this.config.images,e=d.length;b("thumb");b("full")}};
apple.widget.Gallery.prototype.setupMovies=function(){if(this.hasMovies()){this.config.movie.full||(this.config.movie.full={});this.config.movie.full.elementId||(this.config.movie.full.elementId=Element.uniqueId());for(var a=0;a<this.config.movies.length;a++){if(this.config.movies[a].thumb){var b=new Image;b.src=this.config.movies[a].thumb;this.config.movies[a].thumbImage=b}if(this.config.movies[a].full){var b=this.config.movies[a],c=this.findIdName(b.full);c||(c=this.config.movie.full.elementId+
a,b.full.push("id"),b.full.push(c));b.elementId=c;b.full.push("enablejavascript");b.full.push("true");c=new apple.quicktime.QuickTime(b.full);b.xml=c.generateOBJECTTextXHTML()}}}};apple.widget.Gallery.prototype.setupFX=function(){this.config.fade&&(this.fader=new apple.fx.CrossFade(this.config.fade.speed,this.config.fade.increment));this.config.swoosh&&(this.swoosher=new apple.fx.Swoosh(this.config.viewer.elementId,this.config.swoosh.speed,this.config.swoosh.increment))};
apple.widget.Gallery.prototype.next=function(){this.isShowingImage()?this._showImage(this.index+1,this.getFxPan()):this._showMovie(this.index+1,this.getFxNone())};apple.widget.Gallery.prototype.previous=function(){this.isShowingImage()?this._showImage(this.index-1,this.getFxPan()):this._showMovie(this.index-1,this.getFxNone())};apple.widget.Gallery.prototype.image=function(a){this.isShowingImage()||this.swapMedia();this._showImage(a,this.getFxFade())};
apple.widget.Gallery.prototype.movie=function(a){this.isShowingMovie()||this.swapMedia();this._showMovie(a,this.getFxNone())};apple.widget.Gallery.prototype.hasImages=function(){return this.config.images&&this.config.images.length};apple.widget.Gallery.prototype.hasMovies=function(){return this.config.movies&&this.config.movies.length};apple.widget.Gallery.prototype.isShowingImage=function(){return this.mediaType==this.getTypeImage()};
apple.widget.Gallery.prototype.isShowingMovie=function(){return this.mediaType==this.getTypeMovie()};apple.widget.Gallery.prototype.setMediaType=function(a){this.mediaType=a};
apple.widget.Gallery.prototype.swapMedia=function(){this.stopAnimations();var a=this.getMovieElement(),b=this.getActiveImage();this.isShowingImage()?(Element.hide(b),a.innerHTML="",Element.show(a),this.changeThumbImageState(this.getTypeImage(),this.index,-1),this.setMediaType(this.getTypeMovie())):(Element.show(b),a.innerHTML="",Element.hide(a),this.changeThumbImageState(this.getTypeMovie(),this.index,-1),this.setMediaType(this.getTypeImage()));this.index=-1};
apple.widget.Gallery.prototype._showMovie=function(a){if(a!=this.index&&this.hasMovies()){var b=this.index;a>=this.config.movies.length?a=0:0>a&&(a=this.config.movies.length-1);this.changeThumbImageState(this.getTypeMovie(),b,a);this.stopAnimations();var c=this.getMovieElement();Element.hide(c);try{var d=null;0<=b&&(d=$(this.config.movies[b].elementId));if(d){d.Stop();for(Element.hide(d);c.hasChildNodes();)c.removeChild(c.firstChild);c.innerHTML=""}}catch(e){c.innerHTML=""}c.innerHTML=this.config.movies[a].xml;
Element.show(c);this.index=a}};
apple.widget.Gallery.prototype._showImage=function(a,b){if(a!=this.index&&this.hasImages()){var c=a>=this.index;a>=this.config.images.length?a=0:0>a&&(a=this.config.images.length-1);this.changeThumbImageState(this.getTypeImage(),this.index,a);this.stopAnimations();b==this.getFxFade()?this.fader?this.fadeImage(this.config.images[a]):(this.getActiveImage().src=this.config.images[a].fullImage.src,this.getActiveImage().alt=this.config.images[a].alt):b==this.getFxPan()&&(this.swoosher?this.panImage(c,
this.config.images[a]):(this.getActiveImage().src=this.config.images[a].fullImage.src,this.getActiveImage().src=this.config.images[a].alt));this.index=a}};apple.widget.Gallery.prototype.getActiveImage=function(){return this.isShowingAlt()?this.getAltFullImage():this.getFullImage()};apple.widget.Gallery.prototype.stopAnimations=function(){this.fader&&this.fader.stopAnimation();this.swoosher&&this.swoosher.stopAnimation()};apple.widget.Gallery.prototype.isShowingAlt=function(){return this.showingAlt};
apple.widget.Gallery.prototype.setShowingAlt=function(a){return this.showingAlt=a};apple.widget.Gallery.prototype._resetImages=function(a,b){Element.setOpacity(a,1);Element.setOpacity(b,1)};apple.widget.Gallery.prototype.fadeImage=function(a){var b=!this.isShowingAlt();this.setShowingAlt(b);var c=null,d=null;b?(c=this.getFullImage(),d=this.getAltFullImage()):(c=this.getAltFullImage(),d=this.getFullImage());d.src=a.fullImage.src;d.alt=a.alt;this._resetImages(c,d);this.fader.fade(c,d)};
apple.widget.Gallery.prototype.panImage=function(a,b){var c=!this.isShowingAlt();this.setShowingAlt(c);var d=null,e=null;c?(d=this.getFullImage(),e=this.getAltFullImage()):(d=this.getAltFullImage(),e=this.getFullImage());e.src=b.fullImage.src;e.alt=b.alt;this._resetImages(d,e);this.swoosher.pan(a,d,e)};apple.widget.Gallery.prototype.changeThumbImageState=function(a,b,c){b=this.getThumbAnchor(a,b);a=this.getThumbAnchor(a,c);b&&(b.className=this.config.image.thumb.cssClass);a&&(a.className=this.config.image.thumb.cssActiveClass)};
apple.widget.Gallery.prototype.getFullImage=function(){return $(this.config.image.full.elementId)};apple.widget.Gallery.prototype.getAltFullImage=function(){var a=this.config.image.full.elementId+"Alt",b=$(a);b||(b=this.getFullImage().cloneNode(!1),b.id=a,this.getViewer().appendChild(b));return b};
apple.widget.Gallery.prototype.getMovieElement=function(){var a=this.config.movie.full.elementId,b=$(a);b||(b=document.createElement("div"),b.id=a,Element.setStyle(b,"position","absolute"),Element.setStyle(b,"display","block"),Element.setStyle(b,"left","0px"),Element.setStyle(b,"top","0px"),this.getViewer().appendChild(b));return b};apple.widget.Gallery.prototype.getViewer=function(){return $(this.config.viewer.elementId)};
apple.widget.Gallery.prototype.getThumbAnchorId=function(a,b){var c=null;return c=a==this.getTypeImage()?this.config.image.thumb.elementId+b:this.config.movie.thumb.elementId+b};apple.widget.Gallery.prototype.getThumbAnchor=function(a,b){return $(this.getThumbAnchorId(a,b))};apple.widget.Gallery.prototype.getThumbImage=function(a,b){var c=null;return c=a==this.getTypeImage()?this.config.images[b].thumbImage:this.config.movies[b].thumbImage};
apple.widget.Gallery.prototype.outputImageThumbs=function(){if(this.hasImages()){for(var a=null,a=$(this.config.image.thumb.elementId),b=0;b<this.config.images.length;b++){var c=new apple.widget.Gallery.ClickWrapper(this,b,this.getTypeImage());this.createThumb(a,this.getThumbAnchorId(this.getTypeImage(),b),this.config.images[b].thumbImage.src,!1,this.config.image.thumb,c)}this.isShowingImage()&&(this.index=-1,this._showImage(0,this.getFxNone()))}};
apple.widget.Gallery.prototype.outputMovieThumbs=function(){if(this.hasMovies()){for(var a=null,a=$(this.config.movie.thumb.elementId),b=0;b<this.config.movies.length;b++){var c=new apple.widget.Gallery.ClickWrapper(this,b,this.getTypeMovie());this.createThumb(a,this.getThumbAnchorId(this.getTypeMovie(),b),this.config.movies[b].thumbImage.src,!1,this.config.movie.thumb,c)}this.isShowingMovie()&&(this.index=-1,this._showMovie(0,this.getFxNone()))}};
apple.widget.Gallery.prototype.createThumb=function(a,b,c,d,e,f){b=this.createAnchorNode(b,d,e.cssActiveClass,e.cssClass);b.onclick=function(){f.onClick()};c=this.createImageNode(c,e.width,e.height);b.appendChild(c);a.appendChild(b)};apple.widget.Gallery.prototype.createImageNode=function(a,b,c){var d=document.createElement("img");Element.setStyle(d,"height",c+"px");Element.setStyle(d,"width",b+"px");d.src=a;return d};
apple.widget.Gallery.prototype.createAnchorNode=function(a,b,c,d){var e=document.createElement("a");e.id=a;b?c&&(e.className=c):d&&(e.className=d);return e};apple.widget.Gallery.prototype.findIdName=function(a){for(var b=0;b<a.length;b+=2){var c=a[b].toLowerCase(),d=a[b+1];if("name"==c||"id"==c)return d}return null};apple.widget.Gallery.ClickWrapper=function(a,b,c){this.gallery=a;this.index=b;this.type=c};
apple.widget.Gallery.ClickWrapper.prototype.onClick=function(){this.type==this.gallery.getTypeImage()?this.gallery.image(this.index):this.gallery.movie(this.index)};Package("apple.widget");apple.widget.Gallery2=function(a){this.base("constructor")(a);this._groupThumbs={};this._activeGroup=0;this._imageId=[];this._activeImageIndex=0;this._quicktimeInstalled=!1;this._loadedImages={};this._mediaType=this._mediaClass=null};apple.util.makeSubclass(apple.widget.Gallery2,apple.widget.BaseWidget);
apple.widget.Gallery2.DEFAULTS={activeClass:"active",disabledClass:"disabled",imageClass:"image",mediaClass:"media",movieClass:"movie",thumbGroupClass:"thumbnails",thumbMouseOver:!1,allowWrapping:!0,movieFirstFrame:{pattern:/\.m[o|4]v$/,replace:"-first.jpg"},moviePosterFrame:{pattern:/\.m[o|4]v$/,replace:".jpg"}};apple.widget.Gallery2.prototype.cssClassRegex=/css-class\((.*?)\)/;apple.widget.Gallery2.prototype.movieRegex=/\.m[o|4]v$/;apple.widget.Gallery2.prototype.jsvrRegex=/jsvr$/;
apple.widget.Gallery2.RIGHT="right";apple.widget.Gallery2.LEFT="left";apple.widget.Gallery2.FADE="";
apple.widget.Gallery2.prototype.init=function(){function a(){var a=document.createElement("div"),b=document.createElement("img");a.appendChild(b);b.style.position="absolute";b.style.left="50%";b.style.top="50%";a.style.position="absolute";a.style.left="0";a.style.top="0";a.style.width="100%";a.style.height="100%";a.style.display="none";a.style.zIndex="2";d.appendChild(a);return a}function b(a,b){var c=a.getElementsByTagName("a");Event.observe(a,"click",g);this._groupThumbs[b]=[];Array.forEach(c,function(a){var c=
Element.assignId(a),d=a.href;d==f?(this._activeThumbId=c,this._activeGroup=b,Element.addClassName(a,this.config.activeClass)):Element.removeClassName(a,this.config.activeClass);a._groupIndex=b;this._groupThumbs[b].push(c);d.match(this.movieRegex)&&!this._quicktimeInstalled&&(d.replace(this.config.moviePosterFrame.pattern,this.config.moviePosterFrame.replace),a.href=this._movieFrameSrc(a,this.config.moviePosterFrame))},this)}var c=$(this.config.galleryId);if(c){this._quicktimeInstalled=apple.quicktime.isInstalled();
this._mediaClass=this.config.imageClass;Element.addClassName(c,this.config.imageClass);Element.removeClassName(c,this.config.movieClass);var d=Element.queryAll(c,"."+this.config.mediaClass)[0];if(d){this._mediaId=Element.assignId(d);this._swapper=new apple.fx.ContentSwapper({id:this._mediaId,duration:400});var e=d.getElementsByTagName("img")[0],f=e.src;e.parentNode.removeChild(e);e=a();this._imageId[0]=Element.assignId(e);this._setImage(0,f,this.config.imageClass);e.style.display="";e=a();this._imageId[1]=
Element.assignId(e);this.config.jsvrOptions&&(this._createVrContainer(this.config.jsvrOptions),this._sampleVrImage(this.config.jsvrOptions));this._createNavigation(c);var g=this.thumbClicked.bindAsEventListener(this),e=Element.queryAll(c,"."+this.config.thumbGroupClass);Array.forEach(e,b,this);Event.observe(c,"mousedown",this.mouseDown.bindAsEventListener(this));this._updateNavigation()}}};
apple.widget.Gallery2.prototype._setImage=function(a,b,c,d){var a=$(this._imageId[a]),e=a.firstChild,f=new Image;a.className=c||"";f.onload=function(){this._mediaSize={width:f.width,height:f.height};"devicePixelRatio"in window&&1<window.devicePixelRatio||(e.width=f.width,e.height=f.height);e.src=b;e.style.marginTop=-(f.height/2)+"px";e.style.marginLeft=-(f.width/2)+"px";d&&d.call(this)}.bind(this);f.src=b};
apple.widget.Gallery2.prototype._updateMediaClass=function(a){if(a!=this._mediaClass){var b=$(this.config.galleryId);Element.addClassName(b,a);Element.removeClassName(b,this._mediaClass);this._mediaClass=a}};
apple.widget.Gallery2.prototype._createNavigation=function(a){var b;b=document.createElement("a");b.className="prev";b.href="#";b.onclick=this.prevButtonClicked.bindAsEventListener(this);this._prevButtonId=Element.assignId(b);a.appendChild(b);b=document.createElement("a");b.className="next";b.href="#";b.onclick=this.nextButtonClicked.bindAsEventListener(this);this._nextButtonId=Element.assignId(b);a.appendChild(b)};apple.widget.Gallery2.prototype._getMovie=function(){return $(this._movieId)};
apple.widget.Gallery2.prototype._hideMovie=function(){var a=this._getMovie();a&&!this._playingMovie&&apple.quicktime.mobileSafari?a.parentNode.removeChild(a):this._movieController&&(a.parentNode.style.backgroundImage="",this._movieController.hideMovie())};
apple.widget.Gallery2.prototype._movieLoaded=function(a){$(this.config.galleryId);this._updateMediaClass(this._mediaType);var b=$(this._imageId[this._activeImageIndex]);a.parentNode.className=this._mediaType;a.parentNode.style.backgroundImage="url("+b.firstChild.src+")";this._movieController.showMovie(this._mediaSize.width,this._mediaSize.height);b.style.display="none";this._movieController.play()};
apple.widget.Gallery2.prototype._movieFrameSrc=function(a,b){var b=b||this.config.movieFirstFrame,c=$(a);if(!c)return"";var d=this._stripFolder(c.href),c=c.getElementsByTagName("img")[0];if(!c)return"";var c=c.src,e=c.lastIndexOf("/");if(-1==e)return"";c=[c.substr(0,e),d].join("/");return c.replace(b.pattern,b.replace)};apple.widget.Gallery2.prototype._stripFolder=function(a){var b=a.lastIndexOf("/");return-1==b?a:a.substr(b+1)};
apple.widget.Gallery2.prototype._playMovie=function(a,b){var c=this._movieFrameSrc(this._activeThumbId,apple.quicktime.mobileSafari?this.config.moviePosterFrame:this.config.movieFirstFrame);this._swapImages(c,b,function(){var b=this._getMovie();coherent.Browser.Safari||apple.quicktime.mobileSafari||!b?this._createMovie(a):(this._movieController.hideMovie(),this._movieController.loadMovie(a))}.bind(this))};
apple.widget.Gallery2.prototype._showVr=function(a){this.vr||(this._positionVrContainer(a),this.vr=new apple.VR(a));this.vrContainer.style.display="block";this._updateMediaClass(this._mediaType);$(this._imageId[this._activeImageIndex]).style.display="none"};apple.widget.Gallery2.prototype._hideVr=function(){this.vrContainer&&(this.vrContainer.style.display="none")};
apple.widget.Gallery2.prototype._createVrContainer=function(a){this.vrContainer=document.createElement("div");this.vrContainer.id=a.container;$(this._mediaId).appendChild(this.vrContainer)};
apple.widget.Gallery2.prototype._positionVrContainer=function(){var a=(this.vrContainer.parentNode.offsetWidth-this.sampleVrImage.width)/2,b=(this.vrContainer.parentNode.offsetHeight-this.sampleVrImage.height)/2;this.vrContainer.style.position="absolute";this.vrContainer.style.left=a+"px";this.vrContainer.style.top=b+"px";this.vrContainer.style.width=this.sampleVrImage.width+"px";this.vrContainer.style.height=this.sampleVrImage.height+"px"};
apple.widget.Gallery2.prototype._sampleVrImage=function(a){for(var a=a.imagePath.match(/^([^#]*)(#+)([^#]*)$/),b=a[2].length,c="1";c.length<b;)c="0"+c;a=a[1]+c+a[3];this.sampleVrImage=new Image;this.sampleVrImage.src=a};
apple.widget.Gallery2.prototype._createMovie=function(a){var b=$(this._mediaId),c=document.createElement("div"),d;this._movieId&&(d=$(this._movieId),d.parentNode.removeChild(d));b.appendChild(c);c.style.position="absolute";c.style.left="0";c.style.top="0";c.style.width="100%";c.style.height="100%";c.style.backgroundPosition="center center";c.style.backgroundRepeat="no-repeat";this._movieId=Element.uniqueId();d=apple.quicktime.createMovie({src:a,id:this._movieId,width:this.config.movieWidth,height:this.config.movieHeight,
autoplay:!1,bgcolor:this.config.movieBackground},c);d.style.position="absolute";d.style.left="50%";d.style.top="50%";d.style.marginLeft=-this._mediaSize.width/2+"px";d.style.marginTop=-this._mediaSize.height/2+"px";if(apple.quicktime.mobileSafari)return $(this._movieId);a={movieId:this._movieId,onload:this._movieLoaded.bind(this)};this._movieController=new apple.widget.MovieController(this.config.controllerId,a);this._movieController.hideMovie();return $(this._movieId)};
apple.widget.Gallery2.prototype._swapImages=function(a,b,c){function d(){f.style.display="";this._activeImageIndex=e;this._hideVr();this._hideMovie();this._playingMovie||this._updateMediaClass(this._mediaType);this._swapper.swap(b,f,g,c)}$(this.config.galleryId);var e=this._activeImageIndex?0:1,f=$(this._imageId[this._activeImageIndex]),g=$(this._imageId[e]);f&&g&&(this._movieController&&this._movieController.stop(),g.style.display="none",this._setImage(e,a,this._mediaType,d))};
apple.widget.Gallery2.prototype.showAsset=function(a,b){a.match(this.movieRegex)?(this._playingMovie=!0,this._playMovie(a,b)):a.match(this.jsvrRegex)?this._showVr(this.config.jsvrOptions):(this._playingMovie=!1,this._swapImages(a,b))};
apple.widget.Gallery2.prototype._updateNavigation=function(){var a=this._groupThumbs[this._activeGroup],b=a.indexOf(this._activeThumbId),c=$(this._prevButtonId),d=$(this._nextButtonId);1==a.length?(c.style.display="none",d.style.display="none"):(c.style.display="",d.style.display="",this.config.allowWrapping||(b?Element.removeClassName(c,this.config.disabledClass):Element.addClassName(c,this.config.disabledClass),a.length==b+1?Element.addClassName(d,this.config.disabledClass):Element.removeClassName(d,
this.config.disabledClass)))};apple.widget.Gallery2.prototype._activateThumb=function(a){var b;this._activeThumbId&&(b=$(this._activeThumbId),Element.removeClassName(b,this.config.activeClass));this._activeThumbId=a;b=$(this._activeThumbId);Element.addClassName(b,this.config.activeClass);this._mediaType=(a=(b.rel||"").match(this.cssClassRegex))&&a[1]?a[1]:b.href.match(this.movieRegex)?this.config.movieClass:this.config.imageClass;this._updateNavigation()};
apple.widget.Gallery2.prototype.thumbClicked=function(a){var b=a.target||a.srcElement,c=$(this.config.galleryId);for(Event.stop(a);b&&b!=c&&"a"!=b.nodeName.toLowerCase();)b=b.parentNode;if(b!=c&&(a=b.href))b.blur(),this._activeThumbId!=b.id&&(this._activeGroup=b._groupIndex,this._activateThumb(b.id),this.showAsset(a))};
apple.widget.Gallery2.prototype.nextButtonClicked=function(a){var b=this._groupThumbs[this._activeGroup],c=b.indexOf(this._activeThumbId);Event.stop(a);c++;if(this.config.allowWrapping||c!=b.length)c==b.length&&(c=0),a=b[c],b=$(a).href,this._activateThumb(a),this.showAsset(b,apple.widget.Gallery2.LEFT)};
apple.widget.Gallery2.prototype.prevButtonClicked=function(a){var b=this._groupThumbs[this._activeGroup],c=b.indexOf(this._activeThumbId);Event.stop(a);c--;if(this.config.allowWrapping||!(0>c))0>c&&(c=b.length-1),a=b[c],b=$(a).href,this._activateThumb(a),this.showAsset(b,apple.widget.Gallery2.RIGHT)};apple.widget.Gallery2.prototype.mouseDown=function(a){var b=a.srcElement||a.target,c=this._getMovie();b!=c&&Event.stop(a)};Package("apple.widget");
apple.widget.HelpMessage=Class.create(coherent.Overlay,{__structure__:{},container:Part(".container"),content:Part(".content"),target:Part(".target"),innerHTML:'<div class="container"><table><tr class="t"><td class="l"><span></span></td><td class="m"><span></span></td><td class="r"><span></span></td></tr><tr class="m"><td class="l"></td><td class="msg"><div class="content"></div></td><td class="r"></td></tr><tr class="b"><td class="l"></td><td class="m"></td><td class="r"></td></tr></table><span class="target"></span></div>',
containerAlign:"help-left",displaying:!1,inTimeout:null,inTimeoutFor:250,shouldShow:!0,helpClassName:"help-message",constructor:function(a,b,c){this.base(this.constructWrapper(a),b,c);this.__unposition()},constructWrapper:function(a){a="string"===typeof a?document.getElementById(a):a;this.srcElementId=Element.assignId(a);this.srcElement=a;a=document.createElement("DIV");Element.assignId(a);Element.addClassName(a,this.helpClassName);document.body.appendChild(a);return a},init:function(){var a=this.getSrcElement(),
b=this.viewElement();this.content();this.container();var c=Event.observe;c(a,"mouseover",this.__mouse.bindAsEventListener(this));c(a,"mouseout",this.__mouse.bindAsEventListener(this));c(a,"click",this.__mouse.bindAsEventListener(this));c(b,"mouseout",this.__mouse.bindAsEventListener(this));c(document.body,"touchstart",this.__touchstart.bindAsEventListener(this));c(window,"blur",this.__mouse.bindAsEventListener(this));this.transitionEndListener=this.__transitionEnd.bind(this)},getSrcElement:function(){return this.srcElement||
document.getElementById(this.srcElementId)},__mouse:function(a){this.__clearDelay();this.inTimeout=this.toggle.bindAndDelay(this,this.inTimeoutFor,a.type,a.relatedTarget||a.toTarget)},__touchstart:function(a){a.target.id!==this.srcElementId&&(this.__clearDelay(),this.inTimeout=this.toggle.bindAndDelay(this,this.inTimeoutFor,a.type,a.target))},__clearDelay:function(){window.clearTimeout(this.inTimeout);this.inTimeout=null},__loadContent:function(){var a=this.content(),b=this.container(),c=this.target(),
d=document.getElementById(this.srcElementId),e,f,g;this.loadedContent||(f=document.getElementById(d.getAttribute("rel")),this.loadedContent="<p>This is the default help message. Maybe you need to setup the help message element?</p>",f?(e=f.className,g=f.innerHTML,this.setContentWidth(),this.shouldShow=!0):this.shouldShow=!1,a.innerHTML=g,f=d.cloneNode(!0),f.id=null,f.onclick=null,f.removeAttribute("id"),f.removeAttribute("onclick"),c.innerHTML="",c.onclick='return apple.widget.HelpMessage.click("'+
this.srcElementId+'");',c.appendChild(f),this.loadedContent=a.innerHTML);Element.addClassName(a,e);a.innerHTML=this.loadedContent;b.className="container";Element.hasClassName(d,"top")?Element.addClassName(b,"text-top"):Element.addClassName(b,"text-bottom");Element.hasClassName(d,"left")?Element.addClassName(b,"text-left"):Element.addClassName(b,"text-right")},setContentWidth:function(){var a=document.getElementById(this.srcElementId);(a=document.getElementById(a.getAttribute("rel")).style.width)||
(a="200px");Element.setStyle(this.content(),"width",a)},__position:function(){var a=this.viewElement(),b=this.container();Element.getRect(b);var b=document.getElementById(this.srcElementId),c=Element.getRect(b);Element.setStyles(a,{top:(Element.hasClassName(b,"top")?c.bottom:c.top)+"px",left:(Element.hasClassName(b,"left")?c.right:c.left)+"px"})},__unposition:function(){var a=this.viewElement();Element.setStyles(a,{top:"-9000em",left:"",width:"",height:""})},__transitionEnd:function(){this.container().removeEventListener("webkitTransitionEnd",
this.transitionEndListener,!1);this.__unposition()},toggle:function(a,b){var c=this.viewElement(),d=b;switch(a){case "click":case "mouseover":if(!0===this.displaying)break;this.display();break;case "touchstart":case "mouseout":case "blur":if(!0!==this.displaying)break;do if(d===c)return;while(d=d&&d.parentNode);this.hide()}},display:function(){var a=this.container();this.__loadContent();this.shouldShow&&(this.__position(),(coherent.Browser.Safari||coherent.Browser.MobileSafari)&&"undefined"!=typeof WebKitTransitionEvent?
Element.addClassName(a,"show"):coherent.Animator.addClassName(a,"show",{duration:150}),apple.metrics.fireMicroEvent({feature:"help overlay",part:$(this.srcElementId).getAttribute("rel"),action:"show",eVar:"eVar21"}),this.displaying=!0,this.__clearDelay())},hide:function(){this.viewElement();var a=this.container();(coherent.Browser.Safari||coherent.Browser.MobileSafari)&&"undefined"!=typeof WebKitTransitionEvent?(a.addEventListener("webkitTransitionEnd",this.transitionEndListener,!1),Element.removeClassName(a,
"show")):coherent.Animator.removeClassName(a,"show",{duration:150,callback:this.__unposition.bind(this)});this.displaying=!1;this.__clearDelay()}});apple.widget.HelpMessage.loadAll=function(a,b){2>arguments.length&&(b=a,a=null);Event.onLoad(function(){var c=a?Element.queryAll(a,b):Element.queryAll(a),d=c.length,e,f;for(f=0;f<d;f++)(e=coherent.View.fromNode(c[f]))&&e.teardown(),new apple.widget.HelpMessage(c[f])})};apple.widget.HelpMessage.click=function(a){return($(a)||document.body).onclick()};Package("apple.widget");
apple.widget.HoverManager=function(a,b){if(apple.widget.HoverManager.sharedManager)return apple.widget.HoverManager.sharedManager;apple.widget.HoverManager.sharedManager=this;b=Object.applyDefaults(b,arguments.callee.DEFAULTS);this.configs=a||[];this.hovers=[];this.activeHover=null;this._sourceClickedHandler=this.sourceClicked.bindAsEventListener(this);this._mouseOverHandler=this.mouseOver.bindAsEventListener(this);this._mouseOutHandler=this.mouseOut.bindAsEventListener(this);this._contentClicked=
this.contentClicked.bindAsEventListener(this);this._behaviour=b.behaviour;this._showDelay=b.showDelay;this._hideDelay=b.hideDelay;Event.onDomReady(this.init.bind(this));return this};apple.widget.HoverManager.sharedManager=null;apple.widget.HoverManager.BEHAVIOUR={CLICK_OUTSIDE_TO_CLOSE:1,CLICK_INSIDE_TO_CLOSE:2,MOUSE_OVER_TO_OPEN:4,MOUSE_OUT_TO_CLOSE:8,CLICK_SOURCE_TO_OPEN:16};
apple.widget.HoverManager.DEFAULTS={showDelay:1E3,hideDelay:1E3,behaviour:apple.widget.HoverManager.BEHAVIOUR.CLICK_OUTSIDE_TO_CLOSE|apple.widget.HoverManager.BEHAVIOUR.CLICK_SOURCE_TO_OPEN|apple.widget.HoverManager.BEHAVIOUR.MOUSE_OVER_TO_OPEN|apple.widget.HoverManager.BEHAVIOUR.MOUSE_OUT_TO_CLOSE};
apple.widget.HoverManager.prototype.init=function(){this.configs.forEach(function(a){new apple.widget.Hover(a,this)},this);this._behaviour&apple.widget.HoverManager.BEHAVIOUR.CLICK_OUTSIDE_TO_CLOSE&&(this._bodyClickedHandler=this.bodyClicked.bindAsEventListener(this),Event.observe(document.body,"onclick",this._bodyClickedHandler));Event.onUnload(this.cleanup.bind(this))};
apple.widget.HoverManager.prototype.manageHover=function(a){if(a){var b=$(a.config.sourceId),c=$(a.config.contentId);if(b&&c){var d=this.hovers.length;this.hovers.push(a);b.hoverIndex=d;c.hoverIndex=d;this._behaviour&apple.widget.HoverManager.BEHAVIOUR.CLICK_SOURCE_TO_OPEN&&Event.observe(b,"click",this._sourceClickedHandler);this._behaviour&apple.widget.HoverManager.BEHAVIOUR.MOUSE_OVER_TO_OPEN&&(Event.observe(b,"mouseover",this._mouseOverHandler),Event.observe(c,"mouseover",this._mouseOverHandler),
Event.observe(b,"mouseout",this._mouseOutHandler),Event.observe(c,"mouseout",this._mouseOutHandler));this._behaviour&apple.widget.HoverManager.BEHAVIOUR.CLICK_INSIDE_TO_CLOSE&&Event.observe(c,"click",this._contentClickedHandler)}}};
apple.widget.HoverManager.prototype.cleanup=function(){this.hovers.forEach(function(a){$(a.config.sourceId);a.cleanup()});this.hovers.length=0;this._bodyClickedHandler&&(Event.stopObserving(document.body,"onclick",this._bodyClickedHandler),this._bodyClickedHandler=null);this.cancelShowing();this.cancelHiding()};apple.widget.HoverManager.prototype.findHoverNode=function(a){for(;a&&"BODY"!=a.nodeName;){if("hoverIndex"in a)return a;a=a.parentNode}return null};
apple.widget.HoverManager.prototype.sourceClicked=function(a){var b=this.findHoverNode(a.target||a.srcElement);b&&(this.showHover(b,!0),Event.stop(a))};apple.widget.HoverManager.prototype.bodyClicked=function(a){this.activeHover&&!Event.isMouseOverElement(a,$(this.activeHover.config.contentId))&&(this.hideHover(null,!0),Event.stop(a))};
apple.widget.HoverManager.prototype.mouseOver=function(a){var b=this.findHoverNode(a.srcElement||a.target);b&&(a=this.findHoverNode(a.relatedTarget||a.fromElement),a&&b==a||(b.hasMouse=!0,this.showHover(b.sourceId||b.id)))};
apple.widget.HoverManager.prototype.mouseOut=function(a){var b=this.findHoverNode(a.srcElement||a.target);b&&(a=this.findHoverNode(a.relatedTarget||a.toElement),a&&b==a||(b.hasMouse=!1,b=b.sourceId||b.id,(this._showingSourceId==b||this._behaviour&apple.widget.HoverManager.BEHAVIOUR.MOUSE_OUT_TO_CLOSE)&&this.hideHover(b)))};apple.widget.HoverManager.prototype.contentClicked=function(a){var b=this.findHoverNode(a.srcElement||a.target);b&&(this.hideHover(b.sourceId,!0),Event.stop(a))};
apple.widget.HoverManager.prototype.showHover=function(a,b){function c(){this.cancelShowing();d.show(!0)}if(a=$(a))if(a.id==this._hidingSourceId&&this.cancelHiding(),b&&a.id==this._showingSourceId)this.cancelShowing(),this.activeHover.show(!0);else{var d=this.hovers[a.hoverIndex];d!=this.activeHover&&(this._showing&&this.cancelShowing(),this.activeHover?(this.activeHover.hide(),this.activeHover=d,d.show(),this.cancelHiding()):b?(this.activeHover=d,d.show(!0)):(this.activeHover=d,this._showingSourceId=
a.id,this._showing=window.setTimeout(c.bind(this),this._showDelay)))}};apple.widget.HoverManager.prototype.cancelShowing=function(){window.clearTimeout(this._showing);this._showing=this._showingSourceId=0};apple.widget.HoverManager.prototype.cancelHiding=function(){window.clearTimeout(this._hiding);this._hiding=this._hidingSourceId=0};
apple.widget.HoverManager.prototype.hideHover=function(a,b){function c(){this.cancelHiding();d.hide(!0);this.activeHover=null}a=a||(this.activeHover?this.activeHover.config.sourceId:null);if(a=$(a)){var d=this.hovers[a.hoverIndex];a.id==this._showingSourceId?(this.cancelShowing(),this.activeHover=null):this.activeHover&&d!=this.activeHover?d.hide():b?(d.hide(!0),this.activeHover=null):(this._hidingSourceId=a.id,this._hiding=window.setTimeout(c.bind(this),this._hideDelay))}};
apple.widget.HoverManager.prototype.beforeShowHover=function(){};apple.widget.HoverManager.prototype.beforeHideHover=function(){};Package("apple.widget");var STATES={hidden:0,showing:1,shown:2,hiding:3};
apple.widget.Hover=function(a,b){function c(a,b){for(var c=[];c.length<b;)c=c.concat(a);c.length=b;return c}this.config=Object.applyDefaults(a,apple.widget.Hover.DEFAULTS);this.config.sourcePadding=c(this.config.sourcePadding,4);this.config.contentOffset=c(this.config.contentOffset,4);this.config.pointerOffset=c(this.config.pointerOffset,4);var d=this.config,e;e=[].concat(this.config.allowedLayout||this.config.allowedLayouts).map(function(a){return!("string"===typeof a||a instanceof String)?a:apple.widget.Hover.LAYOUT_NAMES[a]});
d.allowedLayouts=e;this.manager=b||new apple.widget.HoverManager;Event.observe(window,"load",this.init.bind(this))};
apple.widget.Hover.prototype.init=function(){function a(a){Event.observe(a,"onclick",c)}function b(a){var b=Element.getDimensions(a),a=Element.getRect(a,!0);b.left=a.left-f.left;b.top=a.top-f.top;return b}var c=this.close.bindAsEventListener(this);this.currentLayout=apple.widget.Hover.NO_LAYOUT;var d=this._wrapContent();if(d){var e=Element.getElementsByClassName("wdgt-mdl",d)[0];this.config.width&&(d.style.width=this.config.width);e&&this.config.height>=parseInt(Element.getStyles(e,"height"),10)&&
(e.style.height=this.config.height);e=Element.getElementsByClassName("close-link",d);Array.forEach(e,a);e=Element.queryAll(document,"#indicator_hover_content a");Array.forEach(e,a);var f=Element.getRect(d,!0),e=Element.getElementsByClassName("triangle",d);this.pointerInfo=Array.map(e,b);this._state=d&&"none"!=Element.getStyle(d,"display")?STATES.visible:STATES.hidden;this.manager.manageHover(this)}};apple.widget.Hover.prototype.cleanup=function(){};apple.widget.Hover.DEFAULT_SHOW_Z_INDEX=1E3;
apple.widget.Hover.DEFAULT_HIDE_Z_INDEX=999;apple.widget.Hover.NO_LAYOUT=null;apple.widget.Hover.TOP_LAYOUT=0;apple.widget.Hover.RIGHT_LAYOUT=1;apple.widget.Hover.BOTTOM_LAYOUT=2;apple.widget.Hover.LEFT_LAYOUT=3;apple.widget.Hover.DEFAULTS={sourcePadding:[0,0,-2,-10],contentOffset:[20,40],pointerOffset:[8,10],fadeInDuration:300,fadeOutDuration:500,closeLink:"Close",allowedLayouts:[apple.widget.Hover.TOP_LAYOUT,apple.widget.Hover.RIGHT_LAYOUT,apple.widget.Hover.BOTTOM_LAYOUT,apple.widget.Hover.LEFT_LAYOUT]};
apple.widget.Hover.POINTER_INDEX=[3,2,0,1];apple.widget.Hover.LAYOUT_NAMES={top:apple.widget.Hover.TOP_LAYOUT,bottom:apple.widget.Hover.BOTTOM_LAYOUT,left:apple.widget.Hover.LEFT_LAYOUT,right:apple.widget.Hover.RIGHT_LAYOUT};
apple.widget.Hover.prototype._wrapContent=function(){var a=$(this.config.contentId);if(!a)return null;a.parentNode.removeChild(a);a.id="";a.className="";var b=Element.uniqueId(),c=document.createElement("div");c.id=this.config.contentId;c.sourceId=this.config.sourceId;c.className=[a.className,"popup-wdgt"].join(" ");c.innerHTML=['<div class="wdgt-top"><div></div><span class="triangle"></span></div><div class="wdgt-mdl"><div class="wdgt-right"><span class="triangle"></span></div><div class="wdgt-left"><a class="close-link" href="#">',
this.config.closeLink,'</a><div id="',b,'"></div><span class="triangle"></span></div></div><div class="wdgt-btm"><div></div><span class="triangle"></span></div>'].join("");document.body.appendChild(c);b=$(b);b.parentNode.replaceChild(a,b);return c};
apple.widget.Hover.prototype.show=function(a){function b(){this._state=STATES.shown}var c=$(this.config.contentId);if(c){switch(this._state){case STATES.shown:return;case STATES.showing:coherent.Animator.setStyles(c,{opacity:1},{duration:0,cleanup:!0});this._state=STATES.shown;return}c.style.visibility="hidden";c.style.display="block";this.position();this.manager.beforeShowHover(this);this.setContentZIndex(apple.widget.Hover.DEFAULT_SHOW_Z_INDEX);a?(this._state=STATES.showing,Element.setOpacity(c,
0),c.style.visibility="visible",coherent.Animator.setStyles(c,{opacity:1},{duration:this.config.fadeInDuration,callback:b.bind(this),cleanup:!0})):(c.style.display="block",this._state=STATES.shown)}};
apple.widget.Hover.prototype.hide=function(a){function b(){c.style.display="none";this._state=STATES.hidden}var c=$(this.config.contentId);if(c){switch(this._state){case STATES.hidden:return;case STATES.hiding:coherent.Animator.setStyles(c,{opacity:0},{duration:0,callback:b.bind(this),cleanup:!0});this._state=STATES.hidden;return}this.manager.beforeHideHover(this);this.setContentZIndex(apple.widget.Hover.DEFAULT_HIDE_Z_INDEX);a?(this._state=STATES.hiding,coherent.Animator.setStyles(c,{opacity:0},
{duration:this.config.fadeOutDuration,callback:b.bind(this),cleanup:!0})):b.call(this)}};apple.widget.Hover.prototype.toggle=function(){switch(this._state){case STATES.hidden:case STATES.hiding:this.show();break;case STATES.shown:case STATES.showing:this.hide()}};apple.widget.Hover.prototype.close=function(a){this.manager.hideHover(this.config.sourceId,!0);Event.stop(a)};
apple.widget.Hover.prototype._getCurrentPointer=function(){var a=$(this.config.contentId);if(!a)return null;a=Element.getElementsByClassName("triangle",a);return!a?null:a[apple.widget.Hover.POINTER_INDEX[this.currentLayout]]};apple.widget.Hover.prototype._showPointer=function(){var a=this._getCurrentPointer();a&&(a.style.display="block")};apple.widget.Hover.prototype._hidePointer=function(){var a=this._getCurrentPointer();a&&(a.style.display="none")};
apple.widget.Hover.prototype.setContentZIndex=function(a){var b=$(this.config.contentId);b&&(b.style.zIndex=a)};
apple.widget.Hover.prototype._createPositionContext=function(){var a={contentElem:$(this.config.contentId),sourceElem:$(this.config.sourceId),sourcePosition:{left:0,top:0},sourceBox:{height:0,width:0},contentBox:{height:0,width:0}};if(!a.contentElem||!a.sourceElem)return null;a.contentElem.style.left="0";a.contentElem.style.top="0";a.pageOffset=Element.getRect(a.contentElem);a.sourcePosition=Element.getRect(a.sourceElem);a.sourceBox=Element.getDimensions(a.sourceElem);a.contentBox=Element.getDimensions(a.contentElem);
return a};
apple.widget.Hover.prototype._computeContentPosition=function(a,b){var c={left:0,top:0,pointerStyle:"",pointerOffset:0},b=b||this._createPositionContext();if(!b)return c;var d=this.pointerInfo[apple.widget.Hover.POINTER_INDEX[a]];switch(a){case apple.widget.Hover.TOP_LAYOUT:c.top=b.sourcePosition.top-b.contentBox.height-this.config.sourcePadding[a];c.left=b.sourcePosition.left-this.config.contentOffset[a];break;case apple.widget.Hover.BOTTOM_LAYOUT:c.top=b.sourcePosition.top+b.sourceBox.height+this.config.sourcePadding[a];
c.left=b.sourcePosition.left-this.config.contentOffset[a];break;case apple.widget.Hover.LEFT_LAYOUT:c.left=b.sourcePosition.left-b.contentBox.width-this.config.sourcePadding[a]-d.width;c.top=b.sourcePosition.top-this.config.contentOffset[a];break;case apple.widget.Hover.RIGHT_LAYOUT:c.left=b.sourcePosition.left+b.sourceBox.width+this.config.sourcePadding[a]-d.left,c.top=b.sourcePosition.top-this.config.contentOffset[a]}return c};
apple.widget.Hover.prototype._findBestLayout=function(a){a=a||this._createPositionContext();if(!a)return null;var b=a.contentBox.width*a.contentBox.height,c=Element.getViewport();c.bottom=c.top+c.height;c.right=c.left+c.width;var d=null,e=this.config.allowedLayouts.map(function(e){var g=this._computeContentPosition(e,a),h=Math.max(c.top,g.top),i=Math.min(c.bottom,g.top+a.contentBox.height),j=Math.max(c.left,g.left),l=Math.min(c.right,g.left+a.contentBox.width),h=(i-h)*(l-j),e={layout:e,position:g,
overlap:h,fits:h>=b};!d&&e.fits&&(d=e);return e},this);if(1==e.length)return e[0];if(d)return d;e.forEach(function(a){if(!d||a.overlap>d.overlap)d=a});return d};
apple.widget.Hover.prototype.position=function(){var a=this._createPositionContext();if(a){var b=Element.getElementsByClassName("triangle",a.contentElem);Array.forEach(b,function(a){a.style.display="none"});if(b=this._findBestLayout(a))if(this.currentLayout=b.layout,a.contentElem.style.position="absolute",a.contentElem.style.top=b.position.top+"px",a.contentElem.style.left=b.position.left+"px",a=this._getCurrentPointer()){var c=this.pointerInfo[apple.widget.Hover.POINTER_INDEX[b.layout]];switch(b.layout){case apple.widget.Hover.TOP_LAYOUT:case apple.widget.Hover.BOTTOM_LAYOUT:a.style.left=
this.config.pointerOffset[b.layout]+this.config.contentOffset[b.layout]-c.width/2+"px";break;case apple.widget.Hover.LEFT_LAYOUT:case apple.widget.Hover.RIGHT_LAYOUT:a.style.top=this.config.pointerOffset[b.layout]+this.config.contentOffset[b.layout]-c.top-c.height/2+"px"}a.style.display="block"}}};Package("apple.widget");apple.widget.ImageButton=function(a,b){this.base("constructor")(a,b)};apple.util.makeSubclass(apple.widget.ImageButton,apple.widget.BaseWidget);
apple.widget.ImageButton.DEFAULTS={disabledClass:"disabled",activeClass:"active"};
apple.widget.ImageButton.prototype.init=function(){var a=this.widget();a._disabledClass=this.config.disabledClass;this._mousedownHandler=this.mousedown.bindAsEventListener(this);this._mouseupHandler=this.mouseup.bindAsEventListener(this);this._mouseoutHandler=this.mouseout.bindAsEventListener(this);this._mouseoverHandler=this.mouseover.bindAsEventListener(this);a.innerHTML="";Event.observe(a,"mousedown",this._mousedownHandler);apple.widget.ImageButton._checkIds.push(a.id);apple.widget.ImageButton.installDisabledChecker()};
apple.widget.ImageButton.prototype.disable=function(){var a=this.widget();a.disabled=!0;a.disabled?Element.addClassName(a,this.config.disabledClass):Element.removeClassName(a,this.config.disabledClass)};apple.widget.ImageButton.prototype.enable=function(){this.widget().disabled=!1};apple.widget.ImageButton._checkIds=[];
apple.widget.ImageButton.removeDisabledChecker=function(){apple.widget.ImageButton._disabledCheckerTimer&&(window.clearInterval(apple.widget.ImageButton._disabledCheckerTimer),apple.widget.ImageButton._disabledCheckerTimer=0)};
apple.widget.ImageButton.installDisabledChecker=function(){apple.widget.ImageButton._disabledCheckerTimer||(Event.onUnload(apple.widget.ImageButton.removeDisabledChecker),apple.widget.ImageButton._disabledCheckerTimer=window.setInterval(apple.widget.ImageButton.disabledChecker,500))};apple.widget.ImageButton.disabledChecker=function(){apple.widget.ImageButton._checkIds.forEach(function(a){(a=$(a))&&(a.disabled?Element.addClassName(a,a._disabledClass):Element.removeClassName(a,a._disabledClass))})};
apple.widget.ImageButton.prototype.mousedown=function(){var a=this.widget();Element.addClassName(a,this.config.activeClass);Event.observe(a,"mouseout",this._mouseoutHandler);Event.observe(a,"mouseover",this._mouseoverHandler);Event.observe(document,"mouseup",this._mouseupHandler);this._active=!0};
apple.widget.ImageButton.prototype.mouseup=function(){var a=this.widget();Element.removeClassName(a,this.config.activeClass);Event.stopObserving(a,"mouseout",this._mouseoutHandler);Event.stopObserving(a,"mouseover",this._mouseoverHandler);Event.stopObserving(document,"mouseup",this._mouseupHandler);this._active=!1};apple.widget.ImageButton.prototype.mouseover=function(){this._active||Element.addClassName(this.widget(),this.config.activeClass);this._active=!0};
apple.widget.ImageButton.prototype.mouseout=function(){this._active&&Element.removeClassName(this.widget(),this.config.activeClass);this._active=!1};Package("apple.widget");apple.widget.ImageButtonLinks=function(a){this.config=a;Event.onDomReady(this.init.bind(this))};
apple.widget.ImageButtonLinks.prototype.init=function(){if(!this._initialized&&(this._initialized=!0,this.config.buttonIds&&this.config.imageIds&&this.config.buttonIds.length==this.config.imageIds.length))for(var a=0;a<this.config.buttonIds.length&&a<this.config.imageIds.length;a++){var b=$(this.config.buttonIds[a]),c=$(this.config.imageIds[a]);if(b&&c){var d=function(){this.style.backgroundPosition="bottom left"}.bind(b),e=function(){this.style.backgroundPosition="top left"}.bind(b);Event.observe(b,
"onmouseover",d);Event.observe(b,"onmouseout",e);Event.observe(c,"onmouseover",d);Event.observe(c,"onmouseout",e)}}};Package("apple.widget");apple.widget.LinkManager=function(a){this.setConfig(a);coherent.Browser.IE&&Event.observe(window,"load",this.init.bind(this));Event.onDomReady(this.init.bind(this))};apple.widget.LinkManager.prototype.constructor=apple.widget.LinkManager;
apple.widget.LinkManager.DEFAULTS={markerClass:"superlink",hoverClass:"superlink-hover",activeClass:"superlink-active",ignoreClass:"superlink-ignore",disclosureClass:"more",disclosureOpenClass:"open",disclosureRegex:/(?:^|\s)disclosure\(([^)]*)\)(?:$|\s)/,popupWidthRegex:/w(\d+)(-|$)/i,popupHeightRegex:/h(\d+)(-|$)/i,popupPrefix:"popup-",engravingGalleryRel:"engravingGallery",socialSharingRel:"social-sharing",learnMore3GUSRel:"dataPlan3G",learnMore3GRel:"dataPlan"};
apple.widget.LinkManager.prototype.init=function(){window.setTimeout(this.rescanDocument.bind(this),10);Event.observe(document.body,"DOMNodeInserted",this.documentChanged.bindAsEventListener(this));coherent.Browser.IE&&Event.observe(window,"resize",this.documentChanged.bindAsEventListener(this))};apple.widget.LinkManager.prototype.setConfig=function(a){for(var a=a||{},b=this.constructor;b&&Object!==b;b=b.superclass)Object.applyDefaults(a,b.DEFAULTS||{});this.config=a};
apple.widget.LinkManager.prototype.rescanDocument=function(){this.manageLinks(document)};apple.widget.LinkManager.prototype.documentChanged=function(){this._rescanTimer&&window.clearTimeout(this._rescanTimer);this._rescanTimer=window.setTimeout(this.rescanDocument.bind(this),250)};
apple.widget.LinkManager.prototype.getPopupAttributes=function(a){var b={location:-1!=a.indexOf("l")?"yes":"no",menubar:-1!=a.indexOf("m")?"yes":"no",toolbar:-1!=a.indexOf("t")?"yes":"no",status:-1!=a.indexOf("s")?"yes":"no",scrollbars:-1!=a.indexOf("!b")?"no":"yes",resizable:-1!=a.indexOf("!r")?"no":"yes"},c=this.config.popupWidthRegex.exec(a),a=this.config.popupHeightRegex.exec(a);c&&c[1]&&(b.width=c[1]);a&&a[1]&&(b.height=a[1]);var c=[],d;for(d in b)c.push(d+"="+b[d]);return c.join(",")};
apple.widget.LinkManager.prototype.manageLinks=function(){function a(a){var b,v,t;if(!a._managed){a._managed=!0;a.target&&g==a.target.slice(0,g.length)&&(b=this.getPopupAttributes(a.target),a.target=a.target.replace(/[^\w]/g,""),v=this.popupLinkClicked.bindAsEventListener(this,b),Event.observe(a,"click",v));if(Element.hasClassName(a,c)&&(t=d.exec(a.rel))){t=$(t[1]);var z=document.createElement("div");v=Element.assignId(z);var x=Element.hasClassName(a,e);t.parentNode.replaceChild(z,t);z.appendChild(t);
v=this.disclosureLinkClicked.bindAsEventListener(this,v,t);Event.observe(a,"click",v);x||(Element.makeClipping(z),z.style.height="0",t.style.height="auto")}a.rel==h&&Event.observe(a,"click",this.engravingGalleryLinkClicked);a.rel==i&&Event.observe(a,"click",this.socialSharingLinkClicked);(a.rel==j||a.rel==l)&&Event.observe(a,"click",this.learnMore3GLinkClicked);if(Element.hasClassName(a,f)){a:if(v=a.parentNode,v==k)t=null;else{for(;v&&k!=v;){if(Element.hasClassName(v,f)){t=v;break a}v=v.parentNode}t=
a.parentNode}t&&(Element.assignId(t),Element.addClassName(t,f),t._linkId=Element.assignId(a),Event.observe(t,"mouseover",n),Event.observe(t,"mouseout",m),Event.observe(t,"mousedown",r),b?(v=this.parentClicked.bindAsEventListener(this,b),Event.observe(t,"click",v)):Event.observe(t,"click",q),coherent.Browser.IE&&(Event.observe(t,"dragstart",u),Event.observe(t,"selectstart",u)))}}}var b=document.getElementsByTagName("a");if(b.length){var c=this.config.disclosureClass,d=this.config.disclosureRegex,e=
this.config.disclosureOpenClass,f=this.config.markerClass,g=this.config.popupPrefix,h=this.config.engravingGalleryRel,i=this.config.socialSharingRel,j=this.config.learnMore3GUSRel,l=this.config.learnMore3GRel,k=document.body,n=this.mouseOverLink.bindAsEventListener(this),m=this.mouseOutLink.bindAsEventListener(this),r=this.mouseDownLink.bindAsEventListener(this),q=this.parentClicked.bindAsEventListener(this);this.mouseUp=this.mouseUp.bindAsEventListener(this);var u=this.dragStarted.bindAsEventListener(this);
Array.forEach(b,a,this)}};apple.widget.LinkManager.prototype.findAnchor=function(a){for(var b=document.body;a&&b!=a&&!("_linkId"in a);){if("a"==a.tagName.toLowerCase())return a;a=a.parentNode}return null};apple.widget.LinkManager.prototype.findLink=function(a){for(var b=document.body;a&&b!=a&&!(-1<a.className.indexOf(this.config.ignoreClass));){if("_linkId"in a)return a;a=a.parentNode}return null};
apple.widget.LinkManager.prototype.mouseOverLink=function(a){(a=this.findLink(a.target||a.srcElement))&&(this._activeLinkId&&this._activeLinkId!=a.id||(this._activeLinkId==a.id?Element.addClassName(a,this.config.activeClass):Element.addClassName(a,this.config.hoverClass)))};
apple.widget.LinkManager.prototype.mouseOutLink=function(a){if((a=this.findLink(a.target||a.srcElement))&&!(this._activeLinkId&&this._activeLinkId!=a.id))this._activeLinkId==a.id?(Element.removeClassName(a,this.config.activeClass),Element.addClassName(a,this.config.hoverClass)):Element.removeClassName(a,this.config.hoverClass)};
apple.widget.LinkManager.prototype.mouseDownLink=function(a){if(a.which==Event.LEFT_MOUSE&&!Event.isModifiedKey(a)){var b=this.findLink(a.target||a.srcElement);b&&(Event.observe(document,"mouseup",this.mouseUp),this._activeLinkId=b.id,Element.addClassName(b,this.config.activeClass),Element.removeClassName(b,this.config.hoverClass),Event.stop(a))}};
apple.widget.LinkManager.prototype.mouseUp=function(a){Event.stopObserving(document,"mouseup",this.mouseUp);var b=$(this._activeLinkId);this.findLink(a.target||a.srcElement);this._activeLinkId=void 0;b&&(Element.removeClassName(b,this.config.activeClass),Element.removeClassName(b,this.config.hoverClass));this.mouseOverLink(a)};
apple.widget.LinkManager.prototype.popupLinkClicked=function(a,b){if(!this._sendingClick){var c=this.findAnchor(a.target||a.srcElement);window.open(c.href,c.target||"_blank",b||"").focus();Event.preventDefault(a)}};
apple.widget.LinkManager.prototype.parentClicked=function(a,b){if(!Event.isModifiedKey(a)&&!this._sendingClick){var c=a.target||a.srcElement,d=this.findLink(c);if(d&&(c=this.findAnchor(c),!(c&&c.id!=d._linkId)&&(c=c||$(d._linkId)))){Event.stop(a);try{this._sendingClick=!0,Event.sendMouseEvent(c,"click",!0,!0)&&(coherent.Browser.Safari||window.open(c.href,c.target||"_self",b||"").focus(),Event.stop(a))}finally{this._sendingClick=!1}}}};
apple.widget.LinkManager.prototype.dragStarted=function(a){Event.stop(a);return!1};
apple.widget.LinkManager.prototype.disclosureLinkClicked=function(a,b,c){function d(a){a=parseInt(a||0,10);return isNaN(a)?0:a}var e=d(Element.getStyle(c,"border-left-width"))+d(Element.getStyle(c,"border-right-width")),f=d(Element.getStyle(c,"border-top-width"))+d(Element.getStyle(c,"border-bottom-width")),e={width:c.scrollWidth+e,height:c.scrollHeight+f},c=this.findAnchor(a.target||a.srcElement),f=Element.hasClassName(c,this.config.disclosureOpenClass),b=$(b);this.disclosureAnimator&&this.disclosureAnimator.stop();
this.disclosureAnimator=new apple.fx.Animator;f?(b=new apple.fx.Resize(apple.fx.easeInOutSine,b,{width:e.width,height:0},e),Element.removeClassName(c,this.config.disclosureOpenClass)):(this.trackDisclosureClick(b),b=new apple.fx.Resize(apple.fx.easeInOutSine,b,e,{width:e.width,height:0}),Element.addClassName(c,this.config.disclosureOpenClass));this.disclosureAnimator.play(b);Event.stop(a)};
apple.widget.LinkManager.prototype.trackDisclosureClick=function(a){if((a=a.getElementsByTagName("div"))&&0!==a.count){var b=a[0].id,a=window.state,c=window.s||null;c&&(c=apple.metrics.Metrics.getProductSubstring(c.products),b={slot:"",feature:"Learn More",action:"Selected: "+b},b.part="undefined"!=typeof a?a.summary.part:c,apple.metrics.fireMicroEventNoDuplicates(b))}};
apple.widget.LinkManager.prototype.engravingGalleryLinkClicked=function(){var a=window.s||null;a&&(a={slot:"",feature:"Engraving-Gallery",part:apple.metrics.Metrics.getProductSubstring(a.products),action:"Selected"},apple.metrics.fireMicroEventNoDuplicates(a))};
apple.widget.LinkManager.prototype.socialSharingLinkClicked=function(a){var a=a.target.className,b=window.s||null;b&&(b=apple.metrics.Metrics.getProductSubstring(b.products),apple.metrics.fireMicroEventNoDuplicates({slot:"",feature:a,part:b,action:""}),apple.metrics.fireEvent({events:"event7"}))};
apple.widget.LinkManager.prototype.learnMore3GLinkClicked=function(){var a=window.s||null;a&&(a={slot:"",feature:"Learn More 3G",part:apple.metrics.Metrics.getProductSubstring(a.products),action:"Selected"},apple.metrics.fireMicroEventNoDuplicates(a))};window.gLinkManager=new apple.widget.LinkManager;Package("apple.widget");apple.widget.Movie=function(a,b){this.base("constructor")(a,b)};apple.util.makeSubclass(apple.widget.Movie,apple.widget.BaseWidget);
apple.widget.Movie.DEFAULTS={autoplay:!0,loop:!1,wrapperClass:"movieWrapper"};
apple.widget.Movie.prototype.init=function(){if(apple.quicktime.isInstalled()){var a,b=this.widget(),c;if(b){switch(b.tagName.toLowerCase()){case "a":this.config.src=b.href;a=b.parentNode;c=b.getElementsByTagName("img")[0];c=b.removeChild(c);a.replaceChild(c,b);break;case "img":c=b;a=c.parentNode;break;default:console.log("Movie cannot initialise from "+b.tagName+"#"+this.config.id);return}this._posterId=this.config.id+"_poster";this._movieId=this.config.id+"_movie";this.config=Object.applyDefaults(this.config,
{width:c.width,height:c.height});var d=document.createElement("div");d.style.visibility="hidden";d.style.position="relative";d.className=this.config.wrapperClass;d.id=b.id;c=a.replaceChild(d,c);c.id=this._posterId;d.appendChild(c);a={autoplay:!1,id:this._movieId};a=Object.applyDefaults(a,this.config);apple.quicktime.createMovie(a,d);a={movieId:this._movieId,onload:this.movieLoaded.bind(this)};this.controller=new apple.widget.MovieController(this.config.controllerId,a);this.controller.hideMovie();
d.style.visibility="visible"}}};apple.widget.Movie.prototype.movieLoaded=function(a){var b=document.getElementById(this._posterId),c=this.config.width,d=this.config.height,e=this.config.autoplay,f=this.controller;f.hideMovie();coherent.Animator.setStyles(b,{opacity:0},{duration:500,callback:function(){b.style.display="none";f.showMovie(c,d);e&&a.Play()},cleanup:!0})};Package("apple.widget");apple.widget.MovieController=function(a,b){this.base("constructor")(a,b)};
apple.util.makeSubclass(apple.widget.MovieController,apple.widget.BaseWidget);apple.widget.MovieController.DEFAULTS={create:!1,disabledClass:"disabled",activeClass:"active",loadingClass:"loading",errorClass:"error",playingClass:"playing",pausedClass:"paused",onload:function(){},monitorInterval:500,playButtonSpec:"button"};
apple.widget.MovieController.prototype.init=function(){this._duration=0;this._loading=!0;this.monitorProgress();var a=this.widget();if(a){a.style.display="none";Element.addClassName(a,this.config.pausedClass);Element.removeClassName(a,this.config.playingClass);var b=this.part(this.config.playButtonSpec);new apple.widget.ImageButton(b);Event.observe(b,"click",this.playButtonClicked.bind(this));a=a.getElementsByTagName("div")[0];this._meterId=Element.assignId(a);this._meterWidth=a.offsetWidth;Event.observe(a,
"mousedown",this.meterMouseDown.bind(this));a=a.getElementsByTagName("span")[0];this._barId=Element.assignId(a)}};apple.widget.MovieController.prototype._getMovie=function(){return $(this.config.movieId)};
apple.widget.MovieController.prototype._updateMeter=function(a){var b=this.widget();if(b&&!this._vr&&(a=a||this._getMovie())){try{var c=a.GetRate()}catch(d){return}c&&!this._playing?(this._playing=!0,Element.addClassName(b,this.config.playingClass),Element.removeClassName(b,this.config.pausedClass)):!c&&this._playing&&(this._playing=!1,Element.addClassName(b,this.config.pausedClass),Element.removeClassName(b,this.config.playingClass));this._duration||(this._duration=a.GetDuration());if(this._duration&&
(this._meterWidth=$(this._meterId).offsetWidth-4,(b=$(this._barId))&&!(0>this._meterWidth)))a=a.GetTime()*this._meterWidth/this._duration,this._lastLeft!=a&&(this._lastLeft=a,b.style.left=a+"px",b.style.width=this._meterWidth-a+2+"px")}};
apple.widget.MovieController.prototype.monitorProgress=function(){function a(){var a=this._getMovie();a&&(this._duration=a.GetDuration(),this.config.onload(a),this._vr=a.GetIsVRMovie(),c&&(this._vr?coherent.Animator.setStyles(c,{opacity:0},{duration:250,callback:function(){c.style.display="none"},cleanup:!0}):(Element.setOpacity(c,0),c.style.display="",coherent.Animator.setStyles(c,{opacity:1},{duration:250,cleanup:!0}))))}function b(){var b=this._getMovie();if(b)try{var e=(b.GetPluginStatus()||"").split(":")[0].toLowerCase();
this._updateMeter(b);switch(e){case "playable":case "complete":if(!this._loading)break;this._loading=!1;c&&Element.removeClassName(c,this.config.loadingClass);window.setTimeout(a.bind(this),10);break;case "error":c&&(Element.removeClassName(c,this.config.loadingClass),Element.addClassName(c,this.config.errorClass))}}catch(f){}}if(!apple.quicktime.mobileSafari){var c=this.widget();this._monitor=window.setInterval(b.bind(this),this.config.monitorInterval)}};
apple.widget.MovieController.prototype.playButtonClicked=function(){this.part(this.config.playButtonSpec).blur();var a=this._getMovie();a&&(a.GetRate()?a.Stop():a.Play())};apple.widget.MovieController.prototype._updateTimeoutExpired=function(){this._updateTimeFromPosition(this._lastPos)};
apple.widget.MovieController.prototype._updateTimeFromPosition=function(a){var b=this._getMovie();if(b){a-=this._baseX;0>a?a=0:a>this._meterWidth&&(a=this._meterWidth);var c=$(this._barId);c&&(c.style.left=a+"px",c.style.width=this._meterWidth-a+2+"px");a=b.GetDuration()*a/this._meterWidth;b.SetTime(a);this._moveTimeout=0}};
apple.widget.MovieController.prototype.meterMouseUp=function(a){Event.stopObserving(document,"mouseup",this._mouseUpHandler);Event.stopObserving(document,"mousemove",this._mouseMoveHandler);this._updateTimeFromPosition((a||window.event).clientX);(a=this._getMovie())&&this._previousRate&&a.Play()};apple.widget.MovieController.prototype.meterMouseMoved=function(a){this._lastPos=(a||window.event).clientX;this._moveTimeout=this._moveTimeout||window.setTimeout(this._updateHandler,10)};
apple.widget.MovieController.prototype.meterMouseDown=function(a){var a=a||window.event,b=this._getMovie(),c=$(this._meterId);b&&(this._previousRate=b.GetRate(),b.Stop(),this._baseX=Element.getRect(c,!0).left-document.body.scrollLeft-document.documentElement.scrollLeft,this._updateHandler=this._updateTimeoutExpired.bind(this),this._mouseMoveHandler=this.meterMouseMoved.bind(this),this._mouseUpHandler=this.meterMouseUp.bind(this),Event.observe(document,"mousemove",this._mouseMoveHandler),Event.observe(document,
"mouseup",this._mouseUpHandler),Event.stop(a),this._updateTimeFromPosition(a.clientX))};apple.widget.MovieController.prototype.hideMovie=function(){var a=this._getMovie();if(a&&(a.width=1,a.height=1,a.style.width="1px",a.style.height="1px",a=this.widget()))a.style.display="none"};apple.widget.MovieController.prototype.showMovie=function(a,b){var c=this._getMovie();if(c&&(c.width=a,c.height=b,c.style.width=a+"px",c.style.height=b+"px",c=this.widget()))c.style.display=""};
apple.widget.MovieController.prototype.stop=function(){var a=this._getMovie();a&&a.Stop()};apple.widget.MovieController.prototype.play=function(){var a=this._getMovie();a&&a.Play()};apple.widget.MovieController.prototype.loadMovie=function(a){var b=this._getMovie();if(b){var c=this.widget();c&&Element.addClassName(c,this.config.loadingClass);this._loading=!0;try{b.Stop(),b.SetURL(a),b.SetAutoPlay(!1),b.SetControllerVisible(!1)}catch(d){console.log("SetURL: "+d.message)}}};Package("apple.widget");
apple.widget.ProductCluster=function(a){function b(){window.clearInterval(this._firefoxTimer)}function c(){Event.onUnload(b.bind(this));this._firefoxTimer=window.setInterval(this.checkScroll.bind(this),2E3)}this.config=a;this.resetPages();if(coherent.Browser.Mozilla)Event.onDomReady(c.bind(this));Event.observe(window,"scroll",this.checkScroll.bind(this));Event.observe(window,"load",this.checkScroll.bind(this))};
apple.widget.ProductCluster.prototype.encodeURL=function(a,b){b||(b=this.config.baseURL);for(var c in a){var d=a[c];d&&d.length&&(b=0<b.indexOf("?")?b+("&"+c+"="+d):b+("?"+c+"="+d))}return b};apple.widget.ProductCluster.prototype.gotoPage=function(a,b,c,d){var a=this.encodeURL({p:a,f:b,s:c,n:d}),e=this;apple.io.json.invoke({url:a,success:function(a){e.switchContent(e.config.contentId,a)}});return!1};
apple.widget.ProductCluster.prototype.sort=function(a,b,c){var a=this.encodeURL({f:a,s:b,n:c}),d=$("product-loading-sort");d&&(d.style.display="inline");var e=this;apple.io.json.invoke({url:a,success:function(a){e.config.sort=b;e.switchContent(e.config.contentId,a);d&&(d.style.display="none")}});return!1};
apple.widget.ProductCluster.prototype.gotoNode=function(a,b){var c=this.encodeURL({n:a,s:b}),d=$("product-loading-filter");d&&(d.style.display="inline");var e=this;apple.io.json.invoke({url:c,success:function(c){e.config.childNode=a;e.config.sort=b;e.switchContent(e.config.contentId,c);d&&(d.style.display="none")}});return!1};
apple.widget.ProductCluster.prototype.gotoFilter=function(a,b,c){var d=this.encodeURL({f:a,s:c,n:b}),e=this;apple.io.json.invoke({url:d,success:function(d){e.config.filter=a;e.config.sort=c;e.config.childNode=b;e.switchContent(e.config.contentId,d)}});return!1};apple.widget.ProductCluster.prototype.resetPages=function(){this.checkingScroll=!1;this.pagePositions=[];this.loadedPages=[]};
apple.widget.ProductCluster.prototype.loadPage=function(a){if(!this.loadedPages[a]){this.loadedPages[a]=1;var b=this.encodeURL({p:""+a,f:this.config.filter,s:this.config.sort,n:this.config.childNode},this.config.pageURL),c=this;apple.io.json.invoke({url:b,success:function(b){var e=c.config.pageIdPrefix+a+c.config.pageIdSuffix,f=c.config.pageIdPrefix+a;c.switchContent(e,b);a=$(f);var g=$(e);Element.setOpacity(g,0);g.style.display="";coherent.Animator.setStyles(g,{opacity:1},{duration:600,cleanup:!0,
callback:function(){if(Element.getMarginBox(a).height<Element.getMarginBox(g).height){var b=Element.getMarginBox(g);b.height++;Element.setMarginBox(a,b)}}})}})}};
apple.widget.ProductCluster.prototype.checkScroll=function(){if(!this.checkingScroll){this.checkingScroll=!0;for(var a=Element.getViewport().top,b=a+Element.getViewport().height+this.config.scrollBuffer,a=a-this.config.scrollBuffer,c=this.config.pages-1;1<=c;c--){var d=this.config.pageIdPrefix+c;if(!this.pagePositions[c]){var e=$(d);e&&(this.pagePositions[c]=Element.getRect(e).top)}d=Element.getMarginBox($(d));a<=this.pagePositions[c]+d.height&&b>=this.pagePositions[c]&&this.loadPage(c)}this.checkingScroll=
!1}};
apple.widget.ProductCluster.prototype.setupEmptyPages=function(a,b,c,d,e,f){this.config.pages=b;this.resetPages();var g="";this.config.loadingIconUrl&&(g='<img class="product-loading-tile" src="'+this.config.loadingIconUrl+'">');for(var h="",i=1;i<this.config.pages;i++){var h=h+('<div class="product-page" id="'+this.config.pageIdPrefix+i+'">\n'),h=h+('<div class="product-page-grid hidden" id="'+this.config.pageIdPrefix+i+this.config.pageIdSuffix+'"></div>\n'),j=d;i==this.config.pages-1&&(j=e);for(var l,
k=0;k<j;k++){l=(i-1)*d+k in f;h=k==j-1&&i==this.config.pages-1?h+'<ul class="product-row last-row':h+'<ul class="product-row';h+=l?' has-specials">':'">';h+='<li class="product first-tile">'+g+"</li>";for(l=1;l<c-1;l++)h+='<li class="product">'+g+"</li>";h+='<li class="product last-tile">'+g+"</li>";h+="</ul>\n"}h+="</div>\n"}$(a).innerHTML=h;if(coherent.Browser.MobileSafari)for(a=1;a<b;a++)this.loadPage(a)};
apple.widget.ProductCluster.prototype.switchContent=function(a,b){b.body.content&&($(a).innerHTML=b.body.content)};Package("apple.widget");apple.widget.ProductDetailsContentMenu=Class.create(coherent.View,{init:function(){var a=Element.queryAll("#contents ul li a");Array.forEach(a,function(a){var c=a.getAttribute("href");null===Element.query(c)&&(a.parentNode.style.display="none")})}});Package("apple.widget");
apple.widget.ProductFilter=function(a,b){this.base("constructor")(a,b);this._expanded=!1;this._filters=[];this._selectionIndex=-1};apple.util.makeSubclass(apple.widget.ProductFilter,apple.widget.BaseWidget);apple.widget.ProductFilter.DEFAULTS={expandedClass:"expanded",controlSpec:"ul.filter-controls",expandLinkSpec:".expand-link",secondaryFilterClass:"secondary",contractLinkSpec:".contract-link",selectedClass:"selected",filterListSpec:"ul.filter-items",animateDuration:50};
apple.widget.ProductFilter.prototype.init=function(){function a(a,b){this._filters.push(Element.assignId(a));Element.hasClassName(a,this.config.selectedClass)&&(this._selectionIndex=b);a.filterIndex=b;!this._expanded&&(!Element.hasClassName(a,this.config.selectedClass)&&Element.hasClassName(a,this.config.secondaryFilterClass))&&(a.style.display="none")}var b=this.widget(),c=this.part(this.config.filterListSpec),d=this.part(this.config.controlSpec);if(b&&c&&d){d.style.display="block";this._expanded=
Element.hasClassName(b,this.config.expandedClass);this._animator=new apple.fx.Animator;var d=this.part(this.config.expandLinkSpec),e=this.part(this.config.contractLinkSpec);d&&e&&(Event.observe(d,"click",this.expandLinkClicked.bindAsEventListener(this)),Event.observe(e,"click",this.contractLinkClicked.bindAsEventListener(this)),d=this.filterClicked.bindAsEventListener(this),Event.observe(c,"click",d),Array.forEach(c.getElementsByTagName("li"),a,this),b.style.display="none",b.style.display="block")}};
apple.widget.ProductFilter.prototype.expandFilters=function(a){function b(){f.style.visibility="";g.style.visibility="";Element.addClassName(d,this.config.expandedClass);this._expanded=!0;a&&a()}var c=[],d=this.widget(),e=this.part(this.config.filterListSpec).getElementsByTagName("li")[0].offsetWidth,f=this.part(this.config.expandLinkSpec),g=this.part(this.config.contractLinkSpec);f.style.visibility="hidden";g.style.visibility="hidden";this._filters.forEach(function(a,b){var d=$(a);if(!(b==this._selectionIndex||
Element.hasClassName(d,this.config.selectedClass)||!Element.hasClassName(d,this.config.secondaryFilterClass))){d.style.width=e+"px";d.style.height="auto";var f=Element.getDimensions(d);d.style.width="";f=new apple.fx.Resize(apple.fx.easeInOutSine,d,f,{width:e,height:0});d=new apple.fx.Fade(apple.fx.linearTween,d,0,1);c.push(new apple.fx.Blend(f,d))}},this);c.length&&(this._animator.setDuration(c.length*this.config.animateDuration),this._animator.play(new apple.fx.Chain(c),b.bind(this)))};
apple.widget.ProductFilter.prototype.contractFilters=function(a){function b(){f.style.visibility="";g.style.visibility="";Element.removeClassName(d,this.config.expandedClass);this._expanded=!1;a&&a()}var c=[],d=this.widget(),e=this.part(this.config.filterListSpec).getElementsByTagName("li")[0].clientWidth,f=this.part(this.config.expandLinkSpec),g=this.part(this.config.contractLinkSpec);f.style.visibility="hidden";g.style.visibility="hidden";this._filters.forEach(function(a,b){var d=$(a);if(!(b==this._selectionIndex||
Element.hasClassName(d,this.config.selectedClass)||!Element.hasClassName(d,this.config.secondaryFilterClass))){d.style.width=e+"px";var f=Element.getDimensions(d);d.style.width="";f=new apple.fx.Resize(apple.fx.easeInOutSine,d,{width:e,height:0},f);d=new apple.fx.Fade(apple.fx.linearTween,d,1,0);c.push(new apple.fx.Blend(f,d))}},this);c.length&&(this._animator.setDuration(c.length*this.config.animateDuration),this._animator.play(new apple.fx.Chain(c),b.bind(this)))};
apple.widget.ProductFilter.prototype.selectFilter=function(a){if(a!=this._selectionIndex){var b=this._filters[this._selectionIndex],c=this._filters[a];this._selectionIndex=a;b&&Element.removeClassName($(b),this.config.selectedClass);c&&Element.addClassName($(c),this.config.selectedClass)}};apple.widget.ProductFilter.prototype.expandLinkClicked=function(a){(a.target||a.srcElement).blur();Event.stop(a);this.expandFilters()};
apple.widget.ProductFilter.prototype.contractLinkClicked=function(a){(a.target||a.srcElement).blur();Event.stop(a);this.contractFilters()};apple.widget.ProductFilter.prototype.findFilterNode=function(a){for(var b=this.widget();a!=b&&!("filterIndex"in a);)a=a.parentNode;return!("filterIndex"in a)?null:a};
apple.widget.ProductFilter.prototype.filterClicked=function(a){var b=a.target||a.srcElement;b.blur();Event.stop(a);if(a=this.findFilterNode(b))this.selectFilter(a.filterIndex),this._expanded?this.contractFilters(this.filterContent.bind(this)):this.filterContent()};apple.widget.ProductFilter.prototype.filterContent=function(){var a=$(this._filters[this._selectionIndex]);a&&(a=a.getElementsByTagName("a")[0])&&window.open(a.href,"_self")};Package("apple.widget");
apple.widget.ProductTrailer=Class.create(coherent.View,{__structure__:{"a.video-trailer":coherent.Anchor({action:"createOverlay"})},trailerInnerHTML:'<div class="trailer-overlay"><div class="video"><a href="">Placeholder</a></div></div>',init:function(){},createOverlay:function(){var a=document.getElementById("trailerOverlay"),b=Element.query("a.video-trailer").href;this.trailerOverlay||(this.trailerOverlay=new coherent.Overlay(a));this.trailerOverlay.display({classname:"overlay",html:this.trailerInnerHTML});
this.videoSource=Element.query(".video a");this.videoSource.setAttribute("href",b);this.videoController()},videoController:function(){if(!this.videoPlayer){console.log(this);var a=Element.query(".trailer-overlay .video"),b=this.videoSource.href;delete coherent.View.viewLookup["volume-track"];delete coherent.View.viewLookup["control-track"];if(this.videoPlayer=Media.create(a,b,{autoplay:"true",width:320,height:240})){coherent.Browser.MobileSafari||(this.videoControls=new Media.ControlsWidget(a),this.videoPlayer.setControlPanel(this.videoControls));
var b=function(){c.parentNode.removeChild(c);a.appendChild(this.videoPlayer.video().object());a.appendChild(this.videoControls.element);this.videoControls.play()}.bind(this),c=document.createElement("div");Element.addClassName(c,"endstate");Event.observe(c,"click",b);this.videoPlayer.setDelegate({didEnd:function(){this.videoControls.pause();this.videoPlayer.setTime(0);this.videoPlayer.reset();a.appendChild(c);a.removeChild(this.videoControls.element);a.removeChild(this.videoPlayer.video().object())}.bind(this)})}}},
overlayVisibleChange:function(a){a.newValue||this.videoControls.pause()}});Package("apple.widget");
apple.widget.SchoolFinder=Class.create(coherent.View,{__structure__:{"#loading":coherent.View({visibleBinding:"loading"}),"div#instructions":coherent.View({visibleBinding:"lastQuery(not)"}),"div#no-results":coherent.View({visibleBinding:"noResults"}),"table#schools-table":coherent.ListView({contentBinding:"results.schools",visibleBinding:"schoolCount",selectedObjectBinding:"school"}),"table#schools-table td.name":coherent.View({htmlBinding:"*.name"}),"table#schools-table td.location":coherent.View({htmlBinding:"*.location"}),
"table#schools-table td.level":coherent.View({htmlBinding:"*.type"}),"#filter-HiEd":coherent.ToggleButton({selectionBinding:"filterSelection"}),"#filter-K12":coherent.ToggleButton({selectionBinding:"filterSelection"}),"#schoolQuery":coherent.TextField({valueBinding:"query",action:"submitQuery",sendsActionOnEndEditing:!1}),"#schoolSearch":coherent.Button({action:"submitQuery",visibleBinding:"loading(not)"}),"#resultCount ":coherent.View({visibleBinding:"schoolCount"}),"#resultCount span":coherent.View({htmlBinding:"schoolCount"}),
"div.more-information":coherent.View({visibleBinding:"lastQuery",animated:!0}),"#school-submit":coherent.Button({animated:!0,visibleBinding:"school",action:"goToSchool"})},keyDependencies:{schoolCount:["results"],noResults:["results","loading","lastQuery"]},init:function(){if(coherent.Browser.IE)Event.onDomReady(function(){$("filter-HiEd").checked=!0;$("filter-K12").checked=!1});this.lastType="HiEd";this.setValueForKey("HiEd","filterSelection");this.addObserverForKeyPath(this,this.resultsChanged,
"results");this.addObserverForKeyPath(this,this.submitQuery,"filterSelection");Event.observe($("schoolQuery"),"click",this.textFieldClicked.bind(this));Event.observe(window,"load",function(){$("schoolQuery").focus()});if(coherent.Browser.MobileSafari){var a=Element.query("div.search-results");Element.addClassName(a,"flexible")}},textFieldClicked:function(){""===$("schoolQuery").value&&(this.setValueForKey(null,"query"),this.setValueForKey(null,"lastQuery"),this.setValueForKey(coherent.KVO.adaptTree({schools:[]}),
"results"))},schoolCount:function(){return this._results&&"schools"in this._results?this._results.schools.length:0},noResults:function(){return 0===this.schoolCount()&&this.lastQuery&&!this.loading},resultsChanged:function(){this.setValueForKey(null,"school");apple.behavior.Striper.delay(0,$("schools-table"))},getResults:function(){return this._results},setResults:function(a){a.schools&&a.schools.forEach(function(a){a.setValueForKey(a.city+", "+a.state+" "+a.zipcode,"location")});this._results=a;
(a=Element.query(this.viewElement(),"div.search-results td"))&&a.scrollIntoView()},submitQuery:function(){var a=this.query,b=this.valueForKey("filterSelection");if(!(a===this.lastQuery&&b===this.lastType)&&a){var c={query:a,type:b},d=this.queryReturned.bind(this),e=this.queryFailed.bind(this);this.setValueForKey(!0,"loading");JSONRPC.get(this.queryURL,c).addMethods(d,e);this.lastType=b;this.setValueForKey(a,"lastQuery")}},queryReturned:function(a){this.valueForKey("filterSelection");this.setValueForKey(!1,
"loading");this.setValueForKey(coherent.KVO.adaptTree(a),"results")},queryFailed:function(){this.setValueForKey(!1,"loading");this.setValueForKey(coherent.KVO.adaptTree({schools:[]}),"results")},goToSchool:function(){window.location=this.school.url}});Package("apple");
apple.SiteSearch=Class.create(coherent.Form,{defaultOptions:{suggestionsEnabled:!1,suggestionsUrl:null,dropDownMenuClassName:"search-auto-complete",selectedClassName:coherent.Browser.MobileSafari?"iosHighlight":"selected",initialKeypressDelay:50,keypressDelay:250,showDelay:200,closeDelay:500,requestTimeOut:5E3,text:{searchHeading:"B\u00fasquedas",productHeading:"Productos",categoryHeading:"Categor\u00edas"}},dataBinding:[],markupTemplate:"<ul></ul>",searchFieldset:coherent.View(".sitesearch-wrapper",
{}),searchField:coherent.TextField('input[type="text"]',{valueBinding:"searchValue"}),__structure__:{".search-reset":coherent.Anchor({visibleBinding:"showReset",action:"resetSearchField"}),".search-spinner":coherent.View({visibleBinding:"showSpinner"})},dropDownItemMaxWidth:void 0,formSubmissionStarted:!1,onsubmit:function(a){Event.stop(a);this.options.suggestionsEnabled||this.fireMetricsAndSubmit()},init:function(){this.base();this.options=Object.applyDefaults(this.options,this.defaultOptions);this.setupSearchField();
this.options.suggestionsEnabled&&(this.enableKeyboardObservers(),this.buildDropDownMenu());this.toggleResetButton();this.requestCounter=0;this._hiddenParams=this._hiddenParamQueryString()},setupSearchField:function(){"site-search"!==this.viewElement().id&&(this.searchField.nullPlaceholder=this.searchField.viewElement().getAttribute("placeholder"),apple.behavior.TextFieldPlaceholder(this.searchField));this.searchField.viewElement().removeAttribute("placeholder");Event.observe(this.searchField.viewElement(),
"focus",this.focus.bind(this));Event.observe(this.searchField.viewElement(),"blur",this.blur.bind(this));var a=Element.query(this.viewElement(),"button[type=submit]");if(a&&this.options.suggestionsEnabled){Event.observe(a,"keypress",this.killReturn.bind(this));var b=this;Event.observe(a,"click",function(){b.select()});Event.observe(a,"keypress",function(a){a.keyCode===Event.KEY_RETURN&&b.select()})}},killReturn:function(a){a.keyCode===Event.KEY_RETURN&&Event.preventDefault(a)},enableKeyboardObservers:function(){Event.observe(this.searchField.viewElement(),
"keydown",this.keydown.bind(this));Event.observe(this.searchFieldset.viewElement(),"keypress",this.keypress.bind(this));Event.observe(this.searchField.viewElement(),"keyup",this.keyup.bind(this));Event.observe(this.searchField.viewElement(),"paste",this.paste.bind(this));Event.observe(this.searchFieldset.viewElement(),"keypress",this.killReturn.bind(this));Event.observe(this.searchField.viewElement(),"text",this.keyup.bind(this))},buildDropDownMenu:function(){var a=document.createElement("div");this.dropDownMenuId=
Element.assignId(a);a.className=this.options.dropDownMenuClassName;Element.setStyle(a,"display","none");a.innerHTML=this.markupTemplate;this.searchFieldset.viewElement().appendChild(a);a=a.getElementsByTagName("ul")[0];this.resultsListId=Element.assignId(a);Event.observe(a,"mousedown",this.selectOnClick.bindAsEventListener(this));Event.observe(a,"mouseover",this.selectMenuItem.bindAsEventListener(this))},focus:function(){Element.addClassName(this.searchFieldset.viewElement(),"focused")},blur:function(){this.hide();
Element.removeClassName(this.searchFieldset.viewElement(),"focused")},keydown:function(a){switch(a.keyCode){case Event.KEY_UP:case Event.KEY_DOWN:if(this.resultsVisible){switch(a.keyCode){case Event.KEY_UP:this.activatePrev();break;case Event.KEY_DOWN:this.activateNext()}Event.stop(a)}}},keyup:function(a){switch(a.keyCode){case Event.KEY_ESC:this.hide();Event.stop(a);break;case Event.KEY_RETURN:this.formSubmissionStarted||this.preprocessRequest();Event.stop(a);break;default:Event.isMetaKey(a)||this.preprocessRequest()}this.toggleResetButton()},
keypress:function(a){switch(a.keyCode){case Event.KEY_RETURN:this.select()}},paste:function(){var a=this;(function(){a.preprocessRequest()}).delay(10)},toggleResetButton:function(){0<this.searchField.viewElement().value.length?this.setValueForKey(!0,"showReset"):this.setValueForKey(!1,"showReset")},resetSearchField:function(){this.setValueForKey("","searchValue");this.toggleResetButton();this.searchField.viewElement().focus();this.hide()},preprocessRequest:function(){var a;3>this.requestCounter?a=
this.options.initialKeypressDelay:a=this.options.keypressDelay;this.setValueForKey(this.searchField.viewElement().value.replace(/^\s+$/,""),"searchValue");1>this.searchValue.length?this.processNoResults():(this.keyupTimeout&&(window.clearTimeout(this.keyupTimeout),this.keyupTimeout=null),this.keyupTimeout=this.requestSuggestionsFor.bindAndDelay(this,a,this.searchValue))},requestSuggestionsFor:function(a){this.cancelOutstanding();window.navigator.onLine&&(this.requestCounter+=1,this.setValueForKey(!0,
"showSpinner"),a={query:a},this.jsonpresponse=JSONRPC.get(this.options.suggestionsUrl,null,{params:a,callbackParamName:"method",enableCache:!0,protocol:"JSONP"}),this.jsonpresponse.addCallback(this.processJSONPResponse.bind(this)),this.__waitingTimer=this.cancelOutstanding.bindAndDelay(this,this.options.requestTimeOut))},processJSONPResponse:function(){this.resetSelection();this.__waitingTimer&&window.clearTimeout(this.__waitingTimer);if(0<this.searchValue.length&&this.jsonpresponse&&this.jsonpresponse._result){var a=
this.jsonpresponse._result;this.query=a.query.toLowerCase();a&&a.results&&(a.results.category&&a.results.category.length||a.results.product&&a.results.product.length||a.results.search&&a.results.search.length)?this.changeData(a.results):this.processNoResults()}else this.processNoResults()},cancelOutstanding:function(){try{this.jsonpresponse&&this.jsonpresponse.cancel()}catch(a){}this.__waitingTimer&&window.clearTimeout(this.__waitingTimer);this.processNoResults()},addSectionList:function(a,b){var c,
d,e='<li class="section"><p>'+this.options.text[a+"Heading"]+"</p></li>";this.dataBinding.push({});for(var f=0,g=b.length;f<g;f++)c=Object.applyDefaults(b[f],{section:a,rank:f+1,resultCount:g}),this.dataBinding.push(c),c=d=this.sanitizeHtml(b[f].term),d=d.replace(/\"/g,"&quot;"),e="search"===a?e+('<li><span title="'+d+'">'+c+"</span></li>"):e+('<li><span title="'+d+'"><a>'+c+"</a></span></li>");return e},changeData:function(a){var b=$(this.resultsListId),c=b.innerHTML="";this.dataBinding=[];0<a.search.length&&
(c+=this.addSectionList("search",a.search));0<a.product.length&&(c+=this.addSectionList("product",a.product));0<a.category.length&&(c+=this.addSectionList("category",a.category));c&&(b.innerHTML=c,this.changeSelectedIndex(null),a=$(this.dropDownMenuId),Element.setStyle(a,"display",""),this.resultsVisible=!0,this.truncateAndHighlight(b),this.setValueForKey(!1,"showSpinner"))},sanitizeHtml:function(a){var b=document.createElement("textarea");b.innerHTML=a;return b.value},truncateAndHighlight:function(a){var b,
c,d=this.dropDownItemMaxWidth,e,f,g,h=document.documentElement.style,h="textOverflow"in h||"OTextOverflow"in h,i=0,j=a.childNodes.length;for(;i<j;i++)if("section"!==a.childNodes[i].className){b=a.childNodes[i];b.setAttribute("menuIndex",i);if((b=b.getElementsByTagName("span"))&&0<b.length)c=b[0],void 0===d&&(d=parseInt(Element.getStyle(c,"width"),10),this.dropDownItemMaxWidth=d=isNaN(d)?0:d),(b=c.getElementsByTagName("a"))&&0<b.length&&(c=b[0]);h||apple.util.addOverflowEllipsis(c,d);b=c.textContent||
c.innerText;e=this.dataBinding[i].highlights;var l="",k;for(k=e.length-1;0<=k;k--)f=e[k][0],g=e[k][1],f<b.length&&(l="<strong>"+b.substring(f,g)+"</strong>"+b.substring(g)+l,b=b.substring(0,f));c.innerHTML=b+l}},selectMenuItem:function(a){var b=Element.locateAncestor(a.target||a.srcElement,function(a){return"LI"===a.tagName});b&&(this.changeSelectedIndex(b.getAttribute("menuIndex")),Event.stop(a))},changeSelectedIndex:function(a){var b=$(this.resultsListId).childNodes,c=null!==a&&!isNaN(a)&&0>a?b.length-
1:a,d=this.selectedIndex,e=this.options.selectedClassName;null!==d&&(!isNaN(d)&&0<=d)&&(Element.removeClassName(b[d],e),forceRedraw(b[d]));null!==c&&!isNaN(c)?(a=b[c%b.length],this.listItemHasHeading(a)?this.skipSectionHeading(d,c):(Element.addClassName(b[c%b.length],e),forceRedraw(b[c%b.length]),this.selectedIndex=c%b.length)):this.selectedIndex=c},skipSectionHeading:function(a,b){null===a||b>a?this.changeSelectedIndex(b+1):this.changeSelectedIndex(b-1)},listItemHasHeading:function(a){return 1===
a.getElementsByTagName("p").length},updateSearchFieldValue:function(a){this.searchField.viewElement().value=a},activatePrev:function(){if(null===this.selectedIndex||isNaN(this.selectedIndex))this.selectedIndex=1;this.changeSelectedIndex(this.selectedIndex-1)},activateNext:function(){if(null===this.selectedIndex||isNaN(this.selectedIndex))this.selectedIndex=-1;this.changeSelectedIndex(this.selectedIndex+1)},hide:function(){this.hideImpl();this.resetSelection()},hideImpl:function(){if(this.options.suggestionsEnabled){var a=
$(this.dropDownMenuId);Element.setStyle(a,"display","none");this.resultsVisible=!1}},processNoResults:function(){this.hide();this.setValueForKey(!1,"showSpinner")},selectOnClick:function(a){Event.stop(a);this.select()},reset:function(){this.setValueForKey(!1,"showSpinner");this.setValueForKey(!1,"showReset");this.hide()},resetSelection:function(){delete this.selectedIndex},select:function(){this.hideImpl.bindAndDelay(this,100);this.searchField.viewElement().focus();this.fireMetricsAndSubmit();this.formSubmissionStarted=
!0},_hiddenParamQueryString:function(){var a=this.viewElement(),a=Element.queryAll(a,"input[type=hidden]"),b={};if(a)for(var c=0,d=a.length;c<d;c++)b[a[c].name]=a[c].value;return Object.toQueryString(b)},fireMetricsAndSubmit:function(){var a;this.selectedIndex&&(a=this.dataBinding[this.selectedIndex]);this.getSearchConfig();this.fireMetricsEvent(a);this.action=null;(function(){a&&a.path?(a.path+=-1===a.path.indexOf("?")?"?":"&",a.path+=this._hiddenParams,window.location.href=a.path):(a&&this.updateSearchFieldValue(a.term),
this.viewElement().submit())}).bindAndDelay(this,500)},getSearchConfig:function(){var a=(new apple.metrics.Metrics({})).getObjectCookie()||{};a.searchConfig&&this.addSearchConfigValueToForm(a.searchConfig)},addSearchConfigValueToForm:function(a){var b=document.createElement("input");b.setAttribute("type","hidden");b.setAttribute("name","searchConfig");b.setAttribute("value",a);this.viewElement().appendChild(b)},fireMetricsEvent:function(a){var b={events:"event8"};a?"search"===a.section&&(b.eVar2=
a.term):b.eVar2=this.viewElement().find.value;a&&(b.eVar23=[this.viewElement().find.value,a.section,a.resultCount,a.term,a.rank].join(" | "));apple.metrics.fireEvent(b)}});var forceRedraw=function(){return 8===coherent.Browser.IE?function(a){var b=a.paddingLeft;a.paddingLeft="1px";window.setTimeout(function(){a.paddingLeft=b},1)}:function(){}}();Package("apple.widget");
apple.widget.SlidingTrackStack=function(a,b,c){c=c||{};this.narrow=!1;this.trackStack=[];this.settings=Object.applyDefaults(c,{animated:!0,trackFloatSelector:null,stackFloatSelector:null,minHeight:655,hasStack:!0,floatingClassName:"floating",offscreenClassName:"offscreen",lastClassName:"last",narrowClassName:"narrow"});this.buildTrackStack(a,b)};
apple.widget.SlidingTrackStack.prototype.buildTrackStack=function(a,b){var c="string"===typeof a?Element.query(a):a,d;this.trackStack.push({track:c,trackId:c.id,floater:this.getFloater(c)});this.settings.hasStack&&(d="string"===typeof b?Element.queryAll(b):b,d.forEach(function(a){this.getFloater(a);this.trackStack.push({track:a,trackId:a.id,floater:this.getFloater(a)})},this));this.setScrollInfo();Event.observe(window,"scroll",this.viewportScrolled.bind(this));Event.observe(window,"resize",this.viewportResized.bind(this));
Event.observe(c,"click",this.scrollToCoords.bind(this))};apple.widget.SlidingTrackStack.prototype.getFloater=function(a,b){return b?Element.query(b):a.children[0]};apple.widget.SlidingTrackStack.prototype.setScrollInfo=function(){var a=0,b=0,c=this.trackStack.length,d;for(b;b<c;b++)d=this.trackStack[b],d.floating&&this.unsetFloating(d),d.offset=a,d.trackRect=Element.getRect(d.track),d.floatRect=Element.getRect(d.floater),d.floating&&this.setFloating(d),a+=d.floatRect.height;this.viewportResized()};
apple.widget.SlidingTrackStack.prototype.scrollToCoords=function(a){if(!this.narrow&&a){Element.getViewport();var b=Element.locateAncestor(a.target||a.srcElement,function(a){return"div"==a.tagName.toLowerCase()});b.className.replace(/\s.*/,"");var a=0,c=this.trackStack.length,d;for(a;a<c;a++)if(b.className==this.trackStack[a].track.className){d=this.trackStack[a];break}if(d){d=d.floatRect.top-d.offset;if(d==Element.getViewport().top){d=this.trackStack[a+1];if(!d)return;d=d.floatRect.top-d.offset}this.settings.animated?
coherent.Animator.scrollTo([0,d]):window.scrollTo(0,d)}}};apple.widget.SlidingTrackStack.prototype.setFloating=function(a){Element.addClassName(a.track,this.settings.floatingClassName);Element.removeClassName(a.track,this.settings.lastClassName);Element.setStyle(a.floater,"position","fixed");Element.setStyle(a.floater,"top",a.offset+"px")};
apple.widget.SlidingTrackStack.prototype.unsetFloating=function(a){Element.removeClassName(a.track,this.settings.floatingClassName);Element.removeClassName(a.track,this.settings.lastClassName);Element.removeClassName(a.track,this.settings.offscreenClassName);Element.setStyle(a.floater,"position","");Element.setStyle(a.floater,"top","")};
apple.widget.SlidingTrackStack.prototype.viewportScrolled=function(){var a=Element.getViewport(),b=0,c=0,d=0,e=this.trackStack.length,f;if(!this.narrow){for(d;d<e;d++)f=this.trackStack[d],f.trackRect.top<=a.top+f.offset?(this.setFloating(f),f.floating=!0,b=d):(this.unsetFloating(f),f.floating=!1),c=a.top+f.offset+f.floatRect.height,c>=f.trackRect.bottom?Element.addClassName(f.track,this.settings.offscreenClassName):Element.removeClassName(f.track,this.settings.offscreenClassName);Element.addClassName(this.trackStack[b].track,
this.settings.lastClassName)}};
apple.widget.SlidingTrackStack.prototype.viewportResized=function(){var a=document.documentElement.clientWidth,b=document.documentElement.clientHeight,c=coherent.Browser.IE?document.body.scrollWidth:document.documentElement.scrollWidth,d=this.trackStack.length,e=0;if(this.narrow=coherent.Browser.MobileSafari||a<c||b<this.settings.minHeight?!0:!1){for(e;e<d;e++)this.unsetFloating(this.trackStack[e]);Element.addClassName(this.trackStack[0].track,this.settings.narrowClassName)}else this.viewportScrolled(),Element.removeClassName(this.trackStack[0].track,
this.settings.narrowClassName)};Package("apple.widget");
apple.widget.SlidingTrackView=Class.create(function(){var a="load touchstart touchmove touchend touchcancel scroll resize".split(" "),b=coherent.Browser.MobileSafari?-121:0,c={pinned_top:function(){if(!this.isFloatingDisabled&&this._trackFrame.top<b&&this._viewport.height>=this._itemFrame.height){if(this._trackFrame.bottom<this._itemFrame.height)return this.setState("pinned_bottom");if(this._viewport.height>this._itemFrame.height)return this.setState("floating")}},floating:function(){if(this.isFloatingDisabled||
this._trackFrame.top>b||this._viewport.height===this._itemFrame.height)return this.setState("pinned_top");if(this._trackFrame.bottom<=this._itemFrame.bottom)return this.setState("pinned_bottom")},pinned_bottom:function(){if(this.isFloatingDisabled||this._trackFrame.bottom>=this._itemFrame.bottom)return this.setState("pinned_top");if(this._itemFrame.top>b)return this.setState("floating")}};return{constructor:function(b,c){if(6!==coherent.Browser.IE&&Element.isFixedPositionSupported()){var f=a.length,
g=Array.from(b.childNodes),h,i;for(this.view=b;i=g.shift();)1==i.nodeType&&!h?h=i:(void 0==c&&(c=""),c.cleanup&&b.removeChild(i));this.isFloatingDisabled=!1;this.shouldHideFloating=coherent.Browser.MobileSafari;this._item=coherent.View.fromNode(h);null===this._item&&(this._item=new coherent.View(h));this._viewport=Element.getViewport();this._trackFrame=Element.getRect(b,!0);this._itemFrame=Element.getRect(h,!0);this.setState("pinned_top");this.updateItemPosition();this._item.addObserverForKeyPath(this,
this.itemFrameChanged,"frame");Event.observe(window,"pageshow",this.pageShowHandler.bindAsEventListener(this));if(window.addEventListener)for(;f--;)window.addEventListener(a[f],this,!1);else for(this.boundHandleEvent=this.handleEvent.bindAsEventListener(this);f--;)Event.observe(window,a[f],this.boundHandleEvent)}},pageShowHandler:function(b){var c=a.length;if(b.persisted)if(window.addEventListener)for(;c--;)window.removeEventListener(a[c],this,!1);else for(this.boundHandleEvent=this.handleEvent.bindAsEventListener(this);c--;)Event.observe(window,
a[c],this.boundHandleEvent)},hideItem:function(){this.hidingItem||(this.hidingItem=!0,Element.hide(this._item.viewElement()))},showItem:function(){this.hidingItem&&(Element.show(this._item.viewElement()),this.hidingItem=!1)},handleEvent:function(a){switch(a.type){case "load":case "resize":this.viewportResized();break;default:if(this.shouldHideFloating)switch(a.type){case "touchmove":this.hideItem();break;case "touchcancel":case "scroll":this.showItem()}this.viewportScrolled()}},viewportResized:function(){this._viewport=
Element.getViewport();coherent.Browser.Safari&&this.setState("pinned_top");this.isFloatingDisabled=coherent.Browser.IE?document.documentElement.clientWidth<document.body.scrollWidth:document.documentElement.clientWidth<document.documentElement.scrollWidth;this.viewportScrolled()},viewportScrolled:function(){this._trackFrame=Element.getRect(this.view,!0);this._itemFrame=Element.getRect(this._item.viewElement(),!0);this.updateItemPosition()},updateItemPosition:function(){if("willResizeFrame"in this._item){var a=
Object.applyDefaults({},this._itemFrame);a.top=Math.max(0,this._trackFrame.top);a.bottom=Math.min(this._trackFrame.bottom,this._viewport.height);a.height=a.bottom-a.top;this._viewport.height>this._itemFrame.height&&this._item.willResizeFrame(a)&&(this._itemFrame=this._item.resizeFrame(a))}this._stateSwitcher()},itemFrameChanged:function(a){this._itemFrame=a.newValue;this.updateItemPosition()},setState:function(a){if(this._currentState!=a){var b=this.view;Element.removeClassName(b,this._currentState);
Element.addClassName(b,a);this._currentState=a;this._stateSwitcher=c[a]}}}}());Package("apple.widget");apple.widget.SmartTextField=function(a){this.textAreaNodeId=a.textAreaElementId;this.errNodeId=a.errDivElementId;this.checkServerURL=a.checkServerURL;this.sid=a.sid;this.partNumber=a.partNumber;this.resubmit=this.inFlight=!1;this.previewDivId=this.wrappedText=this.serverError="";this.timer=-1;this.cancelledRequest=!1;$(this.textAreaNodeId).stf=this;Event.onDomReady(this.init.bind(this))};
apple.widget.SmartTextField.prototype.init=function(){var a=$(this.textAreaNodeId),b=null,c=function(a){b&&window.clearTimeout(b);b=this.afterKeypress.bindAndDelay(this,1E3,a)}.bind(this);Event.observe(a,"keyup",c)};
apple.widget.SmartTextField.prototype.checkServer=function(){this.timer=-1;this.inFlight=!0;this.resubmit=!1;var a=this;if(this.checkServerURL){var b={mt:$(a.textAreaNodeId).value,pn:this.partNumber,wosid:this.sid};XHR.post(this.checkServerURL,b).addMethods(function(b){!a.cancelledRequest&&("BAD REQUEST"!=b&&"<html>"!=b.substring(0,6))&&(a.inFlight=!1,a.serverError="",a.resubmit&&(a.resubmit=!1,a.checkServerSoon()),"OK"!=b.substr(0,2)&&(a.serverError=b),"OK:"==b.substr(0,3)&&(a.wrappedText=b.substring(3),
a.previewDivId&&($(a.previewDivId).innerHTML=a.wrappedText)),a.showError())},function(){})}};apple.widget.SmartTextField.prototype.checkServerSoon=function(){this.cancelledRequest=!1;if(this.inFlight)this.resubmit=!0;else{-1!=this.timer&&window.clearTimeout(this.timer);var a=this;this.timer=window.setTimeout(function(){a.checkServer()},500)}};apple.widget.SmartTextField.prototype.afterKeypress=function(){this.checkServerSoon()};
apple.widget.SmartTextField.prototype.showError=function(){$(this.errNodeId).innerHTML=this.serverError.replace(/</,"&lt;")};apple.widget.SmartTextField.prototype.setPreviewDivId=function(a){this.previewDivId=a};apple.widget.SmartTextField.prototype.cancelRequest=function(){this.cancelledRequest=!0;this.resubmit=this.inFlight=!1};Package("apple.widget");apple.widget.SuggestViewController=Class.create(coherent.ViewController,{__structure__:{},init:function(){}});Package("apple.widget");
apple.widget.SyncContent=function(a){this.config=a;this.change()};apple.widget.SyncContent.prototype.getContent=function(){var a=null,b=function(b){b.body&&b.body.content&&(a=b.body.content)}.bind(this);apple.io.json.invoke({url:this.getUrl(),sync:!0,success:b,scriptKeys:["content"]});return a};apple.widget.SyncContent.prototype.change=function(){var a=this.getContent();a&&document.write(a)};apple.widget.SyncContent.prototype.getUrl=function(){return this.config.url};Package("apple.widget");
apple.widget.TabController=function(a){this.base("constructor")(a)};apple.util.makeSubclass(apple.widget.TabController,apple.widget.BaseWidget);apple.widget.TabController.DEFAULTS={activeClass:"active",inactiveClass:"inactive",transition:"crossfade",animate:!1,autoRotate:!1,advanceInterval:8E3,transitionDuration:1E3};
apple.widget.TabController.prototype.init=function(){var a=document.getElementById(this.config.contentId),b=this.tabContentIdFromTabId(this.config.selectedTabId);if(!document.getElementById(b)){var c=document.createElement("div");c.id=this.config.contentId;c.className=a.className;a.id=b;a.className="";a=a.parentNode.replaceChild(c,a);c.appendChild(a)}this._swapper=new apple.fx.ContentSwapper({id:this.config.contentId,duration:this.config.transitionDuration,transition:this.config.transition});a=window.location.hash.match(/^#tab(\d+)$/);
this.getTabIds();this.setupWrapperEvents();if(a&&a[1]){var a=parseInt(a[1],10)-1,d;for(d in this.config.tabs)if((b=d.match(/(\d+)$/))&&b[1]==a){this.selectTab(d);break}}this.resume()};
apple.widget.TabController.prototype.calculateTabHeights=function(a){var b=document.getElementById(a),c=document.createElement("li");c.innerHTML='<a href="#"><strong>one line</strong></a>';b.appendChild(c);a=parseInt(Element.getStyles(c.getElementsByTagName("strong")[0],"height"),10);b.removeChild(c);for(var b=b.getElementsByTagName("strong"),c=b.length,d=0,e,f;d<c;d++)e=b[d],f=parseInt(Element.getStyles(e,"height"),10),f>a&&Element.addClassName(e.parentNode.parentNode,"two-line")};
apple.widget.TabController.prototype.getTabIds=function(){this.config.tabIds=[];for(var a in this.config.tabs)this.config.tabIds.push(a);return this.config.tabIds};apple.widget.TabController.prototype.setupWrapperEvents=function(){if(this.config.wrapperId){var a=document.getElementById(this.config.wrapperId);a&&(Event.observe(a,"mouseover",this.pause.bindAsEventListener(this)),Event.observe(a,"mouseout",this.resume.bindAsEventListener(this)))}};
apple.widget.TabController.prototype.pause=function(){this.config.autoRotate&&(this.paused=!0,this.timer&&window.clearTimeout(this.timer),this.timer=null)};apple.widget.TabController.prototype.resume=function(a){this.config.autoRotate&&(a&&(this.paused=!1),this.timer&&window.clearTimeout(this.timer),this.timer=this.showNextTab.bindAndDelay(this,this.config.advanceInterval))};
apple.widget.TabController.prototype.showNextTab=function(){if(!this.paused&&!this.locked){var a=this.config.selectedTabId,b=this.config.tabIds||this.getTabIds(),a=b.indexOf(a);a==b.length-1?a=0:a++;this.selectTab(b[a],"advance")}};
apple.widget.TabController.prototype.preloadNextTab=function(){function a(a){a&&a.body&&(a=coherent.Scripts.extract(a.body.content),this.insertTabContent(d,a))}var b=this.config.selectedTabId,c=this.config.tabIds||this.getTabIds(),b=c.indexOf(b);b==c.length-1?b=0:b++;var d=c[b];document.getElementById(this.tabContentIdFromTabId(d))||(c=this.config.tabContentUrl||this.config.tabs[d],c=c.url||c,c=apple.util.expandTemplate(c,{tabId:d}),c={url:c,success:a.bind(this),scriptKeys:["content"]},apple.io.json.invoke(c))};
apple.widget.TabController.prototype.tabContentIdFromTabId=function(a){return[this.config.contentId,a].join("_")};apple.widget.TabController.prototype.insertTabContent=function(a,b){if(document.getElementById(this.tabContentIdFromTabId(a)))return null;var c=document.getElementById(this.config.contentId),d=document.createElement("div");d.id=this.tabContentIdFromTabId(a);Element.setInnerHTML(d,b);d.style.display="none";c.appendChild(d);return d};
apple.widget.TabController.prototype.activateTab=function(a){var b,c,d;this.config.selectedTabId&&(b=document.getElementById(this.config.selectedTabId),this.config.animate||(Element.removeClassName(b,this.config.activeClass),Element.removeClassName(b.parentNode,this.config.activeClass),Element.addClassName(b,this.config.inactiveClass),Element.addClassName(b.parentNode,this.config.inactiveClass)),c=this.tabContentIdFromTabId(this.config.selectedTabId));if(this.config.selectedTabId=a)b=document.getElementById(a),
this.config.animate?(coherent.Animator.replaceClassName(b,this.config.inactiveClass,this.config.activeClass,{duration:250,curve:coherent.easing.outSine}),coherent.Animator.replaceClassName(b.parentNode,this.config.inactiveClass,this.config.activeClass,{duration:250,curve:coherent.easing.outSine})):(Element.removeClassName(b,this.config.inactiveClass),Element.removeClassName(b.parentNode,this.config.inactiveClass),Element.addClassName(b,this.config.activeClass),Element.addClassName(b.parentNode,this.config.activeClass)),
d=this.tabContentIdFromTabId(a);var e=this;this._swapper.swap(this.config.transition,c,d,function(){e.locked=!1;e.resume();document.getElementById(d).style.zoom=1;e.config.autoRotate&&e.preloadNextTab()})};
apple.widget.TabController.prototype.selectTab=function(a,b){function c(b){this.config.selectedTabId!=a&&(b&&b.body)&&(b=coherent.Scripts.extract(b.body.content),this.insertTabContent(a,b),this.activateTab(a))}void 0===b&&(b="click");if(!this.locked&&this.config.selectedTabId!=a){"click"==b&&(this.config.autoRotate=!1);var d=this.tabContentIdFromTabId(a);this.timer&&(window.clearTimeout(this.timer),this.timer=null);this.locked=!0;var e=this.config.baseMetrics;"undefined"!==typeof e&&(e&&"click"===
b)&&(e=apple.util.expandTemplate(e,{index:this.config.tabs[a].displayName}),apple.metrics.Metrics.reportCustomLink(null,e));this.config.selectedTabId&&(e=document.getElementById(this.config.selectedTabId),this.config.animate&&(coherent.Animator.replaceClassName(e,this.config.activeClass,this.config.inactiveClass,{duration:250,curve:coherent.easing.inSine}),coherent.Animator.replaceClassName(e.parentNode,this.config.activeClass,this.config.inactiveClass,{duration:250,curve:coherent.easing.inSine})));
document.getElementById(d)?this.activateTab(a):(d=this.config.tabContentUrl||this.config.tabs[a],d=d.url||d,d=apple.util.expandTemplate(d,{tabId:a}),d={url:d,success:c.bind(this),scriptKeys:["content"]},apple.io.json.invoke(d))}};Package("apple.widget");apple.widget.TextField=function(a,b){this.base("constructor")(a,b)};apple.util.makeSubclass(apple.widget.TextField,apple.widget.BaseWidget);apple.widget.TextField.DEFAULTS={placeholder:"No Value",placeholderClass:"placeholder"};
apple.widget.TextField.prototype.init=function(){var a=this.widget();Event.observe(a,"focus",this.fieldReceivedFocus.bindAsEventListener(this));Event.observe(a,"blur",this.fieldLostFocus.bindAsEventListener(this));this._maxLength=a.maxLength||-1;var b=(a.value||"").replace(/^\s+/,"").replace(/\s+$/,"");""!==b&&this.config.placeholder!==b||(a.maxLength=this.config.placeholder.length,a.value=this.config.placeholder,Element.addClassName(a,this.config.placeholderClass))};
apple.widget.TextField.prototype.fieldReceivedFocus=function(){var a=this.widget(),b=(a.value||"").replace(/^\s+/,"").replace(/\s+$/,"");this.config.placeholder===b&&(a.value="");-1!=this._maxLength?a.maxLength=this._maxLength:a.removeAttribute("maxLength");Element.removeClassName(a,this.config.placeholderClass)};
apple.widget.TextField.prototype.fieldLostFocus=function(){var a=this.widget();if(""===(a.value||"").replace(/^\s+/,"").replace(/\s+$/,""))Element.addClassName(a,this.config.placeholderClass),this._maxLength=a.maxLength||-1,a.maxLength=this.config.placeholder.length,a.value=this.config.placeholder};Package("apple.widget");apple.widget.VoteController=function(a){this.config=Object.applyDefaults(a,this.DEFAULTS);Event.onDomReady(this.init.bind(this))};
apple.widget.VoteController.prototype.DEFAULTS={voteYesValue:1,voteNoValue:0,voteClass:"vote",voteYesClass:"yes",voteNoClass:"no",messageClass:"useful",voteIdRegex:/-(\w+)$/,fadeDuration:200};
apple.widget.VoteController.prototype.init=function(){var a=document.getElementById(this.config.elementId);a&&(this.attachVoteEvents(Element.getElementsByClassName(this.config.voteYesClass,a),this.voteYes.bindAsEventListener(this)),this.attachVoteEvents(Element.getElementsByClassName(this.config.voteNoClass,a),this.voteNo.bindAsEventListener(this)))};apple.widget.VoteController.prototype.attachVoteEvents=function(a,b){Array.forEach(a,function(a){Event.observe(a,"click",b)})};
apple.widget.VoteController.prototype.voteYes=function(a){var b=a.srcElement||a.target;Event.stop(a);this.sendVote(b,this.config.voteYesValue)};apple.widget.VoteController.prototype.voteNo=function(a){var b=a.srcElement||a.target;Event.stop(a);this.sendVote(b,this.config.voteNoValue)};
apple.widget.VoteController.prototype.sendVote=function(a,b){var c=this.getVoteElem(a),d=this.getVoteId(c);d&&apple.io.json.invoke({url:this.config.requestUrl,urlArgs:{voteId:d,vote:b}});"answer"==this.config.type&&(c=Element.query(c,"input[name='featureType']"),this.reportEvent(b,c?c.value:null));this.displayFeedbackMessage(a)};
apple.widget.VoteController.prototype.displayFeedbackMessage=function(a){var b=this.getMessageElem(a),c=this.getVoteElem(a),d=this.config.feedbackMessage,e=this.config.fadeDuration,a=parseInt(Element.getStyles(c,"height"),10);isNaN(a)||(c.style.height=Math.max(a,0)+"px");coherent.Animator.setStyles(c,{opacity:0},{duration:e,callback:function(){b.innerHTML=d;b.parentNode.removeChild(b);c.innerHTML="";c.appendChild(b);Element.setOpacity(c,0);coherent.Animator.setStyles(c,{opacity:1},{duration:e,cleanup:!0})}})};
apple.widget.VoteController.prototype.getVoteElem=function(a){for(var b=this.config.voteClass,a=a.parentNode;a&&a!=document.body;){if(a.className==b)return a;a=a.parentNode}return null};apple.widget.VoteController.prototype.getMessageElem=function(a){var b=null,a=this.getVoteElem(a);(a=Element.getElementsByClassName(this.config.messageClass,a))&&0<a.length&&(b=a[0]);return b};
apple.widget.VoteController.prototype.getVoteId=function(a){if(!a||!a.id)return null;var b=null;(a=this.config.voteIdRegex.exec(a.id))&&1<a.length&&(b=a[1]);return b};apple.widget.VoteController.prototype.reportEvent=function(a,b){apple.metrics.fireMicroEvent({page:window.s.pageName,feature:(b||"Product")+" vote",part:window.s.prop25,action:1==a?"Useful":"Not Useful"})};Package("apple.widget");apple.widget.WhyBuyEmailSubscription=function(a,b){this.base("constructor")(a,b)};
apple.util.makeSubclass(apple.widget.WhyBuyEmailSubscription,apple.widget.BaseWidget);ServerStatus={good:"SUCCESS",bad:"ERROR",busy:"BUSY",off:"OFF",on:"ON",format:"FORMAT"};
apple.widget.WhyBuyEmailSubscription.DEFAULTS={emailPlaceholder:"example: steve@me.com",submitUrl:"email-server-reply.txt",urlArgs:{},argName:"emailAddress",emailFieldSpec:"input.notify_email",submitButtonSpec:".notify_submit",formSpec:"form",fadeDuration:350,showForm:{SUCCESS:!1,ERROR:!1,BUSY:!1,ON:!0,OFF:!1,FORMAT:!0},loadingClass:"loading",rpcTimeout:1E4,emailRegex:/^[A-Z0-9._%+-]+@(?:[A-Z0-9-]+\.)+[A-Z]{2,4}$/i};
apple.widget.WhyBuyEmailSubscription.prototype.init=function(){this._animator=new apple.fx.Animator({duration:this.config.fadeDuration});this.setStatus("OFF");this.setStatus("ON");var a=this.part(this.config.formSpec),b=this.part(this.config.emailFieldSpec);this._field=new apple.widget.TextField(b.id,{placeholder:this.config.emailPlaceholder});this._actions=[];var b=this.part(this.config.submitButtonSpec),c=this.submitHandler.bindAsEventListener(this);Event.observe(b,"click",c);Event.observe(a,"submit",
c)};apple.widget.WhyBuyEmailSubscription.prototype.showHideForm=function(a){var b=this.config.showForm[this._status],a=this.config.showForm[a],c=this.part(this.config.formSpec);b!=a&&(a?this._actions.push(new apple.fx.Fade(apple.fx.linearTween,c,0,1)):this._actions.push(apple.fx.Fade(apple.fx.linearTween,c,1,0)))};
apple.widget.WhyBuyEmailSubscription.prototype.displayStatusUpdate=function(a){var b=Element.query("#email_notification .notify_on p");b.style.opacity="0";a="notify_"+a.toLowerCase();b.innerHTML=this.config.msgText[a];this._actions.push(new apple.fx.Fade(apple.fx.linearTween,b,0,1))};apple.widget.WhyBuyEmailSubscription.prototype.partSpecForStatus=function(a){return"div.notify_"+(a||"").toLowerCase()};
apple.widget.WhyBuyEmailSubscription.prototype.setStatus=function(a,b,c){a=a||"ERROR";if(a!=this._status){this.widget();var d=this.part(this.config.formSpec),e=this.config.showForm[this._status],f=this.config.showForm[a],g=this.part(this.partSpecForStatus(this._status)),h=this.part(this.partSpecForStatus(a));this._status?c?(d.style.display=f?"block":"none",h.style.display="block",g.style.display="none",this._status=a):(c=new apple.fx.Fade(apple.fx.linearTween,g,1,0),h=new apple.fx.Fade(apple.fx.linearTween,
h,0,1),g=[c,h],"ON"!=a&&"OFF"!=a?(this.displayStatusUpdate(a),this.showHideForm(a),this._status=a,this._animator.play(new apple.fx.Chain(this._actions),b)):(e!=f&&(f?(d=new apple.fx.Fade(apple.fx.linearTween,d,0,1),g=[c,new apple.fx.Blend(h,d)]):(d=new apple.fx.Fade(apple.fx.linearTween,d,1,0),g=[new apple.fx.Blend(c,d),h])),this._status=a,this._animator.play(new apple.fx.Chain(g),b))):(d.style.display=f?"block":"none",h.style.display="block",this._status=a)}};
apple.widget.WhyBuyEmailSubscription.prototype.rpc=function(a,b,c){var a=-1!=a.indexOf("?")?a+"&":a+"?",a=a+("bustCache="+(new Date).getTime().toString(16)+":"+Math.random()),d,e=document.createElement("script");e.src=a;window.signalStatus=function(){window.clearTimeout(d);d=null;b&&b.apply(window,arguments)};d=window.setTimeout(function(){window.signalStatus=function(){};c&&c()},this.config.rpcTimeout);document.getElementsByTagName("HEAD")[0].appendChild(e)};
apple.widget.WhyBuyEmailSubscription.prototype.submitHandler=function(a){function b(){Element.removeClassName(d,this.config.loadingClass)}function c(a){a=a.replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase();this.setStatus(ServerStatus[a],b.bind(this))}(a.target||a.srcElement).blur();Event.stop(a);var d=this.widget(),e=this.part(this.config.emailFieldSpec);e&&this.config.submitUrl&&(a=e.value||"",a.match(this.config.emailRegex)?(Element.addClassName(d,this.config.loadingClass),e=Object.applyDefaults({},
this.config.urlArgs),e[this.config.argName]=a,a=[this.config.submitUrl,Object.toQueryString(e)].join("?"),this.rpc(a,c.bind(this),c.bind(this,"busy"))):(this.setStatus("FORMAT"),e.focus(),e.select()))};Package("apple.widget");
apple.widget.EngravedPod=Class.create(coherent.View,{exposedBindings:["engravingText","productId","picassoUrl","backgroundImage"],innerHTML:'<img class="engraving" src="">',__structure__:{"img.background":coherent.ImageView({srcBinding:"backgroundImage"}),"img.engraving":coherent.ImageView({srcBinding:"engravedImage",visibleBinding:"pending(not)"})},keyDependencies:{prepareEngravedImage:["picassoUrl","productId","backgroundImage","engravingText"]},productId:"",backgroundImage:"",picassoUrl:"",init:function(){},
prepareEngravedImage:function(){if(this.picassoUrl&&this.productId&&this.backgroundImage&&this.engravingText){this.__imageTimer&&(window.clearTimeout(this.__imageTimer),this.__imageTimer=null);var a=(this.engravingText||"").split("\n"),b=this.picassoUrl,c=[b,Object.toQueryString({th:a[0]||"",tl:a[1]||"",i:this.backgroundImage})].join(0<=b.indexOf("?")?"&":"?");this.setValueForKey(!0,"pending");this.__imageTimer=window.setTimeout(function(){this.setValueForKey(c,"engravedImage");this.setValueForKey(!1,
"pending")}.bind(this),50)}}});Package("apple");
apple.EngravingGalleryController=Class.create(coherent.ViewController,{__structure__:{"div.tabs ul":coherent.ListView({selectedIndexBinding:"selectedTabIndex",enabledBinding:"waiting(not)",animated:"true",action:"noop"}),"div.preview":apple.widget.EngravedPod({picassoUrlBinding:"selectedVariation.picassoUrl",classBinding:"viewClass",productIdBinding:"selectedProduct.productId",backgroundImageBinding:"selectedVariation.backer",engravingTextBinding:"engravingText"}),"ul.ipod-list":coherent.ListView({contentBinding:"products",
selectedObjectBinding:"selectedProduct",visibleBinding:"showProducts",action:"noop"}),"ul.ipod-list a":coherent.Anchor({titleBinding:"*.title"}),"ul.ipod-list img":coherent.ImageView({altBinding:"*.productId",srcBinding:"*.productImage"}),"ul.variations":coherent.ListView({contentBinding:"productVariations",selectedObjectBinding:"selectedVariation",visibleBinding:"showVariations",action:"noop"}),"ul.variations a":coherent.Anchor({titleBinding:"*.label",classBinding:"selectedProduct.productId"}),"ul.variations span":coherent.Anchor({textBinding:"*.label",
classBinding:"*.swatch"}),"div.engravings":coherent.ListView({contentBinding:"engravings",selectedIndexBinding:"selectedTabIndex",animated:"true",action:"noop"}),"div.engravings ul":coherent.ListView({contentBinding:"*.content",selectedObjectBinding:"*.selectedEngraving",action:"noop"}),"div.engravings ul a":coherent.View({htmlBinding:"*.text"})},keyDependencies:{viewClass:["selectedVariation","selectedProduct","engravings"],showVariations:["productVariations"],engravingText:["selectedTabIndex"]},
init:function(){this.view.superview().addObserverForKeyPath(this,this.overlayVisibleChange,"visible");Array.forEach(Element.queryAll("div.engravings ul"),function(a){Array.forEach(a.getElementsByTagName("li"),function(a,b){Element.addClassName(a,"item"+(b+1))})});if(this.shuffleTab=Element.query(this.viewElement(),"ul.shuffle")){var a=Element.query(this.viewElement(),"ul.ipod-list li");a&&(a.style.display="none")}this.addObserverForKeyPath(this,"observeSelectedEngravingChange","engravings.selectedEngraving")},
videoController:function(){if(!this.videoPlayer){var a=document.getElementById("video-container"),b=document.getElementById("video-href").getAttribute("href");delete coherent.View.viewLookup["volume-track"];delete coherent.View.viewLookup["control-track"];if(this.videoPlayer=Media.create(a,b,{autoplay:"true",width:640,height:360})){coherent.Browser.MobileSafari||(this.videoControls=new Media.ControlsWidget(a),this.videoPlayer.setControlPanel(this.videoControls));var b=function(){c.parentNode.removeChild(c);
a.appendChild(this.videoPlayer.video().object());a.appendChild(this.videoControls.element);this.videoControls.play()}.bind(this),c=document.createElement("div");Element.addClassName(c,"endstate");Event.observe(c,"click",b);this.videoPlayer.setDelegate({didEnd:function(){this.videoControls.pause();this.videoPlayer.setTime(0);this.videoPlayer.reset();a.appendChild(c);a.removeChild(this.videoControls.element);a.removeChild(this.videoPlayer.video().object())}.bind(this)})}}},selectedTabIndex:function(){return this.__selectedTabIndex},
setSelectedTabIndex:function(a){if(!this.engravings)return this.__selectedTabIndex=a;this.setValueForKey(!0,"waiting");var b=this.engravings,c=a==b.length-2,d=this.__selectedTabIndex==b.length-2,e=a==b.length-1,f=this.__selectedTabIndex==b.length-1,g=Element.query(this.viewElement(),"#video-container");this.__selectedTabIndex=a;e&&g?(g.firstChild?(this.videoControls&&this.videoControls.show(),this.setSelectedProduct(this.products[4])):this.videoController.bindAndDelay(this,500),this.setSelectedProduct(this.products[4])):
f&&g&&(g.firstChild&&this.videoControls&&this.videoControls.pause(),this.setSelectedProduct(this.products[1]));c&&this.shuffleTab?this.setSelectedProduct(this.products[0]):d&&this.shuffleTab&&!e&&this.setSelectedProduct(this.products[1]);b=b[this.__selectedTabIndex];b.selectedEngraving?this.updateEngravingText(b.selectedEngraving):b.setValueForKey(b.content[0],"selectedEngraving");(function(){this.setValueForKey(!1,"waiting")}).bindAndDelay(this,500);return a},selectedProduct:function(){return this.__selectedProduct},
setSelectedProduct:function(a){this.willChangeValueForKey("productVariations");this.__selectedProduct=a;this.didChangeValueForKey("productVariations");var b;this.shuffleTab?b=!(a==this.products[0]||a==this.prod):b=a!=this.prod;this.setValueForKey(b,"showProducts");b=this.productVariations();this.setValueForKey(b[0],"selectedVariation");return a},updateEngravingText:function(a){a=(a.text||"").split(/<\s*br\s*\/?>/i).map(function(a){return a.trim()}).join("\n");this.setValueForKey(a,"engravingText")},
observeSelectedEngravingChange:function(a){1===a.indexes.length&&this.updateEngravingText(a.newValue[0])},viewClass:function(){return!this.__selectedProduct?"preview":!this.selectedVariation?"preview "+this.__selectedProduct.productId:["preview",this.__selectedProduct.productId,this.__selectedProduct.productId+"_"+this.selectedVariation.swatch].join(" ")},showVariations:function(){return 1<this.productVariations().length},productVariations:function(){return!this.__selectedProduct||!this.productData?
[]:this.productData[this.__selectedProduct.productId]||[]},noop:function(a,b){Event.stop(b)},overlayVisibleChange:function(a){!a.newValue&&this.videoPlayer&&this.videoControls.pause()},setInitialSelections:function(a){this.setValueForKey(!0,"waiting");this.setSelectedProduct(this.products[a.selectedProduct||0]);var b=this.productVariations();this.setValueForKey(b[a.selectedVariationIndex||0],"selectedVariation");this.setSelectedTabIndex.bindAndDelay(this,10,a.selectedTab)}});Package("apple");
apple.EngravingViewController=Class.create(coherent.ViewController,{__structure__:{".one-click":coherent.View({visibleBinding:"showOneClickButtons"}),'input[type="checkbox"]':coherent.ToggleButton({checkedBinding:"thisIsGift"}),".outline_box .close":coherent.Anchor({action:"hide"}),"p.toggle":coherent.View({visibleBinding:"overlayHidden",animated:!0}),"p.toggle a":coherent.Anchor({action:"show"})},engravingOverlay:coherent.View(".outline_box"),init:function(){this.checkOneClickSettings();this.addObserverForKeyPath(this,
this.observeThisIsGiftCheckbox,"thisIsGift");this.observeThisIsGiftCheckbox();this.productImage=Element.query(this.viewElement(),"#EngraveDynamicImage");var a=Element.queryAll(this.viewElement(),"#engraving_form button[type=submit]");if(a&&-1!==a.length)for(var b=a.length;0<b;b--)a[b-1].clicked=!1,Event.observe(a[b-1],"click",this.handleClick.bind(this)),Event.stopObserving(a[b-1],"click",this.handleClick.bind(this));document.getElementById("gift-checkbox")&&(Event.observe(document.getElementById("gift-checkbox"),
"focus",this.showGiftPopup),Event.observe(document.getElementById("gift-checkbox"),"blur",this.hideGiftPopup),Event.observe(document.getElementById("gift-checkbox"),"keyup",this.handleGiftCheckboxKeyUp),Event.observe(document.getElementById("gift-checkbox"),"keypress",this.handleGiftCheckboxKeypress))},showGiftPopup:function(a){var b=new apple.widget.HoverManager;(a=b.findHoverNode(a.target||a.srcElement))&&b.showHover(a,!0)},hideGiftPopup:function(a){var b=new apple.widget.HoverManager;(a=b.findHoverNode(a.target||
a.srcElement))&&b.hideHover(a,!0)},handleGiftCheckboxKeypress:function(a){a.keyCode===Event.KEY_RETURN&&Event.stop(a)},handleGiftCheckboxKeyUp:function(a){if(a.keyCode===Event.KEY_ESC){Event.stop(a);var b=new apple.widget.HoverManager;(a=b.findHoverNode(a.target||a.srcElement))&&b.hideHover(a,!0)}},checkOneClickSettings:function(){var a=apple.cookie("appleconfig3");null===a&&(a=apple.cookie("AppleConfig3"));this.oneClickEnabled=null!==a?!0:!1},observeThisIsGiftCheckbox:function(){this.oneClickEnabled&&
this.hideOneClickButtonsIfThisIsGift()},hideOneClickButtonsIfThisIsGift:function(){this.valueForKey("thisIsGift")?this.setValueForKey(!1,"showOneClickButtons"):this.setValueForKey(!0,"showOneClickButtons")},show:function(){var a=this.engravingOverlay.viewElement();a.style.display="block";coherent.Animator.setStyles(a,{opacity:1},{duration:200});this.setValueForKey(!1,"overlayHidden");this.disableShowObserver()},hide:function(){var a=this.engravingOverlay.viewElement();coherent.Animator.setStyles(a,
{opacity:0},{duration:200,callback:function(){a.style.display="none"}});this.setValueForKey(!0,"overlayHidden");this.enableShowObserver()},enableShowObserver:function(){Event.observe(this.productImage,"click",this.observeClick.bind(this))},disableShowObserver:function(){Event.stopObserving(this.productImage,"click",this.observeClick.bind(this))},observeClick:function(){this.overlayHidden&&this.show()},handleClick:function(a){Element.locateAncestor(a.target||a.srcElement,function(a){return"button"==
a.tagName.toLowerCase()});for(var b=Element.queryAll(this.viewElement(),"#engraving_form button[type=submit]"),c=b.length;0<c;c--)b[c-1].clicked&&(b[c-1].disabled=!0,Event.stop(a)),Element.addClassName(b[c-1],"disabled"),b[c-1].clicked=!0}});Package("apple");
apple.EngravingStepController=Class.create(apple.EngravingViewController,{skipEngravingLink:coherent.Anchor(".alert_bubble a",{hrefBinding:"skipEngravingUrl"}),engravingForm:Part("form#engraving_form"),addEngravingButton:Part('.add-engraving button[type="submit"]'),skipEngravingButton:Part('.skip-engraving button[type="submit"]'),compoundButtonAddEngravingButton:Part('.add-engraving .dynamic-menu li.BuyNow button[type="submit"]'),compoundButtonSkipEngravingButton:Part('.skip-engraving .dynamic-menu li.BuyNow button[type="submit"]'),
init:function(){this.submitClicked=!1;if(this.isBuyFlow=apple.buyFlowVersionId){this.storageDelegate=new apple.buyFlowStorageDelegate({session:!0,hash:!0,expires:apple.buyFlowExpiry||36E5,expiryInMs:!0});this.storageDelegate.checkBuyFlowComplete();this.storageDelegate.hasEntriesForStep()?this.populateEngravingMessage():Element.queryAll(this.engravingForm(),'input[type="text"]').forEach(function(a){a.value=""});this.skipEngravingLink&&this.setSkipEngravingLink();var a=Element.queryAll(this.viewElement(),
".compound-button .dynamic-menu ul li a");if(a){var b=this;a.forEach(function(a){Event.observe(a,"click",b.bindEngravingActionsToLink.bind(b))})}}this.base();Element.replaceClassName(this.viewElement(),"loading","init");Event.observe(window,"pageshow",function(a){a.persisted&&this.storageDelegate&&(this.storageDelegate.storage.init(),this.storageDelegate.checkBuyFlowComplete(),this.storageDelegate.hasEntriesForStep()&&this.populateEngravingMessage())}.bind(this))},bindEngravingActionsToLink:function(a){var b=
Element.locateAncestor(a.target||a.srcElement,function(a){return"fieldset"==a.tagName.toLowerCase()});Element.hasClassName(b,"add-engraving")?this.addEngravingSubmit(a):Element.hasClassName(b,"skip-engraving")&&this.skipEngravingSubmit(a)},handleClick:function(a){var b=Element.locateAncestor(a.target||a.srcElement,function(a){return"button"==a.tagName.toLowerCase()});!0===this.submitClicked?Event.stop(a):(this.submitClicked=!0,b===this.addEngravingButton()||b===this.compoundButtonAddEngravingButton()?
this.addEngravingSubmit(a):(b===this.skipEngravingButton()||b===this.compoundButtonSkipEngravingButton())&&this.skipEngravingSubmit(a))},addEngravingSubmit:function(a){if(this.isBuyFlow&&(this.storageDelegate.entriesForSelector("not-engraved")||this.storageDelegate.entriesForSelector("acc-not-engraved"))){var b=$("skip-engraving");b&&b.checked&&(b.checked=!1);this.storageDelegate.removeSelected("not-engraved");this.storageDelegate.entriesForSelector("acc-not-engraved")&&this.storageDelegate.removeSelected("acc-not-engraved")}this.submitForm(a,
"add")},skipEngravingSubmit:function(a){var b=$("skip-engraving");b&&(b.checked=!0);this.submitForm(a,"skip")},submitForm:function(a,b){if(this.isBuyFlow){this.storageDelegate.save(this);var c=Element.query('input[name="product"]'),d=c&&Element.query('input[name="secondary_product"]');d&&d.value==c.value&&(d.value="");"skip"===b&&this.removeEngravingMessageFromStorage();(d=(d=(c=a.target||a.srcElement)&&Element.locateAncestor(c,function(a){return"button"===a.tagName.toLowerCase()}))&&d.name)?"proceed"!==
d&&this.storageDelegate.setBuyFlowComplete():c.id===this.skipEngravingLink.viewElement().id&&(c=this.addEngravingButton(),d=this.compoundButtonAddEngravingButton(),(c&&"proceed"!==c.name||d&&"proceed"!==d.name)&&this.storageDelegate.setBuyFlowComplete())}},setSkipEngravingLink:function(){var a,b=this.skipEngravingLink.viewElement().href.split("?"),c=b&&Object.fromQueryString(b[1]||"");this.isBuyFlow&&(a=(a=this.storageDelegate.storage.inFallback&&this.storageDelegate.storage.wantHash)?Object.fromQueryString(window.location.search):
this.storageDelegate.entriesForSession(!0)||{});c=Object.merge(c,a);b=b[0]+"?"+Object.toQueryString(c);this.setValueForKey(b,"skipEngravingUrl");Event.observe(this.skipEngravingLink.viewElement(),"click",this.skipEngravingSubmit.bind(this))},populateEngravingMessage:function(){var a=this.storageDelegate.entriesForStep(!0),b=!1;Element.queryAll(this.engravingForm(),'input[type="text"]').forEach(function(c){var d=c.name;a[d]&&(coherent.Browser.Mozilla?c.value=a[d]:c.setAttribute("value",a[d]));(function(){b||
(c.focus(),b=!0)}).bindAndDelay(this,0)})},removeEngravingMessageFromStorage:function(){var a=this.storageDelegate.entriesForStep(!0),b=this;Element.queryAll(this.engravingForm(),'input[type="text"]').forEach(function(c){c=c.name;a[c]&&b.storageDelegate.removeSelected(c)})}});Package("apple.masthead");
apple.masthead.MastHeadViewController=function(){return Class.create(coherent.ViewController,{__structure__:{"#call-apple":coherent.View({action:"showHoursOfOperation"})},showHoursOfOperation:function(){this.overlay||(this.overlay=new coherent.Overlay("call-apple-overlay"));this.overlay.display({classname:"overlay call-apple-overlay",sourceId:"call-apple-content"});apple.metrics.fireMicroEvent({eVar:"prop41",feature:"Concierge",action:"Call 800-MY-APPLE link"})}})}();
Event.onLoad(function(){var a=Element.query(".masthead");a&&new apple.masthead.MastHeadViewController(a)});Package("apple.utilitynav");
(function(){var a=Class.create(coherent.ViewController,{__structure__:{"#utility-nav":coherent.View({visibleBinding:"visibleSection"}),"#utility-nav-loading":coherent.View({visibleBinding:"showSpinner"}),"#unav-help":coherent.View({visibleBinding:"helpVisible"}),"#unav-account":coherent.View({visibleBinding:"accountVisible"}),"#unav-cart":coherent.View({visibleBinding:"cartVisible"}),"#utility-nav-btm":coherent.View({visibleBinding:"visibleSection"}),"#unav-cart p.view-link a":coherent.Anchor({hrefBinding:"data.cart.viewAllUrl"}),
".checkout a":coherent.Anchor({visibleBinding:"data.cart.items.@count",hrefBinding:"data.cart.checkOutUrl"}),"#unav-your-cart .empty-cart-message":coherent.View({visibleBinding:"data.cart.items.@count(not)"}),"#unav-your-cart ul":coherent.ListView({contentBinding:"data.cart.items",visibleBinding:"data.cart.items.@count",template:coherent.View({__structure__:{a:coherent.Anchor({hrefBinding:"*.productDetailsUrl"}),img:coherent.ImageView({srcBinding:"*.imageUrl"}),span:coherent.View({htmlBinding:"*.description"})}})})},
helpLink:coherent.Anchor("#u_help a"),accountLink:coherent.Anchor("#u_account a"),cartLink:coherent.Anchor("#u_cart a"),keyDependencies:{helpVisible:["visibleSection","dataLoaded"],accountVisible:["visibleSection","dataLoaded"],cartVisible:["visibleSection","dataLoaded"],showSpinner:["visibleSection","dataLoaded"]},init:function(){this.setValueForKey(null,"visibleSection");this.setValueForKey(!1,"dataLoaded");var a={owner:this,onmouseenter:this.onmouseenter,onmouseleave:this.onmouseleave};this.addTrackingInfo("u_help",
a);this.addTrackingInfo("u_account",a);this.addTrackingInfo("u_cart",a);this.addTrackingInfo("unav-help",a);this.addTrackingInfo("unav-account",a);this.addTrackingInfo("unav-cart",a);a=Element.query("#unav-cart .checkout a");6===coherent.Browser.IE&&a&&Event.observe(a,"click",this.unsupportedCheckoutCheck.bind(this));this.surveyData&&window.apple.survey.surveyButton(this);this.unavHelp=coherent.View.viewLookup["unav-help"];this.unavAccount=coherent.View.viewLookup["unav-account"];this.unavCart=coherent.View.viewLookup["unav-cart"];
Event.observe(this.helpLink.viewElement(),"focus",this.keyboardShow.bindAsEventListener(this));this.accountLink&&Event.observe(this.accountLink.viewElement(),"focus",this.keyboardShow.bindAsEventListener(this));Event.observe(this.cartLink.viewElement(),"focus",this.keyboardShow.bindAsEventListener(this));Event.observe(document.getElementById("guide_wrap"),"keydown",this.keydown.bindAsEventListener(this));Event.observe(document.getElementById("guide_wrap"),"touchend",this.touchEndMenu.bindAsEventListener(this));
Event.observe(document.getElementById("guide_wrap"),"click",this.clickHandler.bindAsEventListener(this));Event.observe(document.getElementById("guide_wrap"),"touchstart",this.touchStartMenu.bindAsEventListener(this));this.preventClick=!1;Event.observe(document.body,"click",this.closeMenu.bindAsEventListener(this));Event.observe(document.body,"touchend",this.closeMenu.bindAsEventListener(this));Event.observe(document.getElementById("site-search-query"),"keydown",this.closeMenu.bindAsEventListener(this));
this.ariaInit()},ariaInit:function(){function a(b,c,f){c&&b.setAttribute("aria-haspopup","true");f&&b.setAttribute("aria-owns",f);return b}a(this.helpLink.viewElement(),!0,"unav-help");this.accountLink&&a(this.accountLink.viewElement(),!0,"unav-account");a(this.cartLink.viewElement(),!0,"unav-cart");this.addObserverForKeyPath(this,this.ariaObserveVisible,"helpVisible");this.addObserverForKeyPath(this,this.ariaObserveVisible,"accountVisible");this.addObserverForKeyPath(this,this.ariaObserveVisible,
"cartVisible");document.getElementById("utility-nav-content").setAttribute("aria-live","polite")},removeAriaAlert:function(){var a=document.getElementById("ariaLoadingAlert");a&&(a.parentElement||a.parentNode).removeChild(a)},createAriaAlert:function(a,b){this.removeAriaAlert();var e=document.createElement("p"),f=document.createTextNode(a);e.appendChild(f);e.setAttribute("role","alert");e.setAttribute("aria-live",b||"polite");e.setAttribute("id","ariaLoadingAlert");e.setAttribute("style","border: 0; clip: rect(0 0 0 0); height: 1px; margin: -1px; overflow: hidden; padding: 0; position: absolute; width: 1px;");
document.body.appendChild(e)},ariaObserveVisible:function(a,b){var e;a:{switch(b){case "helpVisible":e=this.unavHelp.viewElement();break a;case "accountVisible":e=this.unavAccount.viewElement();break a;case "cartVisible":e=this.unavCart.viewElement();break a}e=void 0}e&&e.setAttribute("aria-hidden",!a.newValue)},clickHandler:function(a){var b=a.target||a.srcElement,e="breadcrumb"===b.parentNode.parentNode.id,f=~b.parentNode.id.indexOf("u_")||~b.parentNode.id.indexOf("unav-");coherent.Browser.MobileSafari?
(this.preventClick&&(this.touchHandler(a,!1),this.preventClick=!1),this.touchHandler(a,!0)):this.menuLink&&f?(Event.stop(a),this.triggerKeyOpen(a)):!e&&f&&(Event.stop(a),this.onmouseenter(b.parentNode))},touchEndMenu:function(a){this.touchHandler(a,!0)},touchStartMenu:function(a){a.touches&&1===a.touches.length&&this.touchHandler(a,!1)},touchHandler:function(a,b){var e=(a.target||a.srcElement).parentNode.id||!1;e&&!~e.indexOf("u_")&&(e=a.srcElement.parentNode.parentNode&&a.srcElement.parentNode.parentNode.id);
e&&~e.indexOf("u_")&&(this.preventClick=!0,Event.stop(a),b&&this.setValueForKey(e,"visibleSection"))},keyboardShow:function(a){var b=(a.target||a.srcElement).parentNode.id||!1;b&&~b.indexOf("u_")?(this.menuLink=b,Event.stop(a)):(this.lockedToNav=!1,this.menuLink=void 0)},closeMenu:function(a){a=a.target||a.srcElement;do{if(a&&"utility-nav"===a.id||"user_nav"===a.id)return;a=a.parentNode}while(a&&a!==document.body);this.setValueForKey(null,"visibleSection")},keyboardNavDataLoadCallback:function(){this.lockedToNav&&
(this.currentNavEls=this.getVisibleNavContents(),this.currentNavEls[0].focus())},getNodeFromNav:function(a){switch(a){case "u_help":return this.unavHelp.viewElement();case "u_account":return this.unavAccount.viewElement();case "u_cart":return this.unavCart.viewElement();default:return""}},getVisibleNavContents:function(){for(var a=Element.queryAll(this.getNodeFromNav(this.menuLink),"a"),b=[],e=0,f=a.length;e<f;e++)a[e]&&"none"!==a[e].style.display&&b.push(a[e]);return b},keydown:function(a){var b=
a.keyCode,e=a.target||a.srcElement,f="breadcrumb"===e.parentNode.parentNode.id;b===Event.KEY_ESC&&this.lockedToNav&&(Event.stop(a),Element.query("#"+this.valueForKey("visibleSection")+" a").focus(),this.setValueForKey(null,"visibleSection"),this.lockedToNav=!1);this.lockedToNav&&b===Event.KEY_TAB&&(!a.shiftKey&&e===this.currentNavEls[this.currentNavEls.length-1]&&(Event.stop(a),this.currentNavEls[0].focus()),a.shiftKey&&e===this.currentNavEls[0]&&(Event.stop(a),this.currentNavEls[this.currentNavEls.length-
1].focus()));b===Event.KEY_RETURN&&!f&&this.triggerKeyOpen(a)},triggerKeyOpen:function(a){this.menuLink&&!this.lockedToNav&&(Event.stop(a),this.setValueForKey(this.menuLink,"visibleSection"),this.lockedToNav=!0,this.currentNavEls=this.getVisibleNavContents(),this.currentNavEls[0].focus())},getSurveyData:function(){return this.surveyData},surveyFeature:function(){return"Survey"},surveyEVar:function(){return"eVar5"},surveyElement:function(){var a=this.surveyData,b=unescape(a.surveyURL),e=window.s,f=
new Date,g=b,b=(-1===b.indexOf("?")?"?":"&")+"Pagename="+escape(e.pageName)+"&visitorID=",h=escape,i;a:{i="s_vi=";for(var j=document.cookie.split(";"),l=0;l<j.length;l++){for(var k=j[l];" "===k.charAt(0);)k=k.substring(1,k.length);if(0===k.indexOf(i)){i=k.substring(i.length,k.length);break a}}i=null}b=g+(b+h(i)+"&hit_time_gmt="+escape(f.toGMTString())+"&OS="+escape(e.n.oscpu));e=document.createElement("li");Element.setInnerHTML(e,'<a target="_blank" href="'+b+'"><span>'+a.surveyButtonText+"</span></a>");
Element.setStyle(e,"opacity",0);this.surveyElementId=Element.assignId(e);return e},surveyCallback:function(a){if(a){var b=$(this.surveyElementId),e=Element.query(document.body,"#user_nav ul, #guide_wrap ul");if(e){if(!this.surveyElementId||!b)b=e.getElementsByTagName("li")[0],b.parentNode.insertBefore(a,b),b=$(this.surveyElementId);Element.setStyle(b,"display","inline");coherent.Animator.setStyles(b,{opacity:1});apple.metrics.fireMicroEvent({feature:"Survey",action:"displayed"})}}},surveyCallbackHide:function(a){a.alreadyShown=
!1;var b=$(this.surveyElementId);b&&coherent.Animator.setStyles(b,{opacity:0},{callback:function(){Element.setStyle(b,"display","none")}})},discardCartData:function(){this.dataLoaded=!1},visibleSection:function(){return this.__visibleSection},dataFinishedLoading:function(){this.removeAriaAlert();this.setValueForKey(!0,"dataLoaded")},setVisibleSection:function(a){var b,e=this.__visibleSection;e&&((b=$(e))&&b)&&Element.removeClassName(b,"open");a&&((b=$(a))&&b)&&Element.addClassName(b,"open");a&&(!this.dataLoaded&&
"u_cart"===a)&&(this.createAriaAlert(document.createTextNode(Element.query("#utility-nav-loading .replaced").innerHTML||"Loading ...")),b=this.data.refresh(),b.addCallback(this.dataFinishedLoading.bind(this)),b.addCallback(this.keyboardNavDataLoadCallback.bind(this)));this.__visibleSection=a},helpVisible:function(){return"u_help"===this.__visibleSection},accountVisible:function(){return"u_account"===this.__visibleSection},cartVisible:function(){return this.dataLoaded&&"u_cart"===this.__visibleSection},
showSpinner:function(){return!this.dataLoaded&&"u_cart"===this.__visibleSection},data:DeferredJSON(),unsupportedCheckoutCheck:function(a){var b=this.valueForKeyPath("data.cart.unsupportedMessage");b&&(Event.stop(a),alert(b))},onmouseenter:function(a){function b(){this.__timer=null;this.setValueForKey(e,"visibleSection")}if(!coherent.Browser.MobileSafari){var e="";this.__timer&&(window.clearTimeout(this.__timer),this.__timer=null);switch(a.id){case "u_help":case "unav-help":e="u_help";break;case "u_account":case "unav-account":e=
"u_account";break;case "u_cart":case "unav-cart":e="u_cart";break;default:throw console.log("node= ",a.id),Error("Invalid node ID");}e&&(this.__timer=b.bindAndDelay(this,150));this.hoverNodeId=a.id}},onmouseleave:function(a){function b(){this.__timer=null;this.lockedToNav=!1;this.setValueForKey(null,"visibleSection")}a.id===this.hoverNodeId&&(this.__timer&&(window.clearTimeout(this.__timer),this.__timer=null),this.__timer=b.bindAndDelay(this,600),this.hoverNodeId="")}}),b;apple.utilitynav.UtilityNavViewController=
a;apple.utilitynav.UtilityNavViewController.singleton=function(){b||0<arguments.length&&(b=a.apply(b,arguments)());return b}})();Package("apple.widget");
apple.widget.CountrySelector=Class.create(coherent.View,{mouseoverDelay:150,showDuration:250,mouseoutDelay:50,hideDuration:250,contentLoaded:!1,trigger:coherent.Anchor("a.trigger",{action:"show"}),triggeredByKeyboard:!1,potentialTriggeredByKeyboard:!1,init:function(){this.getPreviousAndNextSiblings();var a=Element.query(".country-selector");if(a){var b=Element.assignId(a);this.viewElement().appendChild(a);this.countrySelector=new coherent.View(b)}this.positionCountrySelector();Event.observe(this.previousFocussableElement,
"focus",this.hide.bind(this));Event.observe(this.nextFocussableElement,"focus",this.hide.bind(this));Event.observe(this.viewElement(),"mouseover",this.mouseover.bind(this));Event.observe(this.viewElement(),"mouseout",this.mouseout.bind(this));Event.observe(this.countrySelector.viewElement(),"click",this.selectCountry.bind(this));Event.observe(this.trigger.viewElement(),"focus",this.focusTriggeredByKeyboard.bind(this));Event.observe(this.trigger.viewElement(),"blur",this.blurTriggeredByKeyboard.bind(this));
this.preloadCountrySelectorSprite.bindAndDelay(this,3E3);this._touchstart=this.touchstart.bind(this);this.keyDownObserver=this.observeKeyDown.bind(this);0<this.countrySelector.viewElement().innerHTML.trim().length&&(this.contentLoaded=!0);this.trigger.viewElement().setAttribute("aria-haspopup","true");this.trigger.viewElement().setAttribute("aria-owns","change-country-list");this.countrySelector.viewElement().setAttribute("aria-hidden","true");this.listOfCountries=Element.queryAll(".country-selector a");
this.listOfCountriesLength=this.listOfCountries.length;this.lastCountryLink=this.listOfCountries[this.listOfCountriesLength-1];this.firstCountryLink=this.listOfCountries[0]},getPreviousAndNextSiblings:function(){for(var a=this.trigger.viewElement(),b=Element.queryAll(".apple-footer a"),c=0,d=b.length;c<d;c++)if(b[c]==a){this.previousFocussableElement=b[c-1];this.nextFocussableElement=b[c+1];break}},positionCountrySelector:function(){for(var a=this.trigger.viewElement().offsetWidth,b=this.viewElement().previousSibling;1!=
b.nodeType;)b=b.previousSibling;b=b.getElementsByTagName("a")[0].offsetWidth;a=Math.round(a/2)+b-119;this.countrySelector.viewElement().style.left=a+"px"},preloadCountrySelectorSprite:function(){var a=this.trigger.viewElement();Element.addClassName(a,"preload-country-selector-sprite")},mouseover:function(){coherent.Browser.MobileSafari||(this.showTimer=this.show.bindAndDelay(this,this.mouseoverDelay),this.hideTimer&&(window.clearTimeout(this.hideTimer),this.hideTimer=null))},mouseout:function(){coherent.Browser.MobileSafari||
(this.hideTimer=this.hide.bindAndDelay(this,this.mouseoutDelay),this.showTimer&&(window.clearTimeout(this.showTimer),this.showTimer=null))},touchstart:function(a){if("block"==Element.query(".apple-footer .country-selector").style.display){a=a.target;do{if(a&&a===Element.query(".country-selector"))return;a=a.parentNode}while(a&&a!==document.body);this.hide()}},show:function(){this.countrySelector.viewElement().style.display="block";coherent.Animator.setStyles(this.countrySelector.viewElement(),{opacity:1},
{duration:this.showDuration});this.enableCloseObservers();this.countrySelector.viewElement().setAttribute("aria-hidden","false");!0===this.potentialTriggeredByKeyboard&&(this.triggeredByKeyboard=!0,this.firstCountryLink.focus())},hide:function(){var a=this.countrySelector.viewElement();coherent.Animator.setStyles(a,{opacity:0},{duration:this.hideDuration,callback:function(){a.style.display="none"}});this.triggeredByKeyboard&&(this.triggeredByKeyboard=!1);this.disableCloseObservers();this.countrySelector.viewElement().setAttribute("aria-hidden",
"true")},focusTriggeredByKeyboard:function(){this.potentialTriggeredByKeyboard=!0},blurTriggeredByKeyboard:function(){this.potentialTriggeredByKeyboard=!1},enableCloseObservers:function(){Event.observe(document.body,"keydown",this.keyDownObserver);Event.observe(document.body,"touchstart",this._touchstart)},disableCloseObservers:function(){Event.stopObserving(document.body,"keydown",this.keyDownObserver);Event.stopObserving(document.body,"touchstart",this._touchstart)},observeKeyDown:function(a){var b=
a.keyCode||a.which,c=a.shiftKey,d=Element.query("a.trigger"),e=a.target||a.srcElement;b==Event.KEY_ESC&&(this.hide(),d.focus(),e===d&&(this.triggeredByKeyboard=!0));b==Event.KEY_TAB&&(e===this.firstCountryLink&&!0===c)&&(Event.stop(a),this.lastCountryLink.focus());b==Event.KEY_TAB&&(e===this.lastCountryLink&&!1===c)&&(Event.stop(a),this.firstCountryLink.focus())},selectCountry:function(a){Event.stop(a);a=a.target||a.srcElement;"A"===a.nodeName&&(this.country=a,this.reportEvent(),this.redirect.bindAndDelay(this,
500))},reportEvent:function(){apple.metrics.fireMicroEvent({feature:"Country",action:"Selected: "+this.country.title})},redirect:function(){window.location=this.country.href}});Package("apple.widget");
apple.widget.FooterView=Class.create(coherent.View,{mouseoverDelay:150,showDuration:250,mouseoutDelay:50,hideDuration:250,triggeredByKeyboard:!1,potentialTriggeredByKeyboard:!1,countrySelector:coherent.View(".country-selector"),countryListItem:coherent.View("#change-country"),formatCookie:"platformPref=",__structure__:{"#mobile":coherent.Anchor({action:"handleFormatSwitch"}),"#format-switcher":coherent.View({visibleBinding:"showSwitcher"})},trigger:coherent.Anchor("a.trigger",{action:"show"}),init:function(){null!==
this.countrySelector&&this.initCountrySelector();this.displayFormatSwitcher()},getPreviousAndNextSiblings:function(){for(var a=this.trigger.viewElement(),b=Element.queryAll(".apple-footer a"),c=0,d=b.length;c<d;c++)if(b[c]==a){this.previousFocussableElement=b[c-1];this.nextFocussableElement=b[c+1];break}},initCountrySelector:function(){this.getPreviousAndNextSiblings();var a=Element.query(".country-selector");this.countryListItem.viewElement().appendChild(a);this.positionCountrySelector();Event.observe(this.previousFocussableElement,
"focus",this.hide.bind(this));Event.observe(this.nextFocussableElement,"focus",this.hide.bind(this));Event.observe(this.countryListItem.viewElement(),"mouseover",this.mouseover.bind(this));Event.observe(this.countryListItem.viewElement(),"mouseout",this.mouseout.bind(this));Event.observe(document.body,"click",this.hide.bindAsEventListener(this));Event.observe(this.countrySelector.viewElement(),"click",this.selectCountry.bind(this));Event.observe(this.trigger.viewElement(),"focus",this.focusTriggeredByKeyboard.bind(this));
Event.observe(this.trigger.viewElement(),"blur",this.blurTriggeredByKeyboard.bind(this));this.preloadCountrySelectorSprite.bindAndDelay(this,3E3);this._touchstart=this.touchstart.bind(this);this.trigger.viewElement().setAttribute("aria-haspopup","true");this.trigger.viewElement().setAttribute("aria-owns","change-country-list");this.countrySelector.viewElement().setAttribute("aria-hidden","true");this.listOfCountries=Element.queryAll(".country-selector a");this.listOfCountriesLength=this.listOfCountries.length;
this.lastCountryLink=this.listOfCountries[this.listOfCountriesLength-1];this.firstCountryLink=this.listOfCountries[0]},positionCountrySelector:function(){for(var a=this.trigger.viewElement().offsetWidth,b=this.countryListItem.viewElement().previousSibling;1!=b.nodeType;)b=b.previousSibling;b=b.getElementsByTagName("a")[0].offsetWidth;a=Math.round(a/2)+b-119;this.countrySelector.viewElement().style.left=a+"px"},preloadCountrySelectorSprite:function(){var a=this.trigger.viewElement();Element.addClassName(a,
"preload-country-selector-sprite")},mouseover:function(){coherent.Browser.MobileSafari||(this.showTimer=this.show.bindAndDelay(this,this.mouseoverDelay),this.hideTimer&&(window.clearTimeout(this.hideTimer),this.hideTimer=null))},mouseout:function(){coherent.Browser.MobileSafari||(this.hideTimer=this.hide.bindAndDelay(this,this.mouseoutDelay),this.showTimer&&(window.clearTimeout(this.showTimer),this.showTimer=null))},touchstart:function(a){if("block"==Element.query(".apple-footer .country-selector").style.display){a=
a.target;do{if(a&&a===Element.query(".country-selector"))return;a=a.parentNode}while(a&&a!==document.body);this.hide()}},show:function(){this.countrySelector.viewElement().style.display="block";coherent.Animator.setStyles(this.countrySelector.viewElement(),{opacity:1},{duration:this.showDuration});this.enableCloseObservers();this.countrySelector.viewElement().setAttribute("aria-hidden","false");!0===this.potentialTriggeredByKeyboard&&(this.triggeredByKeyboard=!0,this.firstCountryLink.focus())},hide:function(a){a=
a?a.target||a.srcElement:void 0;if(!(a&&a===this.countrySelector.viewElement()||a===this.trigger.viewElement())){var b=this.countrySelector.viewElement();coherent.Animator.setStyles(b,{opacity:0},{duration:this.hideDuration,callback:function(){b.style.display="none"}});this.triggeredByKeyboard&&(this.triggeredByKeyboard=!1);this.disableCloseObservers();this.countrySelector.viewElement().setAttribute("aria-hidden","true")}},focusTriggeredByKeyboard:function(){this.potentialTriggeredByKeyboard=!0},
blurTriggeredByKeyboard:function(){this.potentialTriggeredByKeyboard=!1},enableCloseObservers:function(){Event.observe(document.body,"keydown",this.observeKeyDown.bindAsEventListener(this));Event.observe(document.body,"touchstart",this._touchstart)},disableCloseObservers:function(){Event.stopObserving(document.body,"keydown",this.observeKeyDown.bindAsEventListener(this));Event.stopObserving(document.body,"touchstart",this._touchstart)},observeKeyDown:function(a){var b=a.keyCode,c=a.shiftKey,d=Element.query("a.trigger"),
e=a.target||a.srcElement;b==Event.KEY_ESC&&(this.hide(),d.focus(),e===d&&(this.triggeredByKeyboard=!0));b==Event.KEY_TAB&&(e===this.firstCountryLink&&!0===c)&&(Event.stop(a),this.lastCountryLink.focus());b==Event.KEY_TAB&&(e===this.lastCountryLink&&!1===c)&&(Event.stop(a),this.firstCountryLink.focus())},selectCountry:function(a){Event.stop(a);a=a.target||a.srcElement;"A"===a.nodeName&&(this.country=a,this.reportEvent(),this.redirect.bindAndDelay(this,500))},reportEvent:function(){apple.metrics.fireMicroEvent({feature:"Country",
action:"Selected: "+this.country.title})},redirect:function(){window.location=this.country.href},handleFormatSwitch:function(a){this.fireFormatChangeEvent(a);(function(){this.deleteFormatCookie(a)}).bindAndDelay(this,500)},fireFormatChangeEvent:function(a){if((a=a&&a.viewElement())&&a.hasAttribute("data-sprop36"))a=a.getAttribute("data-sprop36"),a=apple.metrics._stringToEvent(a),a.eVar="prop36",a.excludeAosNamespace=!0,apple.metrics.fireMicroEvent(a)},deleteFormatCookie:function(){var a=new Date;
a.setDate(a.getDate()-1);document.cookie=this.formatCookie+"''; expires="+a.toUTCString()+"; path=/; domain=.apple.com";window.location.reload()},displayFormatSwitcher:function(){document.cookie.match(this.formatCookie)||Element.query(this.viewElement(),".format-switcher-show")?this.setValueForKey(!0,"showSwitcher"):this.setValueForKey(!1,"showSwitcher")}});
window.apple.survey={alreadyShown:!1,defaults:{trafficPercentage:15,surveyDelay:0},surveyButton:function(a){var b=a.getSurveyData();if(!b)return!1;if(!b.cartValue||!$("sidebar-summary-total")&&!$("cart-summary-order-total"))this.surveyButtonBuild(a);else{var c=Element.hasClassName(document.getElementsByTagName("body")[0],"checkout"),d=Element.hasClassName(document.getElementsByTagName("body")[0],"thankyou"),e=function(){c&&!d||$("sidebar-summary-total")&&coherent.View.fromNode($("sidebar-summary-total"))&&
""!==$("sidebar-summary-total").innerHTML||$("cart-summary-order-total")&&coherent.View.fromNode($("cart-summary-order-total"))&&""!==$("cart-summary-order-total").innerHTML?(window.controller&&window.controller.addObserverForKeyPath(window.apple.survey,null,"content.cart.summary.total",a),window.apple.survey.surveyButtonBuild(a)):window.setTimeout(e,50)};e()}return!0},observeChangeForKeyPath:function(a,b,c){this.surveyButtonBuild(c)},surveyButtonBuild:function(a){function b(){var b;a.surveyElementId&&
$(a.surveyElementId)?b=$(a.surveyElementId):(b=a.surveyElement(),Event.observe(b.getElementsByTagName("a")[0],"click",function(){c(a)}));return b}function c(a){apple.metrics.fireMicroEvent({eVar:a.surveyEVar(),feature:a.surveyFeature(),action:"selected"});e.set("csat_last_surveyed_date",f);a.surveyCallbackHide(this)}var d=a.getSurveyData(),e=new Storage,f=new Date,g=e.get("csat_last_surveyed_date");if(g&&(g=new Date(g),1<=Math.ceil((f.getTime()-g.getTime())/15552E6)))return a.surveyCallbackHide(this),
!1;g=new Date(d.endDate);if(f<new Date(d.startDate)||f>g)return a.surveyCallbackHide(this),!1;var g=d.surveyStart.split(":"),h=d.surveyEnd.split(":"),i=f.getHours(),j=f.getMinutes();if(i<g[0]||i>h[0]||i==g[0]&&(j<g[1]||j>h[1]))return a.surveyCallbackHide(this),!1;i="SUNDAY MONDAY TUESDAY WEDNESDAY THURSDAY FRIDAY SATURDAY".split(" ")[f.getDay()];j={};g=0;for(h=d.activeDays.length;g<h;g++)j[d.activeDays[g]]="";if(!i in j)return a.surveyCallbackHide(this),!1;if(d.operatingSystem.length){i="windows";
-1!=navigator.appVersion.indexOf("Mac")&&(i="macosx");-1!=navigator.appVersion.indexOf("X11")&&(i="linux");-1!=navigator.appVersion.indexOf("Linux")&&(i="linux");-1!=navigator.appVersion.indexOf("SunOS")&&(i="sunos");j={};g=0;for(h=d.operatingSystem.length;g<h;g++)j[d.operatingSystem[g]]="";if(!i in j)return a.surveyCallbackHide(this),!1}g=d.trafficPercentage?parseInt(d.trafficPercentage,10):window.apple.survey.defaults.trafficPercentage;if(Math.ceil(100*Math.random())>g&&!this.alreadyShown||d.referrer&&
-1===document.referrer.indexOf(d.referrer))return a.surveyCallbackHide(this),!1;g=Element.hasClassName(document.getElementsByTagName("body")[0],"checkout");h=Element.hasClassName(document.getElementsByTagName("body")[0],"thankyou");i=Element.hasClassName(document.getElementsByTagName("body")[0],"cart");if(d.cartValue&&d.cartActualValue){if(g=parseFloat(d.cartActualValue.replace(/[^\d.]/g,"")),parseFloat(d.cartValue)>g)return a.surveyCallbackHide(this),!1}else if(d.cartValue&&(g||h||i))if(g=parseFloat(window.controller.valueForKeyPath("content.cart.summary.total").replace(/[^\d.]/g,
"")),parseFloat(d.cartValue)>g)return a.surveyCallbackHide(this),!1;window.setTimeout(function(){a.surveyCallback(b(a))},d.timeSpentOnPage?1E3*d.timeSpentOnPage:window.apple.survey.defaults.surveyDelay);return this.alreadyShown=!0}};
coherent.DynamicMenu=Class.create(coherent.View,{exposedBindings:["model"],init:function(){this.addObserverForKeyPath(this,this.updateState,"model.open")},updateState:function(){var a=this.valueForKeyPath("model.open");a?this.openMenu():this.closeMenu();this.setValueForKeyPath(a,"model.contentUpdated");this.setValueForKeyPath(a,"model.isOpen")},closeMenu:function(){Element.removeClassName(this.viewElement(),"visible");this.model.manager&&this.model.manager.clear()},openMenu:function(){Element.addClassName(this.viewElement(),
"visible");this.model.contentURL&&!this.model.response&&(this.addObserverForKeyPath(this,this.model.contentResponse,"model.response"),XHR.get(this.model.contentURL).addMethods(this.getResponseDelegate(),this.getResponseDelegate()),this.viewElement().innerHTML="<div class='spinner'></div>");if(this.model.manager){var a=this.model.manager.getLastView();a&&a.setValueForKeyPath(!1,"model.open");this.model.manager.setNextView(this)}},getResponseDelegate:function(){var a=this;return function(b){a.setValueForKeyPath(b,
"model.response");a.setValueForKeyPath(b,"model.contentUpdated")}}});coherent.DynamicMenuManager=Class.create({lastId:null,setNextView:function(a){this.lastId=a.viewElement().id},clear:function(){this.lastId=null},getLastId:function(){return this.lastId},getLastElem:function(){return $(this.getLastId())},getLastView:function(){if(this.getLastElem())return coherent.View.fromNode(this.getLastElem())}});
coherent.CompoundLink=Class.create(coherent.View,{exposedBindings:["menuModel"],__structure__:{".dynamic-menu":coherent.DynamicMenu({modelBinding:"*.menuModel"}),"a[target!=_blank]":coherent.Anchor({action:"resetMenu"}),".handle a":coherent.Anchor({action:"click"})},init:function(){Event.observe(this.viewElement(),"mouseover",this.viewOver.bindAsEventListener(this));Event.observe(this.viewElement(),"mouseout",this.viewOut.bindAsEventListener(this))},getMenu:function(){return Element.query(this.viewElement(),
".dynamic-menu")},viewOver:function(){window.clearTimeout(this.valueForKey("viewOverTimeout"))},viewOut:function(){var a=this,b=window.setTimeout(function(){a.setValueForKeyPath(!1,"menuModel.open")},250);this.setValueForKey(b,"viewOverTimeout")},click:function(a,b){Event.stop(b);this.valueForKeyPath("menuModel.open")?(this.setValueForKeyPath(!1,"menuModel.open"),Element.setStyles(this.viewElement(),{"z-index":"auto"})):(this.setValueForKeyPath(!0,"menuModel.open"),Element.setStyles(this.viewElement(),
{"z-index":2E3}))},resetMenu:function(){var a=this,b=window.setTimeout(function(){a.setValueForKeyPath(!1,"menuModel.open");Element.setStyles(a.viewElement(),{"z-index":"auto"})},350);this.setValueForKey(b,"viewOverTimeout");this.setValueForKeyPath(!1,"handleDown")}});
coherent.CompoundButton=Class.create(coherent.View,{exposedBindings:["menuModel","name","value","menuEnabled"],__structure__:{".handle":coherent.View({action:"click"}),".dynamic-menu":coherent.DynamicMenu({modelBinding:"*.menuModel"})},getPrimaryButton:Part(".button"),getPrimaryButtonLabel:Part(".button .label"),getHandle:Part(".handle"),getMenu:Part(".dynamic-menu"),init:function(){this.getHandle()&&(coherent.page.addTrackingInfo(this.viewElement().id,{owner:this,onmouseenter:this.onmouseenter,onmouseleave:this.onmouseleave}),
this.addObserverForKeyPath(this,this.updateHandle,"menuModel.open"),this.addObserverForKeyPath(this,this.reposition,"menuModel.contentUpdated"),this.addObserverForKeyPath(this,this.updateHandle,"handleDown"),Element.addClassName(this.viewElement(),"init"),Element.addClassName(this.getPrimaryButton(),"init"),Element.addClassName(this.getHandle(),"init"))},canToggleMenu:!0,onmouseenter:function(){this.canToggleMenu&&(window.clearTimeout(this.valueForKey("viewOverTimeout")),this.setValueForKeyPath(!0,
"handleDown"))},onmouseleave:function(){this.canToggleMenu&&this.resetMenu()},observeHtmlChange:function(a){a.newValue&&this.getPrimaryButton()&&(this.getPrimaryButtonLabel().innerHTML=a.newValue)},observeValueChange:function(a){a.newValue&&this.getPrimaryButton()&&(this.getPrimaryButton().attributes.value.nodeValue=a.newValue)},observeNameChange:function(a){a.newValue&&this.getPrimaryButton()&&(this.getPrimaryButton().name=a.newValue)},observeMenuEnabledChange:function(a){null!==a.newValue&&(((this.canToggleMenu=
a.newValue)?Element.addClassName:Element.removeClassName)(this.viewElement(),coherent.CompoundButton.compoundBtnClassName),this.viewElement().parentNode.className+="")},resetMenu:function(){var a=this,b=window.setTimeout(function(){a.setValueForKeyPath(!1,"menuModel.open");Element.setStyles(a.viewElement(),{"z-index":"auto"})},350);this.setValueForKey(b,"viewOverTimeout");this.setValueForKeyPath(!1,"handleDown")},updateHandle:function(){this.getHandle()&&(this.valueForKeyPath("menuModel.open")||this.valueForKeyPath("handleDown")?
Element.addClassName(this.getHandle(),"hover"):Element.removeClassName(this.getHandle(),"hover"))},click:function(a,b){Event.stop(b);this.valueForKeyPath("menuModel.open")?(this.setValueForKeyPath(!1,"menuModel.open"),Element.setStyles(this.viewElement(),{"z-index":"auto"})):(this.setValueForKeyPath(!0,"menuModel.open"),Element.setStyles(this.viewElement(),{"z-index":2E4}))},reposition:function(a){if(a.newValue){Element.setStyles(this.getMenu(),{width:"auto"});var b=Element.getRect(this.getPrimaryButton()),
a=Element.getRect(this.getHandle()),c=Element.getRect(this.getMenu()),b=b.width;Element.setStyles(this.getMenu(),{width:(c.width>b?c.width:b)+"px",top:a.height+1+"px"})}},findFormFromElement:function(a){a=a.parentElement||a.parentNode;return"FORM"==a.tagName?a:this.findFormFromElement(a)},teardown:function(){this.getHandle()&&(coherent.View.fromNode(this.getHandle()).teardown(),coherent.View.fromNode(this.getMenu()).teardown());this.base()}});coherent.CompoundButton.compoundBtnClassName="compound-button";
Package("apple.widget");apple.widget.EqualizeCopy=function(){var a=Element.queryAll(".equalize .copy");if(a){var b=0,c=0;a.forEach(function(a){Element.setStyle(a,"height","");c=parseInt(Element.getStyles(a,"height").replace("px",""),10);b=Math.max(b,c)});a.forEach(function(a){Element.setStyle(a,"height",b+"px")})}};
apple.SocialSharingCompoundLink=Class.create(coherent.CompoundLink,{__structure__:{"a[target]":coherent.Anchor({action:"linkClicked"})},linkClicked:function(a){var b="",c=new coherent.URL(document.location.href);c&&(c=c.path.match(/(\w{5,7}\/\w)$/),1<c.length&&(b=c[1]));apple.metrics.fireMicroEvent({eVar:"eVar6",part:b,feature:"Sharing",action:a.viewElement().className+" post"});this.resetMenu()}});
apple.initSocialSharingCompoundLinks=function(){for(var a=new coherent.DynamicMenuManager,b=Element.queryAll(".compound-link.social-sharing"),c=0;c<b.length;c++)new apple.SocialSharingCompoundLink(b[c],{menuModel:{manager:a}},{menuModelBinding:"*.menuModel"})};Event.onLoad(apple.initSocialSharingCompoundLinks);
coherent.FormField=Class.create(coherent.View,{exposedBindings:["value","name"],observeValueChange:function(a){this.viewElement().value=a.newValue},observeNameChange:function(a){this.viewElement().name=a.newValue}});
apple.AddToCartCompoundButton=Class.create(coherent.CompoundButton,{exposedBindings:["model","modes"],__structure__:{"a[target]":coherent.Anchor({action:"linkClicked"}),"button.button":coherent.FormField({nameBinding:"$modes.$model.primaryButtonMode$.name",titleBinding:"$modes.$model.primaryButtonMode$.title",classBinding:"$modes.$model.primaryButtonMode$.buttonClass"}),".handle":coherent.View({classBinding:"$modes.$model.primaryButtonMode$.handleClass",action:"click"}),"button.button .label":coherent.View({textBinding:"$modes.$model.primaryButtonMode$.html"}),
".BuyNow":coherent.View({visibleBinding:"model.buyNowEnabled",enabledBinding:"model.buyNowAvailable"}),".BuyNow button":coherent.FormField({nameBinding:"$modes.$model.buyNowButtonMode$.name",titleBinding:"$modes.$model.buyNowButtonMode$.title",textBinding:"$modes.$model.buyNowButtonMode$.html",enabledBinding:"model.buyNowAvailable"}),".BuyNow-SignUp":coherent.View({visibleBinding:"model.buyNowEnabled(not)",enabledBinding:"model.buyNowAvailable"})},init:function(){this.base();var a=$("gift-checkbox");
a&&Event.observe(a,"click",this.giftStateChanged.bind(this))},giftStateChanged:function(a){this.setValueForKeyPath(!(a.target?a.target.checked:a.srcElement.checked),"model.buyNowAvailable");this.model.buyNowEnabled&&(this.model.buyNowAvailable?(this.setValueForKeyPath("buynow","model.primaryButtonMode"),this.setValueForKeyPath("default","model.buyNowButtonMode")):(this.setValueForKeyPath("default","model.primaryButtonMode"),this.setValueForKeyPath("buynow","model.buyNowButtonMode")))},linkClicked:function(a){var b=
this.findFormFromElement(a.viewElement()).product;apple.metrics.fireMicroEvent({eVar:"eVar6",part:b?b.value:"",feature:"Sharing",action:a.viewElement().className+" post"});this.resetMenu();coherent.Browser.IE&&7==coherent.Browser.IE&&this.base()}});apple.buyNowEnabled=apple.cookie("aosqbe");
apple.initAddToCartCompoundButtons=function(){for(var a=new coherent.DynamicMenuManager,b=Element.queryAll(".compound-button.add-to-cart"),c=0,d=b.length;c<d;c++){var e=coherent.View.fromNode(b[c]);e&&e.teardown();var e=Element.query(b[c],"button.button"),f=Element.query(b[c],"button.handle"),g=Element.query(e,".label"),h=$("gift-checkbox"),e={menuModel:{manager:a},buttonModel:{buyNowAvailable:h?!h.checked:!0,buyNowEnabled:apple.buyNowEnabled?!0:!1,primaryButtonMode:"default"},buttonModes:{"default":{name:e.name,
title:e.title,value:e.value,html:g.textContent||g.innerText,buttonClass:e?e.className:"",handleClass:f?f.className:""}}};if(apple.buyNowEnabled){if(f=Element.query(b[c],".BuyNow button"))e.buttonModel.buyNowButtonMode="buynow",e.buttonModes.buynow={name:f.name,title:f.title,value:f.value,html:f.textContent||f.innerText,buttonClass:"button transactional",handleClass:"handle transactional"};f&&e.buttonModel.buyNowAvailable&&(e.buttonModel.primaryButtonMode="buynow",e.buttonModel.buyNowButtonMode="default")}new apple.AddToCartCompoundButton(b[c],
e,{modelBinding:"*.buttonModel",modesBinding:"*.buttonModes",menuModelBinding:"*.menuModel"})}};Event.onLoad(apple.initAddToCartCompoundButtons);"undefined"===typeof window.apple&&(window.apple={});
(function(a){function b(b,c,d,e){this.xhr=new a.XMLHttpRequest;this.xhr.onload=function(a){a.target&&200===a.target.status?c(a.target):d(a.target)};this.xhr.onerror=function(a){d(a.target)};try{this.xhr.open(e||"GET",b,!0),this.xhr.send()}catch(f){d(f)}}function c(){new b(h.bannerNodeUrl,function(b){var c=[],d=new String(b.responseText.replace(RegExp("(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)","img"),function(a,b){c.push(b);return""}));d.scripts=c;var e=function(){x.parentNode.removeChild(x);g.parentNode.removeChild(g)},
f=function(b,c){b.preventDefault();b.stopPropagation();c&&w("app overlay close button clicked");var d=parseInt(l.getItem(i),10)||0,f=parseInt(k.getItem(j),10)||0;l.setItem(i,d+1);k.setItem(j,f+1);a.removeEventListener("scroll",p,!1);y.removeEventListener("touchstart");y.removeEventListener("touchmove");v&&v.setAttribute("aria-hidden","false");y.addEventListener("webkitTransitionEnd",e,!1);y.style.webkitTransform="translateY(-"+(y.offsetHeight+h.offsetY)+"px)"},b=function(b){for(var c=b.target,d=null,
e=null;c&&c!==y&&c!==document.documentElement;){if(c.className){if(c.className.match(/close/)){e=c;break}if(c.className.match(/download/)){d=c;break}}c=c.parentNode}e&&f(b,!0);d&&(b.preventDefault(),b.stopPropagation(),w("app overlay download link clicked"),l.setItem(i,h.viewLimit),k.setItem(j,h.sessionViewLimit),f(b,!1),a.setTimeout(function(){a.location.href=b.target.href},500))},p=function(){var b=(Math.max(h.offsetY,a.pageYOffset)+20)/h.scaleFactor;y.style.webkitTransform="translateY("+b+"px)"},
w=function(b){a.s&&a.s.tl(!0,"o","Mobile Overlay",{linkTrackVars:"prop36",prop36:b})};a["mobile-banner-loaded"]=!0;var v=document.getElementById("page");v&&v.setAttribute("aria-hidden","true");var t=document.createDocumentFragment(),z="ontouchstart"in a,x=document.createElement("DIV");x.innerHTML=['    <div id="applestoreapp" ',1!==h.scaleFactor?'style="-webkit-transform: scale(0.32)"':"",">        <section>",d,'        </section>    </div>    <div id="applestoreapp-mask">    </div>'].join("");t.appendChild(x);
var d=x.querySelector("#applestoreapp"),y=d.querySelector("section");y.style.webkitTransition="-webkit-transform ease 350ms";document.documentElement.insertBefore(t,document.documentElement.firstChild);a.addEventListener("scroll",p,!1);z?(y.addEventListener("touchstart",b,!1),y.addEventListener("touchmove",function(a){a.preventDefault()},!0)):(y.addEventListener("mousedown",b,!1),y.addEventListener("mousemove",function(a){a.preventDefault()},!0));d.className="revealed";a.addEventListener("load",p,
!1);if((b=y.querySelectorAll("#apstoreurl,#apstoreurl2"))&&b.length){t=0;for(z=b.length;t<z;t++)b[t].setAttribute("href",h.storeUrl)}w("app overlay displayed")},function(a){console.log("error",a)})}function d(){h.bannerNodeUrl=h.bannerNodeUrl||a.appleStoreAppBannerNode;h.storeUrl=h.storeUrl||a.appleStoreAppUrl;k.getItem(j)<h.sessionViewLimit&&l.getItem(i)<h.viewLimit&&(a.isAnotherDialogOpen?a.__defineSetter__("dialog-dismissed",function(a){a&&c()}):c())}try{a.sessionStorage.setItem("pbCheck","1"),
a.sessionStorage.removeItem("pbCheck")}catch(e){return}var f=document.getElementsByTagName("script"),g=f[f.length-1],h=(f=g&&g.innerHTML)?JSON.parse(f):{};h.scaleFactor=h.scaleFactor||(481>document.documentElement.clientWidth?0.32:1);h.offsetY=(h.offsetY||80)*h.scaleFactor;h.expiry=h.expiry||30;if(!h.skip&&!a.isAppleStoreAppDisabled){var i="AppleStoreAppBannerViews",j="AppleStoreAppBannerSessionViews";h.viewLimit=h.viewLimit||2;h.sessionViewLimit=h.sessionViewLimit||1;f=function(a,b){this.storage=
a;this.MAX_EXPIRY=b&&b.DEFAULT_EXPIRY||365};f.prototype.setItem=function(a,b,c){this.storage.getItem(a);b={value:b,timestamp:Date.now()+864E5*("number"===typeof c?c:this.MAX_EXPIRY)};this.storage.setItem(a,JSON.stringify(b))};f.prototype.getItem=function(a){var b=this.storage.getItem(a);if(b){b=JSON.parse(b);if(b.timestamp>Date.now())return b.value;this.storage.removeItem(a)}return null};var l=new f(a.localStorage,{DEFAULT_EXPIRY:h.expiry}),k=new f(a.sessionStorage,{DEFAULT_EXPIRY:h.expiry});"undefined"===
typeof a.apple?d():a.apple.MobileBanner=d}})(window);
Event.onDomReady(function(){if(/#(.*)Replacement/.test(window.location.href)){coherent.Browser.IE&&9>coherent.Browser.IE||(window.location.hash="");var a,b;b=$("#productReplacedMessageOverlayContent");var c=$("#productReplacedMessageOverlayCloseButton");b&&(b=document.createElement("DIV"),b.id="productReplacedMessageOverlay",b.className="overlay",document.body.appendChild(b),a=new coherent.Overlay("productReplacedMessageOverlay"),a.setDelegate({willShowOverlay:function(){c&&Event.observe(c,"click",
a.hide.bind(a))}}),a.display({sourceId:"productReplacedMessageOverlayContent"}))}});Package("apple.fcs");function supportsLocalStorage(){try{return window.localStorage}catch(a){return!1}}function getDataFromCookie(a){for(var b=document.cookie.split(";"),c=0;b.length>c;c++){var d=b[c].substr(0,b[c].indexOf("=")),e=b[c].substr(b[c].indexOf("=")+1),d=d.replace(/^\s+|\s+$/g,"");if(d==a)return unescape(e)}}
function getReferrerDomain(){var a=document.referrer;if("undefined"!==typeof a){a=a.split("/");if(null!=a&&3<=a.length)var b=a[2];return b}return" "}
apple.fcs.storeFcsData=function(){this.localStorageKey="fcs1";this.localStorageCounterKey="fcs2";if(supportsLocalStorage())if(null==localStorage.getItem(this.localStorageKey))data={RD:getReferrerDomain(),LPU:document.URL,SST:Math.round((new Date).getTime()/1E3)},localStorage.setItem(this.localStorageKey,JSON.stringify(data)),localStorage.setItem(this.localStorageCounterKey,1);else{var a=localStorage.getItem(this.localStorageCounterKey);localStorage.setItem(this.localStorageCounterKey,++a)}};window.s_account||(s_account="applestoreunspecified");var s=s_gi(s_account);s.currencyCode="USD";s.trackDownloadLinks=!0;s.trackExternalLinks=!0;s.trackInlineStats=!0;s.linkDownloadFileTypes="zip,wav,mp3,mp4,doc,pdf,xls,rss,dmg,sit,pkg,exe,xml,mov";s.linkInternalFilters="javascript:,epp.apple.com,storeint.apple.com,store.apple.com";s.linkLeaveQueryString=!1;s.linkTrackVars="prop3";s.linkTrackEvents="None";s.usePlugins=!0;
function s_doPlugins(a){a.campaign||(a.campaign=a.getQueryParam("cid"),a.campaign=a.getValOnce(a.campaign,"s_campaign",0),a.setClickMapEmail("Email_PageName,Email_OID","Email_OT"));a.eVar7||(a.eVar7=a.getQueryParam("aid"),a.eVar7=a.getValOnce(a.eVar7,"s_aid"));a.prop6=a.getQueryParam("cp")+": "+a.pageName;a.eVar10||(a.eVar10=a.getQueryParam("afid"),a.eVar10=a.getValOnce(a.eVar10,"s_afc"));a.eVar7&&(a.eVar7.match(/CONFIGURE/)?(a.eVar16=a.prop16="Configure Orders",a.events="event14"):a.eVar7.match(/BUYNOW/)&&
(a.eVar16=a.prop16="Buy Nows",a.events="event9"));if("boolean"==typeof _vis_opt_settings_loaded){var b=_vis_opt_readCookie("_vis_opt_exp_"+_vis_opt_experiment_id+"_combi");"undefined"!=typeof _vis_opt_comb_name[b]&&(a.eVar15=_vis_opt_experiment_id+":"+_vis_opt_comb_name[b])}}s.doPlugins=s_doPlugins;s.getQueryParam=new Function("p","d","u","var s=this,v='',i,t;d=d?d:'';u=u?u:(s.pageURL?s.pageURL:s.wd.location);if(u=='f')u=s.gtfs().location;while(p){i=p.indexOf(',');i=i<0?p.length:i;t=s.p_gpv(p.substring(0,i),u+'');if(t){t=t.indexOf('#')>-1?t.substring(0,t.indexOf('#')):t;}if(t)v+=v?d+t:t;p=p.substring(i==p.length?i:i+1)}return v");
s.p_gpv=new Function("k","u","var s=this,v='',i=u.indexOf('?'),q;if(k&&i>-1){q=u.substring(i+1);v=s.pt(q,'&','p_gvf',k)}return v");s.p_gvf=new Function("t","k","if(t){var s=this,i=t.indexOf('='),p=i<0?t:t.substring(0,i),v=i<0?'True':t.substring(i+1);if(p.toLowerCase()==k.toLowerCase())return s.escp(v)}return ''");s.escp=new Function("x","var s=this;if(typeof(decodeURI)=='function'&&x)return decodeURI(s.rep(''+x,'+',' '));else return unescape(s.rep(''+x,'+',' '));");
s.getValOnce=new Function("v","c","e","var s=this,a=new Date,v=v?v:v='',c=c?c:c='s_gvo',e=e?e:0,k=s.c_r(c);if(v){a.setTime(a.getTime()+e*86400000);s.c_w(c,v,e?a:0);}return v==k?'':v");s.setClickMapEmail=new Function("qp","ot","var s=this,v=s.getQueryParam(qp,'~'),d,pn,oid,ot=s.getQueryParam(ot),ot=ot?ot:'A',cv;d=v.indexOf('~');if(!v)return '';if(d>-1){pn=v.substring(0,d);oid=v.substring(d+1);}cv='&pid='+s.ape(s.fl(pn,255))+'&pidt=1&oid='+s.ape(s.fl(oid,100))+'&oidt=1&ot='+ot+'&oi=1';s.sq(cv);");
s.setupFormAnalysis=new Function("var s=this;if(!s.fa){s.fa=new Object;var f=s.fa;f.ol=s.wd.onload;s.wd.onload=s.faol;f.uc=s.useCommerce;f.vu=s.varUsed;f.vl=f.uc?s.eventList:'';f.tfl=s.trackFormList;f.fl=s.formList;f.va=new Array('','','','')}");s.sendFormEvent=new Function("t","pn","fn","en","var s=this,f=s.fa;t=t=='s'?t:'e';f.va[0]=pn;f.va[1]=fn;f.va[3]=t=='s'?'Success':en;s.fasl(t);f.va[1]='';f.va[3]='';");s.faol=new Function("e","var s=s_c_il["+s._in+"],f=s.fa,r=true,fo,fn,i,en,t,tf;if(!e)e=s.wd.event;f.os=new Array;if(f.ol)r=f.ol(e);if(s.d.forms&&s.d.forms.length>0){for(i=s.d.forms.length-1;i>=0;i--){fo=s.d.forms[i];fn=fo.name;tf=f.tfl&&s.pt(f.fl,',','ee',fn)||!f.tfl&&!s.pt(f.fl,',','ee',fn);if(tf){f.os[fn]=fo.onsubmit;fo.onsubmit=s.faos;f.va[1]=fn;f.va[3]='No Data Entered';for(en=0;en<fo.elements.length;en++){el=fo.elements[en];t=el.type;if(t&&t.toUpperCase){t=t.toUpperCase();var md=el.onmousedown,kd=el.onkeydown,omd=md?md.toString():'',okd=kd?kd.toString():'';if(omd.indexOf('.fam(')<0&&okd.indexOf('.fam(')<0){el.s_famd=md;el.s_fakd=kd;el.onmousedown=s.fam;el.onkeydown=s.fam}}}}}f.ul=s.wd.onunload;s.wd.onunload=s.fasl;}return r;");
s.faos=new Function("e","var s=s_c_il["+s._in+"],f=s.fa,su;if(!e)e=s.wd.event;if(f.vu){s[f.vu]='';f.va[1]='';f.va[3]='';}su=f.os[this.name];return su?su(e):true;");s.fasl=new Function("e","var s=s_c_il["+s._in+"],f=s.fa,a=f.va,l=s.wd.location,ip=s.trackPageName,p=s.pageName;if(a[1]!=''&&a[3]!=''){a[0]=!p&&ip?l.host+l.pathname:a[0]?a[0]:p;if(!f.uc&&a[3]!='No Data Entered'){if(e=='e')a[2]='Error';else if(e=='s')a[2]='Success';else a[2]='Abandon'}else a[2]='';var tp=ip?a[0]+':':'',t3=e!='s'?':('+a[3]+')':'',ym=!f.uc&&a[3]!='No Data Entered'?tp+a[1]+':'+a[2]+t3:tp+a[1]+t3,ltv=s.linkTrackVars,lte=s.linkTrackEvents,up=s.usePlugins;if(f.uc){s.linkTrackVars=ltv=='None'?f.vu+',events':ltv+',events,'+f.vu;s.linkTrackEvents=lte=='None'?f.vl:lte+','+f.vl;f.cnt=-1;if(e=='e')s.events=s.pt(f.vl,',','fage',2);else if(e=='s')s.events=s.pt(f.vl,',','fage',1);else s.events=s.pt(f.vl,',','fage',0)}else{s.linkTrackVars=ltv=='None'?f.vu:ltv+','+f.vu}s[f.vu]=ym;s.usePlugins=false;s.tl(true,'o','Form Analysis');s[f.vu]='';s.usePlugins=up}return f.ul&&e!='e'&&e!='s'?f.ul(e):true;");
s.fam=new Function("e","var s=s_c_il["+s._in+"],f=s.fa;if(!e) e=s.wd.event;var o=s.trackLastChanged,et=e.type.toUpperCase(),t=this.type.toUpperCase(),fn=this.form.name,en=this.name,sc=false;if(document.layers){kp=e.which;b=e.which}else{kp=e.keyCode;b=e.button}et=et=='MOUSEDOWN'?1:et=='KEYDOWN'?2:et;if(f.ce!=en||f.cf!=fn){if(et==1&&b!=2&&'BUTTONSUBMITRESETIMAGERADIOCHECKBOXSELECT-ONEFILE'.indexOf(t)>-1){f.va[1]=fn;f.va[3]=en;sc=true}else if(et==1&&b==2&&'TEXTAREAPASSWORDFILE'.indexOf(t)>-1){f.va[1]=fn;f.va[3]=en;sc=true}else if(et==2&&kp!=9&&kp!=13){f.va[1]=fn;f.va[3]=en;sc=true}if(sc){nface=en;nfacf=fn}}if(et==1&&this.s_famd)return this.s_famd(e);if(et==2&&this.s_fakd)return this.s_fakd(e);");
s.ee=new Function("e","n","return n&&n.toLowerCase?e.toLowerCase()==n.toLowerCase():false;");s.fage=new Function("e","a","var s=this,f=s.fa,x=f.cnt;x=x?x+1:1;f.cnt=x;return x==a?e:'';");s.getAndPersistValue=new Function("v","c","e","var s=this,a=new Date;e=e?e:0;a.setTime(a.getTime()+e*86400000);if(v)s.c_w(c,v,e?a:0);return s.c_r(c);");s.getDaysSinceLastVisit=new Function("c","var s=this,e=new Date(),es=new Date(),cval,cval_s,cval_ss,ct=e.getTime(),day=24*60*60*1000,f1,f2,f3,f4,f5;e.setTime(ct+3*365*day);es.setTime(ct+30*60*1000);f0='Cookies Not Supported';f1='First Visit';f2='More than 30 days';f3='More than 7 days';f4='Less than 7 days';f5='Less than 1 day';cval=s.c_r(c);if(cval.length==0){s.c_w(c,ct,e);s.c_w(c+'_s',f1,es);}else{var d=ct-cval;if(d>30*60*1000){if(d>30*day){s.c_w(c,ct,e);s.c_w(c+'_s',f2,es);}else if(d<30*day+1 && d>7*day){s.c_w(c,ct,e);s.c_w(c+'_s',f3,es);}else if(d<7*day+1 && d>day){s.c_w(c,ct,e);s.c_w(c+'_s',f4,es);}else if(d<day+1){s.c_w(c,ct,e);s.c_w(c+'_s',f5,es);}}else{s.c_w(c,ct,e);cval_ss=s.c_r(c+'_s');s.c_w(c+'_s',cval_ss,es);}}cval_s=s.c_r(c+'_s');if(cval_s.length==0) return f0;else if(cval_s!=f1&&cval_s!=f2&&cval_s!=f3&&cval_s!=f4&&cval_s!=f5) return '';else return cval_s;");
s.getTimeToComplete=new Function("v","cn","e","var s=this,d=new Date,x=d,k;if(!s.ttcr){e=e?e:0;if(v=='start'||v=='stop')s.ttcr=1;x.setTime(x.getTime()+e*86400000);if(v=='start'){s.c_w(cn,d.getTime(),e?x:0);return '';}if(v=='stop'){k=s.c_r(cn);if(!s.c_w(cn,'',d)||!k)return '';v=(d.getTime()-k)/1000;var td=86400,th=3600,tm=60,r=5,u,un;if(v>td){u=td;un='days';}else if(v>th){u=th;un='hours';}else if(v>tm){r=2;u=tm;un='minutes';}else{r=.2;u=1;un='seconds';}v=v*r/u;return (Math.round(v)/r)+' '+un;}}return '';");
s.getNewRepeat=new Function("d","cn","var s=this,e=new Date(),cval,sval,ct=e.getTime();d=d?d:30;cn=cn?cn:'s_nr';e.setTime(ct+d*24*60*60*1000);cval=s.c_r(cn);if(cval.length==0){s.c_w(cn,ct+'-New',e);return'New';}sval=s.split(cval,'-');if(ct-sval[0]<30*60*1000&&sval[1]=='New'){s.c_w(cn,ct+'-New',e);return'New';}else{s.c_w(cn,ct+'-Repeat',e);return'Repeat';}");s.getVisitStart=new Function("c","var s=this,v=1,t=new Date;t.setTime(t.getTime()+1800000);if(s.c_r(c)){v=0}if(!s.c_w(c,1,t)){s.c_w(c,1,0)}if(!s.c_r(c)){v=0}return v;");
s.getPreviousValue=new Function("v","c","el","var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t):s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t):s.c_w(c,'no value',t);return r}");s.split=new Function("l","d","var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i>-1?i:l.length;a[x++]=l.substring(0,i);l=l.substring(i+d.length);}return a");
s.trackingServer="metrics.apple.com";s.trackingServerSecure="securemetrics.apple.com";s.dc=112;var s_code="",s_objectID;
function s_gi(a,b,c){var d="s._c='s_c';s.wd=window;if(!s.wd.s_c_in){s.wd.s_c_il=new Array;s.wd.s_c_in=0;}s._il=s.wd.s_c_il;s._in=s.wd.s_c_in;s._il[s._in]=s;s.wd.s_c_in++;s.an=s_an;s.cls=function(x,c){var i,y='';if(!c)c=this.an;for(i=0;i<x.length;i++){n=x.substring(i,i+1);if(c.indexOf(n)>=0)y+=n}return y};s.fl=function(x,l){return x?(''+x).substring(0,l):x};s.co=function(o){if(!o)return o;var n=new Object,x;for(x in o)if(x.indexOf('select')<0&&x.indexOf('filter')<0)n[x]=o[x];return n};s.num=function(x){x=''+x;for(var p=0;p<x.length;p++)if(('0123456789').indexOf(x.substring(p,p+1))<0)return 0;return 1};s.rep=s_rep;s.sp=s_sp;s.jn=s_jn;s.ape=function(x){var s=this,h='0123456789ABCDEF',i,c=s.charSet,n,l,e,y='';c=c?c.toUpperCase():'';if(x){x=''+x;if(c=='AUTO'&&('').charCodeAt){for(i=0;i<x.length;i++){c=x.substring(i,i+1);n=x.charCodeAt(i);if(n>127){l=0;e='';while(n||l<4){e=h.substring(n%16,n%16+1)+e;n=(n-n%16)/16;l++}y+='%u'+e}else if(c=='+')y+='%2B';else y+=escape(c)}x=y}else{x=x?s.rep(escape(''+x),'+','%2B'):x;if(x&&c&&s.em==1&&x.indexOf('%u')<0&&x.indexOf('%U')<0){i=x.indexOf('%');while(i>=0){i++;if(h.substring(8).indexOf(x.substring(i,i+1).toUpperCase())>=0)return x.substring(0,i)+'u00'+x.substring(i);i=x.indexOf('%',i)}}}}return x};s.epa=function(x){var s=this;return x?unescape(s.rep(''+x,'+',' ')):x};s.pt=function(x,d,f,a){var s=this,t=x,z=0,y,r;while(t){y=t.indexOf(d);y=y<0?t.length:y;t=t.substring(0,y);r=s[f](t,a);if(r)return r;z+=y+d.length;t=x.substring(z,x.length);t=z<x.length?t:''}return ''};s.isf=function(t,a){var c=a.indexOf(':');if(c>=0)a=a.substring(0,c);if(t.substring(0,2)=='s_')t=t.substring(2);return (t!=''&&t==a)};s.fsf=function(t,a){var s=this;if(s.pt(a,',','isf',t))s.fsg+=(s.fsg!=''?',':'')+t;return 0};s.fs=function(x,f){var s=this;s.fsg='';s.pt(x,',','fsf',f);return s.fsg};s.si=function(wd){var s=this,c=''+s_gi,a=c.indexOf(\"{\"),b=c.lastIndexOf(\"}\"),m;c=s_fe(a>0&&b>0?c.substring(a+1,b):0);if(wd&&wd.document&&c){wd.setTimeout('function s_sv(o,n,k){var v=o[k],i;if(v){if(typeof(v)==\"string\"||typeof(v)==\"number\")n[k]=v;else if (typeof(v)==\"array\"){n[k]=new Array;for(i=0;i<v.length;i++)s_sv(v,n[k],i)}else if (typeof(v)==\"object\"){n[k]=new Object;for(i in v)s_sv(v,n[k],i)}}}function s_si(t){var wd=window,s,i,j,c,a,b;wd.s_gi=new Function(\"un\",\"pg\",\"ss\",\"'+c+'\");wd.s=s_gi(\"'+s.oun+'\");s=wd.s;s.sa(\"'+s.un+'\");s.tfs=wd;s.pt(s.vl_g,\",\",\"vo1\",t);s.lnk=s.eo=s.linkName=s.linkType=s.wd.s_objectID=s.ppu=s.pe=s.pev1=s.pev2=s.pev3=\\'\\';if(t.m_l&&t.m_nl)for(i=0;i<t.m_nl.length;i++){n=t.m_nl[i];if(n){m=t[n];c=t[\"m_\"+n];if(m&&c){c=\"\"+c;if(c.indexOf(\"function\")>=0){a=c.indexOf(\"{\");b=c.lastIndexOf(\"}\");c=a>0&&b>0?c.substring(a+1,b):0;s[\"m_\"+n+\"_c\"]=c;if(m._e)s.loadModule(n);if(s[n])for(j=0;j<m._l.length;j++)s_sv(m,s[n],m._l[j])}}}}}var e,o,t;try{o=window.opener;if(o&&o.s_gi){t=o.s_gi(\"'+s.un+'\");if(t)s_si(t)}}catch(e){}',1)}};s.c_d='';s.c_gdf=function(t,a){var s=this;if(!s.num(t))return 1;return 0};s.c_gd=function(){var s=this,d=s.wd.location.hostname,n=s.fpCookieDomainPeriods,p;if(!n)n=s.cookieDomainPeriods;if(d&&!s.c_d){n=n?parseInt(n):2;n=n>2?n:2;p=d.lastIndexOf('.');if(p>=0){while(p>=0&&n>1){p=d.lastIndexOf('.',p-1);n--}s.c_d=p>0&&s.pt(d,'.','c_gdf',0)?d.substring(p):d}}return s.c_d};s.c_r=function(k){var s=this;k=s.ape(k);var c=' '+s.d.cookie,i=c.indexOf(' '+k+'='),e=i<0?i:c.indexOf(';',i),v=i<0?'':s.epa(c.substring(i+2+k.length,e<0?c.length:e));return v!='[[B]]'?v:''};s.c_w=function(k,v,e){var s=this,d=s.c_gd(),l=s.cookieLifetime,t;v=''+v;l=l?(''+l).toUpperCase():'';if(e&&l!='SESSION'&&l!='NONE'){t=(v!=''?parseInt(l?l:0):-60);if(t){e=new Date;e.setTime(e.getTime()+(t*1000))}}if(k&&l!='NONE'){s.d.cookie=k+'='+s.ape(v!=''?v:'[[B]]')+'; path=/;'+(e&&l!='SESSION'?' expires='+e.toGMTString()+';':'')+(d?' domain='+d+';':'');return s.c_r(k)==v}return 0};s.eh=function(o,e,r,f){var s=this,b='s_'+e+'_'+s._in,n=-1,l,i,x;if(!s.ehl)s.ehl=new Array;l=s.ehl;for(i=0;i<l.length&&n<0;i++){if(l[i].o==o&&l[i].e==e)n=i}if(n<0){n=i;l[n]=new Object}x=l[n];x.o=o;x.e=e;f=r?x.b:f;if(r||f){x.b=r?0:o[e];x.o[e]=f}if(x.b){x.o[b]=x.b;return b}return 0};s.cet=function(f,a,t,o,b){var s=this,r,tcf;if(s.apv>=5&&(!s.isopera||s.apv>=7)){tcf=new Function('s','f','a','t','var e,r;try{r=s[f](a)}catch(e){r=s[t](e)}return r');r=tcf(s,f,a,t)}else{if(s.ismac&&s.u.indexOf('MSIE 4')>=0)r=s[b](a);else{s.eh(s.wd,'onerror',0,o);r=s[f](a);s.eh(s.wd,'onerror',1)}}return r};s.gtfset=function(e){var s=this;return s.tfs};s.gtfsoe=new Function('e','var s=s_c_il['+s._in+'],c;s.eh(window,\"onerror\",1);s.etfs=1;c=s.t();if(c)s.d.write(c);s.etfs=0;return true');s.gtfsfb=function(a){return window};s.gtfsf=function(w){var s=this,p=w.parent,l=w.location;s.tfs=w;if(p&&p.location!=l&&p.location.host==l.host){s.tfs=p;return s.gtfsf(s.tfs)}return s.tfs};s.gtfs=function(){var s=this;if(!s.tfs){s.tfs=s.wd;if(!s.etfs)s.tfs=s.cet('gtfsf',s.tfs,'gtfset',s.gtfsoe,'gtfsfb')}return s.tfs};s.mrq=function(u){var s=this,l=s.rl[u],n,r;s.rl[u]=0;if(l)for(n=0;n<l.length;n++){r=l[n];s.mr(0,0,r.r,0,r.t,r.u)}};s.br=function(id,rs){var s=this;if(s.disableBufferedRequests||!s.c_w('s_br',rs))s.brl=rs};s.flushBufferedRequests=function(){this.fbr(0)};s.fbr=function(id){var s=this,br=s.c_r('s_br');if(!br)br=s.brl;if(br){if(!s.disableBufferedRequests)s.c_w('s_br','');s.mr(0,0,br)}s.brl=0};s.mr=function(sess,q,rs,id,ta,u){var s=this,dc=s.dc,t1=s.trackingServer,t2=s.trackingServerSecure,tb=s.trackingServerBase,p='.sc',ns=s.visitorNamespace,un=s.cls(u?u:(ns?ns:s.fun)),r=new Object,l,imn='s_i_'+(un),im,b,e;if(!rs){if(t1){if(t2&&s.ssl)t1=t2}else{if(!tb)tb='2o7.net';if(dc)dc=(''+dc).toLowerCase();else dc='d1';if(tb=='2o7.net'){if(dc=='d1')dc='112';else if(dc=='d2')dc='122';p=''}t1=un+'.'+dc+'.'+p+tb}rs='http'+(s.ssl?'s':'')+'://'+t1+'/b/ss/'+s.un+'/'+(s.mobile?'5.1':'1')+'/H.20.3/'+sess+'?AQB=1&ndh=1'+(q?q:'')+'&AQE=1';if(s.isie&&!s.ismac){if(s.apv>5.5)rs=s.fl(rs,4095);else rs=s.fl(rs,2047)}if(id){s.br(id,rs);return}}if(s.d.images&&s.apv>=3&&(!s.isopera||s.apv>=7)&&(s.ns6<0||s.apv>=6.1)){if(!s.rc)s.rc=new Object;if(!s.rc[un]){s.rc[un]=1;if(!s.rl)s.rl=new Object;s.rl[un]=new Array;setTimeout('if(window.s_c_il)window.s_c_il['+s._in+'].mrq(\"'+un+'\")',750)}else{l=s.rl[un];if(l){r.t=ta;r.u=un;r.r=rs;l[l.length]=r;return ''}imn+='_'+s.rc[un];s.rc[un]++}im=s.wd[imn];if(!im)im=s.wd[imn]=new Image;im.s_l=0;im.onload=new Function('e','this.s_l=1;var wd=window,s;if(wd.s_c_il){s=wd.s_c_il['+s._in+'];s.mrq(\"'+un+'\");s.nrs--;if(!s.nrs)s.m_m(\"rr\")}');if(!s.nrs){s.nrs=1;s.m_m('rs')}else s.nrs++;im.src=rs;if(rs.indexOf('&pe=')>=0&&(!ta||ta=='_self'||ta=='_top'||(s.wd.name&&ta==s.wd.name))){b=e=new Date;while(!im.s_l&&e.getTime()-b.getTime()<500)e=new Date}return ''}return '<im'+'g sr'+'c=\"'+rs+'\" width=1 height=1 border=0 alt=\"\">'};s.gg=function(v){var s=this;if(!s.wd['s_'+v])s.wd['s_'+v]='';return s.wd['s_'+v]};s.glf=function(t,a){if(t.substring(0,2)=='s_')t=t.substring(2);var s=this,v=s.gg(t);if(v)s[t]=v};s.gl=function(v){var s=this;if(s.pg)s.pt(v,',','glf',0)};s.rf=function(x){var s=this,y,i,j,h,l,a,b='',c='',t;if(x){y=''+x;i=y.indexOf('?');if(i>0){a=y.substring(i+1);y=y.substring(0,i);h=y.toLowerCase();i=0;if(h.substring(0,7)=='http://')i+=7;else if(h.substring(0,8)=='https://')i+=8;h=h.substring(i);i=h.indexOf(\"/\");if(i>0){h=h.substring(0,i);if(h.indexOf('google')>=0){a=s.sp(a,'&');if(a.length>1){l=',q,ie,start,search_key,word,kw,cd,';for(j=0;j<a.length;j++){t=a[j];i=t.indexOf('=');if(i>0&&l.indexOf(','+t.substring(0,i)+',')>=0)b+=(b?'&':'')+t;else c+=(c?'&':'')+t}if(b&&c){y+='?'+b+'&'+c;if(''+x!=y)x=y}}}}}}return x};s.hav=function(){var s=this,qs='',fv=s.linkTrackVars,fe=s.linkTrackEvents,mn,i;if(s.pe){mn=s.pe.substring(0,1).toUpperCase()+s.pe.substring(1);if(s[mn]){fv=s[mn].trackVars;fe=s[mn].trackEvents}}fv=fv?fv+','+s.vl_l+','+s.vl_l2:'';for(i=0;i<s.va_t.length;i++){var k=s.va_t[i],v=s[k],b=k.substring(0,4),x=k.substring(4),n=parseInt(x),q=k;if(v&&k!='linkName'&&k!='linkType'){if(s.pe||s.lnk||s.eo){if(fv&&(','+fv+',').indexOf(','+k+',')<0)v='';if(k=='events'&&fe)v=s.fs(v,fe)}if(v){if(k=='dynamicVariablePrefix')q='D';else if(k=='visitorID')q='vid';else if(k=='pageURL'){q='g';v=s.fl(v,255)}else if(k=='referrer'){q='r';v=s.fl(s.rf(v),255)}else if(k=='vmk'||k=='visitorMigrationKey')q='vmt';else if(k=='visitorMigrationServer'){q='vmf';if(s.ssl&&s.visitorMigrationServerSecure)v=''}else if(k=='visitorMigrationServerSecure'){q='vmf';if(!s.ssl&&s.visitorMigrationServer)v=''}else if(k=='charSet'){q='ce';if(v.toUpperCase()=='AUTO')v='ISO8859-1';else if(s.em==2)v='UTF-8'}else if(k=='visitorNamespace')q='ns';else if(k=='cookieDomainPeriods')q='cdp';else if(k=='cookieLifetime')q='cl';else if(k=='variableProvider')q='vvp';else if(k=='currencyCode')q='cc';else if(k=='channel')q='ch';else if(k=='transactionID')q='xact';else if(k=='campaign')q='v0';else if(k=='resolution')q='s';else if(k=='colorDepth')q='c';else if(k=='javascriptVersion')q='j';else if(k=='javaEnabled')q='v';else if(k=='cookiesEnabled')q='k';else if(k=='browserWidth')q='bw';else if(k=='browserHeight')q='bh';else if(k=='connectionType')q='ct';else if(k=='homepage')q='hp';else if(k=='plugins')q='p';else if(s.num(x)){if(b=='prop')q='c'+n;else if(b=='eVar')q='v'+n;else if(b=='list')q='l'+n;else if(b=='hier'){q='h'+n;v=s.fl(v,255)}}if(v)qs+='&'+q+'='+(k.substring(0,3)!='pev'?s.ape(v):v)}}}return qs};s.ltdf=function(t,h){t=t?t.toLowerCase():'';h=h?h.toLowerCase():'';var qi=h.indexOf('?');h=qi>=0?h.substring(0,qi):h;if(t&&h.substring(h.length-(t.length+1))=='.'+t)return 1;return 0};s.ltef=function(t,h){t=t?t.toLowerCase():'';h=h?h.toLowerCase():'';if(t&&h.indexOf(t)>=0)return 1;return 0};s.lt=function(h){var s=this,lft=s.linkDownloadFileTypes,lef=s.linkExternalFilters,lif=s.linkInternalFilters;lif=lif?lif:s.wd.location.hostname;h=h.toLowerCase();if(s.trackDownloadLinks&&lft&&s.pt(lft,',','ltdf',h))return 'd';if(s.trackExternalLinks&&h.substring(0,1)!='#'&&(lef||lif)&&(!lef||s.pt(lef,',','ltef',h))&&(!lif||!s.pt(lif,',','ltef',h)))return 'e';return ''};s.lc=new Function('e','var s=s_c_il['+s._in+'],b=s.eh(this,\"onclick\");s.lnk=s.co(this);s.t();s.lnk=0;if(b)return this[b](e);return true');s.bc=new Function('e','var s=s_c_il['+s._in+'],f,tcf;if(s.d&&s.d.all&&s.d.all.cppXYctnr)return;s.eo=e.srcElement?e.srcElement:e.target;tcf=new Function(\"s\",\"var e;try{if(s.eo&&(s.eo.tagName||s.eo.parentElement||s.eo.parentNode))s.t()}catch(e){}\");tcf(s);s.eo=0');s.oh=function(o){var s=this,l=s.wd.location,h=o.href?o.href:'',i,j,k,p;i=h.indexOf(':');j=h.indexOf('?');k=h.indexOf('/');if(h&&(i<0||(j>=0&&i>j)||(k>=0&&i>k))){p=o.protocol&&o.protocol.length>1?o.protocol:(l.protocol?l.protocol:'');i=l.pathname.lastIndexOf('/');h=(p?p+'//':'')+(o.host?o.host:(l.host?l.host:''))+(h.substring(0,1)!='/'?l.pathname.substring(0,i<0?0:i)+'/':'')+h}return h};s.ot=function(o){var t=o.tagName;t=t&&t.toUpperCase?t.toUpperCase():'';if(t=='SHAPE')t='';if(t){if(t=='INPUT'&&o.type&&o.type.toUpperCase)t=o.type.toUpperCase();else if(!t&&o.href)t='A';}return t};s.oid=function(o){var s=this,t=s.ot(o),p,c,n='',x=0;if(t&&!o.s_oid){p=o.protocol;c=o.onclick;if(o.href&&(t=='A'||t=='AREA')&&(!c||!p||p.toLowerCase().indexOf('javascript')<0))n=s.oh(o);else if(c){n=s.rep(s.rep(s.rep(s.rep(''+c,\"\\r\",''),\"\\n\",''),\"\\t\",''),' ','');x=2}else if(o.value&&(t=='INPUT'||t=='SUBMIT')){n=o.value;x=3}else if(o.src&&t=='IMAGE')n=o.src;if(n){o.s_oid=s.fl(n,100);o.s_oidt=x}}return o.s_oid};s.rqf=function(t,un){var s=this,e=t.indexOf('='),u=e>=0?','+t.substring(0,e)+',':'';return u&&u.indexOf(','+un+',')>=0?s.epa(t.substring(e+1)):''};s.rq=function(un){var s=this,c=un.indexOf(','),v=s.c_r('s_sq'),q='';if(c<0)return s.pt(v,'&','rqf',un);return s.pt(un,',','rq',0)};s.sqp=function(t,a){var s=this,e=t.indexOf('='),q=e<0?'':s.epa(t.substring(e+1));s.sqq[q]='';if(e>=0)s.pt(t.substring(0,e),',','sqs',q);return 0};s.sqs=function(un,q){var s=this;s.squ[un]=q;return 0};s.sq=function(q){var s=this,k='s_sq',v=s.c_r(k),x,c=0;s.sqq=new Object;s.squ=new Object;s.sqq[q]='';s.pt(v,'&','sqp',0);s.pt(s.un,',','sqs',q);v='';for(x in s.squ)if(x&&(!Object||!Object.prototype||!Object.prototype[x]))s.sqq[s.squ[x]]+=(s.sqq[s.squ[x]]?',':'')+x;for(x in s.sqq)if(x&&(!Object||!Object.prototype||!Object.prototype[x])&&s.sqq[x]&&(x==q||c<2)){v+=(v?'&':'')+s.sqq[x]+'='+s.ape(x);c++}return s.c_w(k,v,0)};s.wdl=new Function('e','var s=s_c_il['+s._in+'],r=true,b=s.eh(s.wd,\"onload\"),i,o,oc;if(b)r=this[b](e);for(i=0;i<s.d.links.length;i++){o=s.d.links[i];oc=o.onclick?\"\"+o.onclick:\"\";if((oc.indexOf(\"s_gs(\")<0||oc.indexOf(\".s_oc(\")>=0)&&oc.indexOf(\".tl(\")<0)s.eh(o,\"onclick\",0,s.lc);}return r');s.wds=function(){var s=this;if(s.apv>3&&(!s.isie||!s.ismac||s.apv>=5)){if(s.b&&s.b.attachEvent)s.b.attachEvent('onclick',s.bc);else if(s.b&&s.b.addEventListener)s.b.addEventListener('click',s.bc,false);else s.eh(s.wd,'onload',0,s.wdl)}};s.vs=function(x){var s=this,v=s.visitorSampling,g=s.visitorSamplingGroup,k='s_vsn_'+s.un+(g?'_'+g:''),n=s.c_r(k),e=new Date,y=e.getYear();e.setYear(y+10+(y<1900?1900:0));if(v){v*=100;if(!n){if(!s.c_w(k,x,e))return 0;n=x}if(n%10000>v)return 0}return 1};s.dyasmf=function(t,m){if(t&&m&&m.indexOf(t)>=0)return 1;return 0};s.dyasf=function(t,m){var s=this,i=t?t.indexOf('='):-1,n,x;if(i>=0&&m){var n=t.substring(0,i),x=t.substring(i+1);if(s.pt(x,',','dyasmf',m))return n}return 0};s.uns=function(){var s=this,x=s.dynamicAccountSelection,l=s.dynamicAccountList,m=s.dynamicAccountMatch,n,i;s.un=s.un.toLowerCase();if(x&&l){if(!m)m=s.wd.location.host;if(!m.toLowerCase)m=''+m;l=l.toLowerCase();m=m.toLowerCase();n=s.pt(l,';','dyasf',m);if(n)s.un=n}i=s.un.indexOf(',');s.fun=i<0?s.un:s.un.substring(0,i)};s.sa=function(un){var s=this;s.un=un;if(!s.oun)s.oun=un;else if((','+s.oun+',').indexOf(','+un+',')<0)s.oun+=','+un;s.uns()};s.m_i=function(n,a){var s=this,m,f=n.substring(0,1),r,l,i;if(!s.m_l)s.m_l=new Object;if(!s.m_nl)s.m_nl=new Array;m=s.m_l[n];if(!a&&m&&m._e&&!m._i)s.m_a(n);if(!m){m=new Object,m._c='s_m';m._in=s.wd.s_c_in;m._il=s._il;m._il[m._in]=m;s.wd.s_c_in++;m.s=s;m._n=n;m._l=new Array('_c','_in','_il','_i','_e','_d','_dl','s','n','_r','_g','_g1','_t','_t1','_x','_x1','_rs','_rr','_l');s.m_l[n]=m;s.m_nl[s.m_nl.length]=n}else if(m._r&&!m._m){r=m._r;r._m=m;l=m._l;for(i=0;i<l.length;i++)if(m[l[i]])r[l[i]]=m[l[i]];r._il[r._in]=r;m=s.m_l[n]=r}if(f==f.toUpperCase())s[n]=m;return m};s.m_a=new Function('n','g','e','if(!g)g=\"m_\"+n;var s=s_c_il['+s._in+'],c=s[g+\"_c\"],m,x,f=0;if(!c)c=s.wd[\"s_\"+g+\"_c\"];if(c&&s_d)s[g]=new Function(\"s\",s_ft(s_d(c)));x=s[g];if(!x)x=s.wd[\\'s_\\'+g];if(!x)x=s.wd[g];m=s.m_i(n,1);if(x&&(!m._i||g!=\"m_\"+n)){m._i=f=1;if((\"\"+x).indexOf(\"function\")>=0)x(s);else s.m_m(\"x\",n,x,e)}m=s.m_i(n,1);if(m._dl)m._dl=m._d=0;s.dlt();return f');s.m_m=function(t,n,d,e){t='_'+t;var s=this,i,x,m,f='_'+t,r=0,u;if(s.m_l&&s.m_nl)for(i=0;i<s.m_nl.length;i++){x=s.m_nl[i];if(!n||x==n){m=s.m_i(x);u=m[t];if(u){if((''+u).indexOf('function')>=0){if(d&&e)u=m[t](d,e);else if(d)u=m[t](d);else u=m[t]()}}if(u)r=1;u=m[t+1];if(u&&!m[f]){if((''+u).indexOf('function')>=0){if(d&&e)u=m[t+1](d,e);else if(d)u=m[t+1](d);else u=m[t+1]()}}m[f]=1;if(u)r=1}}return r};s.m_ll=function(){var s=this,g=s.m_dl,i,o;if(g)for(i=0;i<g.length;i++){o=g[i];if(o)s.loadModule(o.n,o.u,o.d,o.l,o.e,1);g[i]=0}};s.loadModule=function(n,u,d,l,e,ln){var s=this,m=0,i,g,o=0,f1,f2,c=s.h?s.h:s.b,b,tcf;if(n){i=n.indexOf(':');if(i>=0){g=n.substring(i+1);n=n.substring(0,i)}else g=\"m_\"+n;m=s.m_i(n)}if((l||(n&&!s.m_a(n,g)))&&u&&s.d&&c&&s.d.createElement){if(d){m._d=1;m._dl=1}if(ln){if(s.ssl)u=s.rep(u,'http:','https:');i='s_s:'+s._in+':'+n+':'+g;b='var s=s_c_il['+s._in+'],o=s.d.getElementById(\"'+i+'\");if(s&&o){if(!o.l&&s.wd.'+g+'){o.l=1;if(o.i)clearTimeout(o.i);o.i=0;s.m_a(\"'+n+'\",\"'+g+'\"'+(e?',\"'+e+'\"':'')+')}';f2=b+'o.c++;if(!s.maxDelay)s.maxDelay=250;if(!o.l&&o.c<(s.maxDelay*2)/100)o.i=setTimeout(o.f2,100)}';f1=new Function('e',b+'}');tcf=new Function('s','c','i','u','f1','f2','var e,o=0;try{o=s.d.createElement(\"script\");if(o){o.type=\"text/javascript\";'+(n?'o.id=i;o.defer=true;o.onload=o.onreadystatechange=f1;o.f2=f2;o.l=0;':'')+'o.src=u;c.appendChild(o);'+(n?'o.c=0;o.i=setTimeout(f2,100)':'')+'}}catch(e){o=0}return o');o=tcf(s,c,i,u,f1,f2)}else{o=new Object;o.n=n+':'+g;o.u=u;o.d=d;o.l=l;o.e=e;g=s.m_dl;if(!g)g=s.m_dl=new Array;i=0;while(i<g.length&&g[i])i++;g[i]=o}}else if(n){m=s.m_i(n);m._e=1}return m};s.vo1=function(t,a){if(a[t]||a['!'+t])this[t]=a[t]};s.vo2=function(t,a){if(!a[t]){a[t]=this[t];if(!a[t])a['!'+t]=1}};s.dlt=new Function('var s=s_c_il['+s._in+'],d=new Date,i,vo,f=0;if(s.dll)for(i=0;i<s.dll.length;i++){vo=s.dll[i];if(vo){if(!s.m_m(\"d\")||d.getTime()-vo._t>=s.maxDelay){s.dll[i]=0;s.t(vo)}else f=1}}if(s.dli)clearTimeout(s.dli);s.dli=0;if(f){if(!s.dli)s.dli=setTimeout(s.dlt,s.maxDelay)}else s.dll=0');s.dl=function(vo){var s=this,d=new Date;if(!vo)vo=new Object;s.pt(s.vl_g,',','vo2',vo);vo._t=d.getTime();if(!s.dll)s.dll=new Array;s.dll[s.dll.length]=vo;if(!s.maxDelay)s.maxDelay=250;s.dlt()};s.t=function(vo,id){var s=this,trk=1,tm=new Date,sed=Math&&Math.random?Math.floor(Math.random()*10000000000000):tm.getTime(),sess='s'+Math.floor(tm.getTime()/10800000)%10+sed,y=tm.getYear(),vt=tm.getDate()+'/'+tm.getMonth()+'/'+(y<1900?y+1900:y)+' '+tm.getHours()+':'+tm.getMinutes()+':'+tm.getSeconds()+' '+tm.getDay()+' '+tm.getTimezoneOffset(),tcf,tfs=s.gtfs(),ta='',q='',qs='',code='',vb=new Object;s.gl(s.vl_g);s.uns();s.m_ll();if(!s.td){var tl=tfs.location,a,o,i,x='',c='',v='',p='',bw='',bh='',j='1.0',k=s.c_w('s_cc','true',0)?'Y':'N',hp='',ct='',pn=0,ps;if(String&&String.prototype){j='1.1';if(j.match){j='1.2';if(tm.setUTCDate){j='1.3';if(s.isie&&s.ismac&&s.apv>=5)j='1.4';if(pn.toPrecision){j='1.5';a=new Array;if(a.forEach){j='1.6';i=0;o=new Object;tcf=new Function('o','var e,i=0;try{i=new Iterator(o)}catch(e){}return i');i=tcf(o);if(i&&i.next)j='1.7'}}}}}if(s.apv>=4)x=screen.width+'x'+screen.height;if(s.isns||s.isopera){if(s.apv>=3){v=s.n.javaEnabled()?'Y':'N';if(s.apv>=4){c=screen.pixelDepth;bw=s.wd.innerWidth;bh=s.wd.innerHeight}}s.pl=s.n.plugins}else if(s.isie){if(s.apv>=4){v=s.n.javaEnabled()?'Y':'N';c=screen.colorDepth;if(s.apv>=5){bw=s.d.documentElement.offsetWidth;bh=s.d.documentElement.offsetHeight;if(!s.ismac&&s.b){tcf=new Function('s','tl','var e,hp=0;try{s.b.addBehavior(\"#default#homePage\");hp=s.b.isHomePage(tl)?\"Y\":\"N\"}catch(e){}return hp');hp=tcf(s,tl);tcf=new Function('s','var e,ct=0;try{s.b.addBehavior(\"#default#clientCaps\");ct=s.b.connectionType}catch(e){}return ct');ct=tcf(s)}}}else r=''}if(s.pl)while(pn<s.pl.length&&pn<30){ps=s.fl(s.pl[pn].name,100)+';';if(p.indexOf(ps)<0)p+=ps;pn++}s.resolution=x;s.colorDepth=c;s.javascriptVersion=j;s.javaEnabled=v;s.cookiesEnabled=k;s.browserWidth=bw;s.browserHeight=bh;s.connectionType=ct;s.homepage=hp;s.plugins=p;s.td=1}if(vo){s.pt(s.vl_g,',','vo2',vb);s.pt(s.vl_g,',','vo1',vo)}if(s.usePlugins)s.doPlugins(s);var l=s.wd.location,r=tfs.document.referrer;if(!s.pageURL)s.pageURL=l.href?l.href:l;if(!s.referrer&&!s._1_referrer){s.referrer=r;s._1_referrer=1}if((vo&&vo._t)||!s.m_m('d')){s.m_m('g');if(s.lnk||s.eo){var o=s.eo?s.eo:s.lnk;if(!o)return '';var p=s.pageName,w=1,t=s.ot(o),n=s.oid(o),x=o.s_oidt,h,l,i,oc;if(s.eo&&o==s.eo){while(o&&!n&&t!='BODY'){o=o.parentElement?o.parentElement:o.parentNode;if(!o)return '';t=s.ot(o);n=s.oid(o);x=o.s_oidt}oc=o.onclick?''+o.onclick:'';if((oc.indexOf(\"s_gs(\")>=0&&oc.indexOf(\".s_oc(\")<0)||oc.indexOf(\".tl(\")>=0)return ''}ta=n?o.target:1;h=s.oh(o);i=h.indexOf('?');h=s.linkLeaveQueryString||i<0?h:h.substring(0,i);l=s.linkName;t=s.linkType?s.linkType.toLowerCase():s.lt(h);if(t&&(h||l))q+='&pe=lnk_'+(t=='d'||t=='e'?s.ape(t):'o')+(h?'&pev1='+s.ape(h):'')+(l?'&pev2='+s.ape(l):'');else trk=0;if(s.trackInlineStats){if(!p){p=s.pageURL;w=0}t=s.ot(o);i=o.sourceIndex;if(s.gg('objectID')){n=s.gg('objectID');x=1;i=1}if(p&&n&&t)qs='&pid='+s.ape(s.fl(p,255))+(w?'&pidt='+w:'')+'&oid='+s.ape(s.fl(n,100))+(x?'&oidt='+x:'')+'&ot='+s.ape(t)+(i?'&oi='+i:'')}}if(!trk&&!qs)return '';s.sampled=s.vs(sed);if(trk){if(s.sampled)code=s.mr(sess,(vt?'&t='+s.ape(vt):'')+s.hav()+q+(qs?qs:s.rq(s.un)),0,id,ta);qs='';s.m_m('t');if(s.p_r)s.p_r();s.referrer=''}s.sq(qs);}else{s.dl(vo);}if(vo)s.pt(s.vl_g,',','vo1',vb);s.lnk=s.eo=s.linkName=s.linkType=s.wd.s_objectID=s.ppu=s.pe=s.pev1=s.pev2=s.pev3='';if(s.pg)s.wd.s_lnk=s.wd.s_eo=s.wd.s_linkName=s.wd.s_linkType='';if(!id&&!s.tc){s.tc=1;s.flushBufferedRequests()}return code};s.tl=function(o,t,n,vo){var s=this;s.lnk=s.co(o);s.linkType=t;s.linkName=n;s.t(vo)};if(pg){s.wd.s_co=function(o){var s=s_gi(\"_\",1,1);return s.co(o)};s.wd.s_gs=function(un){var s=s_gi(un,1,1);return s.t()};s.wd.s_dc=function(un){var s=s_gi(un,1);return s.t()}}s.ssl=(s.wd.location.protocol.toLowerCase().indexOf('https')>=0);s.d=document;s.b=s.d.body;if(s.d.getElementsByTagName){s.h=s.d.getElementsByTagName('HEAD');if(s.h)s.h=s.h[0]}s.n=navigator;s.u=s.n.userAgent;s.ns6=s.u.indexOf('Netscape6/');var apn=s.n.appName,v=s.n.appVersion,ie=v.indexOf('MSIE '),o=s.u.indexOf('Opera '),i;if(v.indexOf('Opera')>=0||o>0)apn='Opera';s.isie=(apn=='Microsoft Internet Explorer');s.isns=(apn=='Netscape');s.isopera=(apn=='Opera');s.ismac=(s.u.indexOf('Mac')>=0);if(o>0)s.apv=parseFloat(s.u.substring(o+6));else if(ie>0){s.apv=parseInt(i=v.substring(ie+5));if(s.apv>3)s.apv=parseFloat(i)}else if(s.ns6>0)s.apv=parseFloat(s.u.substring(s.ns6+10));else s.apv=parseFloat(v);s.em=0;if(String.fromCharCode){i=escape(String.fromCharCode(256)).toUpperCase();s.em=(i=='%C4%80'?2:(i=='%U0100'?1:0))}s.sa(un);s.vl_l='dynamicVariablePrefix,visitorID,vmk,visitorMigrationKey,visitorMigrationServer,visitorMigrationServerSecure,ppu,charSet,visitorNamespace,cookieDomainPeriods,cookieLifetime,pageName,pageURL,referrer,currencyCode';s.va_l=s.sp(s.vl_l,',');s.vl_t=s.vl_l+',variableProvider,channel,server,pageType,transactionID,purchaseID,campaign,state,zip,events,products,linkName,linkType';for(var n=1;n<51;n++)s.vl_t+=',prop'+n+',eVar'+n+',hier'+n+',list'+n;s.vl_l2=',tnt,pe,pev1,pev2,pev3,resolution,colorDepth,javascriptVersion,javaEnabled,cookiesEnabled,browserWidth,browserHeight,connectionType,homepage,plugins';s.vl_t+=s.vl_l2;s.va_t=s.sp(s.vl_t,',');s.vl_g=s.vl_t+',trackingServer,trackingServerSecure,trackingServerBase,fpCookieDomainPeriods,disableBufferedRequests,mobile,visitorSampling,visitorSamplingGroup,dynamicAccountSelection,dynamicAccountList,dynamicAccountMatch,trackDownloadLinks,trackExternalLinks,trackInlineStats,linkLeaveQueryString,linkDownloadFileTypes,linkExternalFilters,linkInternalFilters,linkTrackVars,linkTrackEvents,linkNames,lnk,eo,_1_referrer';s.va_g=s.sp(s.vl_g,',');s.pg=pg;s.gl(s.vl_g);if(!ss)s.wds()",e=
window,f=e.s_c_il,g=navigator,h=g.userAgent,g=g.appVersion,i=g.indexOf("MSIE "),j=h.indexOf("Netscape6/"),l,k;if(a&&(a=a.toLowerCase(),f))for(l=0;l<f.length;l++)if(k=f[l],!k._c||"s_c"==k._c){if(k.oun==a)return k;if(k.fs&&k.sa&&k.fs(k.oun,a))return k.sa(a),k}e.s_an="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";e.s_sp=new Function("x","d","var a=new Array,i=0,j;if(x){if(x.split)a=x.split(d);else if(!d)for(i=0;i<x.length;i++)a[a.length]=x.substring(i,i+1);else while(i>=0){j=x.indexOf(d,i);a[a.length]=x.substring(i,j<0?x.length:j);i=j;if(i>=0)i+=d.length}}return a");
e.s_jn=new Function("a","d","var x='',i,j=a.length;if(a&&j>0){x=a[0];if(j>1){if(a.join)x=a.join(d);else for(i=1;i<j;i++)x+=d+a[i]}}return x");e.s_rep=new Function("x","o","n","return s_jn(s_sp(x,o),n)");e.s_d=new Function("x","var t='`^@$#',l=s_an,l2=new Object,x2,d,b=0,k,i=x.lastIndexOf('~~'),j,v,w;if(i>0){d=x.substring(0,i);x=x.substring(i+2);l=s_sp(l,'');for(i=0;i<62;i++)l2[l[i]]=i;t=s_sp(t,'');d=s_sp(d,'~');i=0;while(i<5){v=0;if(x.indexOf(t[i])>=0) {x2=s_sp(x,t[i]);for(j=1;j<x2.length;j++){k=x2[j].substring(0,1);w=t[i]+k;if(k!=' '){v=1;w=d[b+l2[k]]}x2[j]=w+x2[j].substring(1)}}if(v)x=s_jn(x2,'');else{w=t[i]+' ';if(x.indexOf(w)>=0)x=s_rep(x,w,t[i]);i++;b+=62}}}return x");
e.s_fe=new Function("c","return s_rep(s_rep(s_rep(c,'\\\\','\\\\\\\\'),'\"','\\\\\"'),\"\\n\",\"\\\\n\")");e.s_fa=new Function("f","var s=f.indexOf('(')+1,e=f.indexOf(')'),a='',c;while(s>=0&&s<e){c=f.substring(s,s+1);if(c==',')a+='\",\"';else if((\"\\n\\r\\t \").indexOf(c)<0)a+=c;s++}return a?'\"'+a+'\"':a");e.s_ft=new Function("c","c+='';var s,e,o,a,d,q,f,h,x;s=c.indexOf('=function(');while(s>=0){s++;d=1;q='';x=0;f=c.substring(s);a=s_fa(f);e=o=c.indexOf('{',s);e++;while(d>0){h=c.substring(e,e+1);if(q){if(h==q&&!x)q='';if(h=='\\\\')x=x?0:1;else x=0}else{if(h=='\"'||h==\"'\")q=h;if(h=='{')d++;if(h=='}')d--}if(d>0)e++}c=c.substring(0,s)+'new Function('+(a?a+',':'')+'\"'+s_fe(c.substring(o+1,e))+'\")'+c.substring(e+1);s=c.indexOf('=function(')}return c;");
d=s_d(d);0<i?(f=parseInt(l=g.substring(i+5)),3<f&&(f=parseFloat(l))):f=0<j?parseFloat(h.substring(j+10)):parseFloat(g);if(5<=f&&0>g.indexOf("Opera")&&0>h.indexOf("Opera"))return e.s_c=new Function("un","pg","ss","var s=this;"+d),new s_c(a,b,c);k=new Function("un","pg","ss","var s=new Object;"+s_ft(d)+";return s");return k(a,b,c)};var Omniture=function(){var a=null;return{init:function(a){for(var c in a)Omniture[c].apply(this,a[c])},batch:function(b,c){!1===c?Omniture.init(b):void 0===b?Omniture.init(a):a=b},fire:function(a){"object"===typeof window.s&&function(){apple.metrics.fireEvent(a)}.call()},click:function(a,c,d){window.addEventListener(d||"DOMContentLoaded",function(){document.querySelector(a).addEventListener("click",function(){Omniture.fire(c)},!1)},!1)}}}();
